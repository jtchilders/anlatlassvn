      t1 = m**2
      t4 = den(2*t1+2*dotp(kq,kqb))
      t5 = dotp(k1,k2)
      t7 = dotp(k2,k3)
      t9 = den(2*t5+2*dotp(k1,k3)+2*t7)
      t12 = 1/spa(r1,r2)
      t13 = spb(k1,r2)
      t14 = 1/t13
      t15 = t12*t14
      t17 = 1/spb(k2,k3)
      t18 = spa(k1,k3)
      t21 = spa(k2,k4)
      t22 = spa(k4,r1)
      t23 = t21*t22
      t24 = spa(q1,q2)
      t25 = spb(q1,r2)
      t26 = t24*t25
      t27 = t23*t26
      t28 = t15*t17*t18*t27
      t31 = t12/spb(k1,k2)
      t32 = spa(k2,k3)
      t35 = spa(k3,k4)
      t36 = t35*t22
      t37 = t36*t26
      t39 = spb(k3,r2)
      t40 = 1/t39
      t44 = spb(k4,r2)
      t45 = 1/t44
      t46 = t40*t45
      t47 = spa(k1,r1)
      t50 = t32*t21
      t51 = spb(k2,r2)
      t52 = t24*t51
      t53 = t52*t25
      t56 = t46*t18
      t57 = t31*t56
      t58 = spa(k1,k4)
      t59 = spa(k2,r1)
      t60 = t58*t59
      t61 = t24*t13
      t62 = t61*t25
      t65 = t47*t21
      t68 = t21*t59
      t69 = t68*t53
      t72 = t31*t46*t58
      t73 = t47*t32
      t76 = t14*t40
      t79 = t23*t53
      t82 = t31*t76*t45
      t84 = t51**2
      t86 = t24*t84*t25
      t89 = t14*t45
      t91 = t31*t89*t32
      t92 = spa(k3,r1)
      t93 = t21*t92
      t94 = t93*t53
      t96 = t59*t35
      t97 = t96*t53
      t99 = -t28-t31*t14*t32*t37-t31*t40*t18*t27-t31*t46*t47*t50*t53-t57
     #*t60*t62-t57*t65*t62-t57*t69-t72*t73*t62-t31*t76*t32*t79-t82*t50*t
     #59*t86-t91*t94-t91*t97
      t100 = t35*t92
      t101 = t24*t39
      t102 = t101*t25
      t103 = t100*t102
      t105 = 1/t51
      t106 = t105*t18
      t109 = t105*t40
      t112 = t58*t22
      t115 = t109*t45
      t116 = t31*t115
      t119 = t13**2
      t124 = t40*t58
      t126 = t32*t22
      t127 = t126*t26
      t129 = t105*t45
      t130 = t129*t18
      t131 = t31*t130
      t132 = t58*t92
      t135 = t47*t35
      t139 = t17*t105
      t143 = t15*t139*t18*t36*t102
      t144 = t12*t17
      t145 = t144*t130
      t149 = t145*t135*t102
      t150 = spa(k1,k2)
      t151 = t40*t150
      t153 = t112*t26
      t155 = -t91*t103-t31*t106*t37-t31*t109*t18*t112*t62-t116*t18*t58*t
     #47*t24*t119*t25-t31*t124*t127-t131*t132*t62-t131*t135*t62-t131*t10
     #3-t143-t145*t132*t102-t149-t144*t151*t153
      t157 = t32*t59
      t158 = t157*t53
      t161 = t15*t139*t45
      t164 = t39**2
      t166 = t24*t164*t25
      t168 = t161*t18*t35*t92*t166
      t169 = t17*t40
      t172 = t15*t169*t150*t79
      t173 = t45*t18
      t174 = t31*t173
      t175 = t93*t26
      t177 = t96*t26
      t181 = t32*t92
      t191 = t15*t17*t150*t37
      t193 = t15*t169*t45
      t197 = t193*t150*t21*t59*t86
      t198 = t17*t45
      t200 = t15*t198*t150
      t201 = t200*t94
      t202 = t200*t97
      t203 = t200*t103
      t204 = -t72*t158-t168-t172-t174*t175-t174*t177-t31*t45*t58*t181*t2
     #6-t31*t45*t47*t32*t35*t26-t191-t197-t201-t202-t203
      t206 = t15*t198*t18
      t207 = t206*t69
      t208 = t93*t102
      t209 = t206*t208
      t211 = t206*t96*t102
      t215 = t58*t47*t62
      t217 = t46*t150
      t218 = t144*t217
      t223 = t218*t65*t53
      t224 = t45*t150
      t225 = t144*t224
      t226 = t132*t26
      t228 = t135*t26
      t229 = t225*t228
      t230 = t144*t173
      t231 = t60*t26
      t233 = t65*t26
      t234 = t230*t233
      t235 = -t207-t209-t211-t144*t106*t153-t145*t215-t218*t215-t218*t60
     #*t53-t223-t225*t226-t229-t230*t231-t234
      t242 = den(2*t7+2*dotp(k2,k4)+2*dotp(k3,k4))
      t244 = -t28-t143-t149-t168-t172-t191-t197-t201-t202-t203-t207-t209
      t246 = t15*t17*t58
      t250 = t15*t139*t58
      t252 = t24*t44
      t253 = t252*t25
      t257 = t15*t169*t58
      t259 = t23*t253
      t262 = 1/spb(k3,k4)
      t263 = t105*t262
      t265 = t15*t263*t18
      t269 = -t211-t223-t229-t234-t246*t175-t246*t177-t250*t103-t250*t36
     #*t253-t257*t69-t257*t259-t265*t208-t265*t126*t102
      t272 = t15*t262*t150
      t276 = t15*t263*t58
      t277 = t181*t102
      t283 = t263*t40
      t284 = t15*t283
      t287 = t44**2
      t292 = t263*t45
      t293 = t15*t292
      t301 = t262*t18
      t305 = t262*t58
      t309 = t262*t40
      t310 = t309*t150
      t311 = t15*t310
      t313 = -t272*t175-t265*t259-t276*t277-t276*t126*t253-t276*t93*t253
     #-t284*t58*t21*t22*t24*t287*t25-t293*t18*t32*t92*t166-t272*t127-t14
     #4*t124*t233-t15*t301*t68*t26-t15*t305*t157*t26-t311*t69
      t315 = t309*t58
      t319 = t262*t45
      t320 = t319*t150
      t321 = t15*t320
      t324 = t319*t18
      t331 = t12*t105
      t335 = t73*t26
      t343 = t12*t262
      t348 = -t311*t259-t15*t315*t68*t253-t321*t158-t321*t277-t15*t324*t
     #157*t102-t144*t105*t58*t228-t331*t301*t233-t331*t305*t335-t331*t31
     #5*t65*t253-t331*t324*t73*t102-t343*t151*t233-t343*t224*t335
      t352 = t14*t262
      t353 = t31*t352
      t357 = t31*t352*t40
      t361 = t31*t352*t45
      t364 = t31*t263
      t369 = t31*t283
      t373 = t31*t292
      t380 = t31*t309
      t383 = t31*t319
      t388 = t353*t127+t353*t175+t357*t69+t357*t259+t361*t158+t361*t277+
     #t364*t18*t22*t26+t364*t226+t369*t215+t369*t112*t253+t373*t18*t47*t
     #62+t373*t18*t92*t102+t380*t231+t380*t233+t383*t18*t59*t26+t383*t33
     #5
      t390 = dotp(k1,kq)
      t393 = den(2*t5-2*t390-2*dotp(k2,kq))
      t394 = spa(k2,q1)
      t396 = t22*t24
      t397 = t25**2
      t398 = t396*t397
      t401 = spa(k2,q2)
      t402 = t401*t22
      t403 = spb(q2,r2)
      t404 = t26*t403
      t405 = t402*t404
      t408 = t92*t24
      t409 = t408*t397
      t415 = spa(k1,q1)
      t419 = spa(k1,q2)
      t420 = t419*t22
      t421 = t420*t404
      t427 = t419*t92*t404
      t431 = den(-2*t390)
      t433 = t415*t394
      t434 = t397*t25
      t435 = t396*t434
      t436 = t433*t435
      t438 = t415*t401
      t440 = t24*t397
      t441 = t440*t403
      t442 = t438*t22*t441
      t444 = t419*t394
      t446 = t444*t22*t441
      t448 = t419*t401
      t450 = t403**2
      t451 = t26*t450
      t452 = t448*t22*t451
      t467 = t150*t415
      t468 = t467*t398
      t477 = -t284*t436-t284*t442-t284*t446-t284*t452-t293*t433*t408*t43
     #4-t293*t438*t92*t441-t293*t444*t92*t441-t293*t448*t92*t451-t331*t3
     #09*t468-t331*t310*t421-t331*t319*t467*t409-t331*t320*t427
      t481 = t415*t35
      t489 = t101*t397
      t492 = t15*t17
      t497 = t39*t25*t403
      t501 = t415*t21
      t509 = t52*t397
      t512 = t46*t419
      t516 = t51*t25*t403
      t519 = t15*t198
      t520 = t501*t409
      t528 = t15*t198*t419
      t529 = t93*t404
      t533 = -t15*t139*t481*t398-t15*t139*t419*t36*t404-t161*t481*t92*t4
     #89-t492*t129*t419*t100*t24*t497-t15*t169*t501*t398-t15*t169*t419*t
     #23*t404-t193*t501*t59*t509-t492*t512*t68*t24*t516-t519*t520-t519*t
     #415*t59*t35*t24*t397-t528*t529-t528*t96*t404
      t534 = t15*t263
      t535 = t415*t32
      t536 = t535*t398
      t540 = t15*t263*t419
      t541 = t126*t404
      t548 = t15*t105
      t549 = t309*t419
      t559 = t319*t419
      t566 = t59*t24*t397
      t578 = -t534*t536-t534*t520-t540*t541-t540*t529-t284*t501*t22*t252
     #*t397-t548*t549*t23*t24*t44*t25*t403-t293*t535*t92*t489-t548*t559*
     #t181*t24*t497-t15*t309*t501*t566-t15*t549*t68*t404-t15*t319*t535*t
     #566-t15*t559*t157*t404
      t582 = den(-2*dotp(k4,kqb))
      t583 = t431*t582
      t585 = spa(k3,q1)
      t587 = t397**2
      t591 = t46*t415
      t592 = t548*t591
      t593 = spa(k3,q2)
      t595 = t394*t593*t22
      t597 = t24*t434*t403
      t601 = t401*t585*t22
      t605 = t401*t593*t22
      t606 = t440*t450
      t609 = t548*t512
      t610 = t394*t585
      t622 = t15*t591
      t623 = t32*t394
      t627 = t32*t401*t22
      t630 = t15*t512
      t631 = t623*t22
      t636 = t15*t115*t433*t585*t396*t587+t592*t595*t597+t592*t601*t597+
     #t592*t605*t606+t609*t610*t22*t597+t609*t595*t606+t609*t601*t606+t6
     #09*t605*t26*t450*t403+t622*t623*t435+t622*t627*t441+t630*t631*t441
     #+t630*t627*t451
      t637 = t331*t217
      t638 = t18*t415
      t641 = t638*t22*t61*t397
      t649 = t420*t24*t13*t25*t403
      t652 = t415*t585*t435
      t656 = t415*t593*t22*t441
      t660 = t419*t585*t22*t441
      t664 = t419*t593*t22*t451
      t666 = t331*t56
      t671 = t12*t40
      t677 = t637*t641+t331*t40*t224*t18*t649+t637*t652+t637*t656+t637*t
     #660+t637*t664+t666*t436+t666*t442+t666*t446+t666*t452+t671*t224*t5
     #36+t671*t224*t419*t541
      t691 = t144*t129*t638*t398
      t692 = t145*t421
      t694 = t144*t46*t468
      t695 = t218*t421
      t696 = -t161*t652-t161*t656-t161*t660-t161*t664-t193*t436-t193*t44
     #2-t193*t446-t193*t452-t691-t692-t694-t695
      t700 = t82*t631*t509
      t705 = t402*t24*t516
      t706 = t31*t14*t46*t32*t705
      t711 = t593*t22
      t712 = t711*t404
      t714 = t116*t641
      t717 = t31*t105*t56*t649
      t719 = t18*t585
      t723 = t31*t46
      t725 = t18*t394*t398
      t726 = t723*t725
      t727 = t57*t405
      t728 = t723*t536
      t730 = t31*t512*t541
      t731 = -t700-t706-t31*t89*t32*t585*t398-t91*t712-t714-t717-t31*t12
     #9*t719*t398-t131*t712-t726-t727-t728-t730
      t751 = -t161*t719*t22*t489-t492*t130*t711*t24*t497-t193*t150*t394*
     #t22*t509-t492*t217*t705-t519*t150*t585*t398-t200*t712-t519*t725-t2
     #06*t405-t691-t692-t694-t695
      t767 = -t700-t706-t82*t610*t435-t82*t595*t441-t82*t601*t441-t82*t6
     #05*t451-t714-t717-t116*t652-t116*t656-t116*t660-t116*t664-t726-t72
     #7-t728-t730
      aMMMM = t4*t9*(t99+t155+t204+t235)+t4*t242*(t244+t269+t313+t348)+t
     #4*t388+t393*(t353*t40*t394*t398+t357*t405+t353*t45*t394*t409+t361*
     #t401*t92*t404+t364*t40*t415*t398+t369*t421+t364*t45*t415*t409+t373
     #*t427)+t431*t393*t477+t431*t242*(t533+t578)+t583*t393*(t636+t677)+
     #t583*t696+t582*t9*(t731+t751)+t582*t393*t767
