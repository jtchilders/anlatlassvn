!ER: cancellare la parte finale commentata
ccccccccccccccccccccccccccccccccccccccccccccccccccccc
c     Copied and modified from MAD_real_routines_DR.f
ccccccccccccccccccccccccccccccccccccccccccccccccccccc

      SUBROUTINE Suxu_twmbx_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : u~ u -> t w- b~  
C  
C Crossing   1 is u~ u -> t w- b~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 uxu_twmbx_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2uxu_twmbx_undec(maxamps), jamp2uxu_twmbx_undec(0:maxamps)
      common/to_ampsuxu_twmbx_undec/  amp2uxu_twmbx_undec,       jamp2uxu_twmbx_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixuxu_twmbx_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    2/          
      DATA jamp2uxu_twmbx_undec(0) /   1/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2uxu_twmbx_undec(ihel)=0d0
              jamp2uxu_twmbx_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2uxu_twmbx_undec(0))
              jamp2uxu_twmbx_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=uxu_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=uxu_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2uxu_twmbx_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2uxu_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION uxu_twmbx_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : u~ u -> t w- b~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2uxu_twmbx_undec(maxamps), jamp2uxu_twmbx_undec(0:maxamps)
      common/to_ampsuxu_twmbx_undec/  amp2uxu_twmbx_undec,       jamp2uxu_twmbx_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            1/                                       
      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
C               T[ 3, 2]T[ 1, 5]                                           
C ----------
C BEGIN CODE
C ----------
      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWF ,AMP(1   ))          
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
      amp(1)=(0,0) !:
      JAMP(   1) = +AMP(   1)+AMP(   2)
      uxu_twmbx_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          uxu_twmbx_undec =uxu_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2uxu_twmbx_undec(i)=amp2uxu_twmbx_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2uxu_twmbx_undec(i)=Jamp2uxu_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END


      SUBROUTINE Suxb_twmux_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : u~ b -> t w- u~  
C  
C Crossing   1 is u~ b -> t w- u~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 uxb_twmux_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2uxb_twmux_undec(maxamps), jamp2uxb_twmux_undec(0:maxamps)
      common/to_ampsuxb_twmux_undec/  amp2uxb_twmux_undec,       jamp2uxb_twmux_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixuxb_twmux_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    2/          
      DATA jamp2uxb_twmux_undec(0) /   1/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2uxb_twmux_undec(ihel)=0d0
              jamp2uxb_twmux_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2uxb_twmux_undec(0))
              jamp2uxb_twmux_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=uxb_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=uxb_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2uxb_twmux_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2uxb_twmux_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION uxb_twmux_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : u~ b -> t w- u~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2uxb_twmux_undec(maxamps), jamp2uxb_twmux_undec(0:maxamps)
      common/to_ampsuxb_twmux_undec/  amp2uxb_twmux_undec,       jamp2uxb_twmux_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            1/                                       
      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
C               T[ 3, 5]T[ 1, 2]                                           
C ----------
C BEGIN CODE
C ----------
      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
      CALL FVIXXX(W(1,2   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      JAMP(   1) = -AMP(   1)-AMP(   2)
      uxb_twmux_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          uxb_twmux_undec =uxb_twmux_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2uxb_twmux_undec(i)=amp2uxb_twmux_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2uxb_twmux_undec(i)=Jamp2uxb_twmux_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Suux_twmbx_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : u u~ -> t w- b~  
C  
C Crossing   1 is u u~ -> t w- b~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 uux_twmbx_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2uux_twmbx_undec(maxamps), jamp2uux_twmbx_undec(0:maxamps)
      common/to_ampsuux_twmbx_undec/  amp2uux_twmbx_undec,       jamp2uux_twmbx_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixuux_twmbx_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    2/          
      DATA jamp2uux_twmbx_undec(0) /   1/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2uux_twmbx_undec(ihel)=0d0
              jamp2uux_twmbx_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2uux_twmbx_undec(0))
              jamp2uux_twmbx_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=uux_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=uux_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2uux_twmbx_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2uux_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION uux_twmbx_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : u u~ -> t w- b~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2uux_twmbx_undec(maxamps), jamp2uux_twmbx_undec(0:maxamps)
      common/to_ampsuux_twmbx_undec/  amp2uux_twmbx_undec,       jamp2uux_twmbx_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            1/                                       
      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
C               T[ 3, 1]T[ 2, 5]                                           
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWF ,AMP(1   ))          
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
      amp(1)=(0,0) !:
      JAMP(   1) = -AMP(   1)-AMP(   2)
      uux_twmbx_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          uux_twmbx_undec =uux_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2uux_twmbx_undec(i)=amp2uux_twmbx_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2uux_twmbx_undec(i)=Jamp2uux_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sub_twmu_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : u b -> t w- u  
C  
C Crossing   1 is u b -> t w- u  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 ub_twmu_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2ub_twmu_undec(maxamps), jamp2ub_twmu_undec(0:maxamps)
      common/to_ampsub_twmu_undec/  amp2ub_twmu_undec,       jamp2ub_twmu_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixub_twmu_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    2/          
      DATA jamp2ub_twmu_undec(0) /   1/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2ub_twmu_undec(ihel)=0d0
              jamp2ub_twmu_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2ub_twmu_undec(0))
              jamp2ub_twmu_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=ub_twmu_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=ub_twmu_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2ub_twmu_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2ub_twmu_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION ub_twmu_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : u b -> t w- u  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2ub_twmu_undec(maxamps), jamp2ub_twmu_undec(0:maxamps)
      common/to_ampsub_twmu_undec/  amp2ub_twmu_undec,       jamp2ub_twmu_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            1/                                       
      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
C               T[ 5, 2]T[ 3, 1]                                           
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
      CALL FVIXXX(W(1,2   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      JAMP(   1) = +AMP(   1)+AMP(   2)
      ub_twmu_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          ub_twmu_undec =ub_twmu_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2ub_twmu_undec(i)=amp2ub_twmu_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2ub_twmu_undec(i)=Jamp2ub_twmu_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sbxb_twmbx_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : b~ b -> t w- b~  
C  
C Crossing   1 is b~ b -> t w- b~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 bxb_twmbx_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bxb_twmbx_undec(maxamps), jamp2bxb_twmbx_undec(0:maxamps)
      common/to_ampsbxb_twmbx_undec/  amp2bxb_twmbx_undec,       jamp2bxb_twmbx_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixbxb_twmbx_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    4/          
      DATA jamp2bxb_twmbx_undec(0) /   2/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2bxb_twmbx_undec(ihel)=0d0
              jamp2bxb_twmbx_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2bxb_twmbx_undec(0))
              jamp2bxb_twmbx_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=bxb_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=bxb_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2bxb_twmbx_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2bxb_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION bxb_twmbx_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : b~ b -> t w- b~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bxb_twmbx_undec(maxamps), jamp2bxb_twmbx_undec(0:maxamps)
      common/to_ampsbxb_twmbx_undec/  amp2bxb_twmbx_undec,       jamp2bxb_twmbx_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            3/                                       
      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
C               T[ 3, 5]T[ 1, 2]                                           
      DATA Denom(2  )/            3/                                       
      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
C               T[ 3, 2]T[ 1, 5]                                           
C ----------
C BEGIN CODE
C ----------
      CALL OXXXXX(P(0,1   ),BMASS ,NHEL(1   ),-1*IC(1   ),W(1,1   ))       
      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
      CALL FVIXXX(W(1,2   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,9   ))     
      CALL FVOXXX(W(1,3   ),W(1,9   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,4   ),GWF ,AMP(3   ))          
      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,9   ),GG ,AMP(4   ))             
      amp(3)=(0,0) !:
      JAMP(   1) = -AMP(   1)-AMP(   2)
      JAMP(   2) = +AMP(   3)+AMP(   4)
      bxb_twmbx_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          bxb_twmbx_undec =bxb_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2bxb_twmbx_undec(i)=amp2bxb_twmbx_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2bxb_twmbx_undec(i)=Jamp2bxb_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END


      SUBROUTINE Sbux_twmux_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : b u~ -> t w- u~  
C  
C Crossing   1 is b u~ -> t w- u~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 bux_twmux_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bux_twmux_undec(maxamps), jamp2bux_twmux_undec(0:maxamps)
      common/to_ampsbux_twmux_undec/  amp2bux_twmux_undec,       jamp2bux_twmux_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixbux_twmux_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    2/          
      DATA jamp2bux_twmux_undec(0) /   1/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2bux_twmux_undec(ihel)=0d0
              jamp2bux_twmux_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2bux_twmux_undec(0))
              jamp2bux_twmux_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=bux_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=bux_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2bux_twmux_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2bux_twmux_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION bux_twmux_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : b u~ -> t w- u~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bux_twmux_undec(maxamps), jamp2bux_twmux_undec(0:maxamps)
      common/to_ampsbux_twmux_undec/  amp2bux_twmux_undec,       jamp2bux_twmux_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            1/                                       
      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
C               T[ 3, 5]T[ 2, 1]                                           
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
      CALL FVIXXX(W(1,1   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      JAMP(   1) = +AMP(   1)+AMP(   2)
      bux_twmux_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          bux_twmux_undec =bux_twmux_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2bux_twmux_undec(i)=amp2bux_twmux_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2bux_twmux_undec(i)=Jamp2bux_twmux_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sbu_twmu_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : b u -> t w- u  
C  
C Crossing   1 is b u -> t w- u  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 bu_twmu_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bu_twmu_undec(maxamps), jamp2bu_twmu_undec(0:maxamps)
      common/to_ampsbu_twmu_undec/  amp2bu_twmu_undec,       jamp2bu_twmu_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixbu_twmu_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    2/          
      DATA jamp2bu_twmu_undec(0) /   1/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2bu_twmu_undec(ihel)=0d0
              jamp2bu_twmu_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2bu_twmu_undec(0))
              jamp2bu_twmu_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=bu_twmu_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=bu_twmu_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2bu_twmu_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2bu_twmu_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION bu_twmu_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : b u -> t w- u  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bu_twmu_undec(maxamps), jamp2bu_twmu_undec(0:maxamps)
      common/to_ampsbu_twmu_undec/  amp2bu_twmu_undec,       jamp2bu_twmu_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            1/                                       
      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
C               T[ 5, 1]T[ 3, 2]                                           
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
      CALL FVIXXX(W(1,1   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      JAMP(   1) = -AMP(   1)-AMP(   2)
      bu_twmu_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          bu_twmu_undec =bu_twmu_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2bu_twmu_undec(i)=amp2bu_twmu_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2bu_twmu_undec(i)=Jamp2bu_twmu_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sbbx_twmbx_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : b b~ -> t w- b~  
C  
C Crossing   1 is b b~ -> t w- b~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 bbx_twmbx_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bbx_twmbx_undec(maxamps), jamp2bbx_twmbx_undec(0:maxamps)
      common/to_ampsbbx_twmbx_undec/  amp2bbx_twmbx_undec,       jamp2bbx_twmbx_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixbbx_twmbx_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    4/          
      DATA jamp2bbx_twmbx_undec(0) /   2/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2bbx_twmbx_undec(ihel)=0d0
              jamp2bbx_twmbx_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2bbx_twmbx_undec(0))
              jamp2bbx_twmbx_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=bbx_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=bbx_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2bbx_twmbx_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2bbx_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION bbx_twmbx_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : b b~ -> t w- b~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bbx_twmbx_undec(maxamps), jamp2bbx_twmbx_undec(0:maxamps)
      common/to_ampsbbx_twmbx_undec/  amp2bbx_twmbx_undec,       jamp2bbx_twmbx_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            3/                                       
      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
C               T[ 3, 5]T[ 2, 1]                                           
      DATA Denom(2  )/            3/                                       
      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
C               T[ 3, 1]T[ 2, 5]                                           
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
      CALL OXXXXX(P(0,2   ),BMASS ,NHEL(2   ),-1*IC(2   ),W(1,2   ))       
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
      CALL FVIXXX(W(1,1   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,9   ))     
      CALL FVOXXX(W(1,3   ),W(1,9   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,4   ),GWF ,AMP(3   ))          
      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,9   ),GG ,AMP(4   ))             
      amp(3)=(0,0) !:
      JAMP(   1) = +AMP(   1)+AMP(   2)
      JAMP(   2) = -AMP(   3)-AMP(   4)
      bbx_twmbx_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          bbx_twmbx_undec =bbx_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2bbx_twmbx_undec(i)=amp2bbx_twmbx_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2bbx_twmbx_undec(i)=Jamp2bbx_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sbb_twmb_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : b b -> t w- b  
C  
C Crossing   1 is b b -> t w- b  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 bb_twmb_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bb_twmb_undec(maxamps), jamp2bb_twmb_undec(0:maxamps)
      common/to_ampsbb_twmb_undec/  amp2bb_twmb_undec,       jamp2bb_twmb_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixbb_twmb_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    4/          
      DATA jamp2bb_twmb_undec(0) /   2/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2bb_twmb_undec(ihel)=0d0
              jamp2bb_twmb_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2bb_twmb_undec(0))
              jamp2bb_twmb_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=bb_twmb_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=bb_twmb_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2bb_twmb_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2bb_twmb_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION bb_twmb_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : b b -> t w- b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bb_twmb_undec(maxamps), jamp2bb_twmb_undec(0:maxamps)
      common/to_ampsbb_twmb_undec/  amp2bb_twmb_undec,       jamp2bb_twmb_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            3/                                       
      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
C               T[ 5, 1]T[ 3, 2]                                           
      DATA Denom(2  )/            3/                                       
      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
C               T[ 5, 2]T[ 3, 1]                                           
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL OXXXXX(P(0,5   ),BMASS ,NHEL(5   ),+1*IC(5   ),W(1,5   ))       
      CALL FVIXXX(W(1,1   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     8   ))                                                          
      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
      CALL FVIXXX(W(1,2   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     9   ))                                                          
      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,10  ))     
      CALL IOVXXX(W(1,9   ),W(1,3   ),W(1,10  ),GG ,AMP(3   ))             
      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,10  ),GG ,AMP(4   ))             
      JAMP(   1) = -AMP(   1)-AMP(   2)
      JAMP(   2) = +AMP(   3)+AMP(   4)
      bb_twmb_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          bb_twmb_undec =bb_twmb_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2bb_twmb_undec(i)=amp2bb_twmb_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2bb_twmb_undec(i)=Jamp2bb_twmb_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END


      SUBROUTINE Sbg_twmg_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : b g -> t w- g  
C  
C Crossing   1 is b g -> t w- g  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 bg_twmg_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bg_twmg_undec(maxamps), jamp2bg_twmg_undec(0:maxamps)
      common/to_ampsbg_twmg_undec/  amp2bg_twmg_undec,       jamp2bg_twmg_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixbg_twmg_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    8/          
      DATA jamp2bg_twmg_undec(0) /   2/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  96/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2bg_twmg_undec(ihel)=0d0
              jamp2bg_twmg_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2bg_twmg_undec(0))
              jamp2bg_twmg_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=bg_twmg_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=bg_twmg_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2bg_twmg_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2bg_twmg_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION bg_twmg_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : b g -> t w- g  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=  14, NCOLOR=   2) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2bg_twmg_undec(maxamps), jamp2bg_twmg_undec(0:maxamps)
      common/to_ampsbg_twmg_undec/  amp2bg_twmg_undec,       jamp2bg_twmg_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            3/                                       
      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
C               T[ 3, 1, 2, 5]                                             
      DATA Denom(2  )/            3/                                       
      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
C               T[ 3, 1, 5, 2]                                             
C ----------
C BEGIN CODE
C ----------
      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
      CALL VXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL VXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
      CALL FVOXXX(W(1,3   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,6   ))     
      CALL FVOXXX(W(1,6   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     7   ))                                                          
      CALL IOVXXX(W(1,1   ),W(1,7   ),W(1,5   ),GG ,AMP(1   ))             
      CALL FVIXXX(W(1,1   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     8   ))                                                          
      CALL JVVXXX(W(1,5   ),W(1,2   ),G ,ZERO    ,ZERO    ,W(1,9   ))      
      CALL IOVXXX(W(1,8   ),W(1,3   ),W(1,9   ),GG ,AMP(2   ))             
      CALL FVOXXX(W(1,3   ),W(1,5   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
      CALL IOVXXX(W(1,8   ),W(1,10  ),W(1,2   ),GG ,AMP(3   ))             
      CALL IOVXXX(W(1,8   ),W(1,6   ),W(1,5   ),GG ,AMP(4   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     11  ))                                                          
      CALL FVIXXX(W(1,1   ),W(1,5   ),GG ,BMASS   ,ZERO    ,W(1,12  ))     
      CALL IOVXXX(W(1,12  ),W(1,11  ),W(1,2   ),GG ,AMP(5   ))             
      CALL IOVXXX(W(1,1   ),W(1,11  ),W(1,9   ),GG ,AMP(6   ))             
      CALL FVIXXX(W(1,1   ),W(1,2   ),GG ,BMASS   ,ZERO    ,W(1,13  ))     
      CALL FVIXXX(W(1,13  ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     14  ))                                                          
      CALL IOVXXX(W(1,14  ),W(1,3   ),W(1,5   ),GG ,AMP(7   ))             
      CALL IOVXXX(W(1,13  ),W(1,11  ),W(1,5   ),GG ,AMP(8   ))             
      JAMP(   1) = +AMP(   1)-AMP(   2)+AMP(   4)+AMP(   5)-AMP(   6)
      JAMP(   2) = +AMP(   2)+AMP(   3)+AMP(   6)+AMP(   7)+AMP(   8)
      bg_twmg_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          bg_twmg_undec =bg_twmg_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2bg_twmg_undec(i)=amp2bg_twmg_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2bg_twmg_undec(i)=Jamp2bg_twmg_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sgb_twmg_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : g b -> t w- g  
C  
C Crossing   1 is g b -> t w- g  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 gb_twmg_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2gb_twmg_undec(maxamps), jamp2gb_twmg_undec(0:maxamps)
      common/to_ampsgb_twmg_undec/  amp2gb_twmg_undec,       jamp2gb_twmg_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixgb_twmg_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    8/          
      DATA jamp2gb_twmg_undec(0) /   2/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) /  96/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2gb_twmg_undec(ihel)=0d0
              jamp2gb_twmg_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2gb_twmg_undec(0))
              jamp2gb_twmg_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=gb_twmg_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=gb_twmg_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2gb_twmg_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2gb_twmg_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION gb_twmg_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : g b -> t w- g  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=  14, NCOLOR=   2) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2gb_twmg_undec(maxamps), jamp2gb_twmg_undec(0:maxamps)
      common/to_ampsgb_twmg_undec/  amp2gb_twmg_undec,       jamp2gb_twmg_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            3/                                       
      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
C               T[ 3, 2, 1, 5]                                             
      DATA Denom(2  )/            3/                                       
      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
C               T[ 3, 2, 5, 1]                                             
C ----------
C BEGIN CODE
C ----------
      CALL VXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL VXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
      CALL FVIXXX(W(1,2   ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     6   ))                                                          
      CALL JVVXXX(W(1,5   ),W(1,1   ),G ,ZERO    ,ZERO    ,W(1,7   ))      
      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,3   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,8   ))     
      CALL FVOXXX(W(1,8   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     9   ))                                                          
      CALL IOVXXX(W(1,2   ),W(1,9   ),W(1,5   ),GG ,AMP(2   ))             
      CALL FVOXXX(W(1,3   ),W(1,5   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
      CALL IOVXXX(W(1,6   ),W(1,10  ),W(1,1   ),GG ,AMP(3   ))             
      CALL IOVXXX(W(1,6   ),W(1,8   ),W(1,5   ),GG ,AMP(4   ))             
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     11  ))                                                          
      CALL IOVXXX(W(1,2   ),W(1,11  ),W(1,7   ),GG ,AMP(5   ))             
      CALL FVIXXX(W(1,2   ),W(1,5   ),GG ,BMASS   ,ZERO    ,W(1,12  ))     
      CALL IOVXXX(W(1,12  ),W(1,11  ),W(1,1   ),GG ,AMP(6   ))             
      CALL FVIXXX(W(1,2   ),W(1,1   ),GG ,BMASS   ,ZERO    ,W(1,13  ))     
      CALL FVIXXX(W(1,13  ),W(1,4   ),GWF ,TMASS   ,TWIDTH  ,W(1,        
     &     14  ))                                                          
      CALL IOVXXX(W(1,14  ),W(1,3   ),W(1,5   ),GG ,AMP(7   ))             
      CALL IOVXXX(W(1,13  ),W(1,11  ),W(1,5   ),GG ,AMP(8   ))             
      JAMP(   1) = -AMP(   1)+AMP(   2)+AMP(   4)-AMP(   5)+AMP(   6)
      JAMP(   2) = +AMP(   1)+AMP(   3)+AMP(   5)+AMP(   7)+AMP(   8)
      gb_twmg_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          gb_twmg_undec =gb_twmg_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2gb_twmg_undec(i)=amp2gb_twmg_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2gb_twmg_undec(i)=Jamp2gb_twmg_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

      SUBROUTINE Sgg_twmbx_undec(P1,ANS)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : g g -> t w- b~  
C  
C Crossing   1 is g g -> t w- b~  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      Include "genps_r.inc"
      INTEGER                 NCOMB,     NCROSS         
      PARAMETER (             NCOMB=  48, NCROSS=  1)
      INTEGER    THEL
      PARAMETER (THEL=NCOMB*NCROSS)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
      REAL*8 T, P(0:3,NEXTERNAL)
      REAL*8 gg_twmbx_undec
      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
      INTEGER IPROC,JC(NEXTERNAL), I
      LOGICAL GOODHEL(NCOMB,NCROSS)
      INTEGER NGRAPHS
      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
      LOGICAL warned
      REAL     xran1
      EXTERNAL xran1
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2gg_twmbx_undec(maxamps), jamp2gg_twmbx_undec(0:maxamps)
      common/to_ampsgg_twmbx_undec/  amp2gg_twmbx_undec,       jamp2gg_twmbx_undec

      character*79         hel_buff
      common/to_helicity/  hel_buff

      REAL*8 POL(2)
      common/to_polarization/ POL

      integer          isum_hel
      logical                    multi_channel
      common/to_matrixgg_twmbx_undec/isum_hel, multi_channel
      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
      common/to_mconfigs/mapconfig, iconfig
      DATA NTRY,IDUM /0,-1/
      DATA xtry, xrej, ngood /0,0,0/
      DATA warned, isum_hel/.false.,0/
      DATA multi_channel/.false./
      SAVE yfrac, igood, jhel
      DATA NGRAPHS /    8/          
      DATA jamp2gg_twmbx_undec(0) /   2/          
      DATA GOODHEL/THEL*.FALSE./
      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
      DATA (IDEN(IHEL),IHEL=  1,  1) / 256/
C ----------
C BEGIN CODE
C ----------
      NTRY=NTRY+1
      DO IPROC=1,NCROSS
      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
      DO IHEL=1,NEXTERNAL
         JC(IHEL) = +1
      ENDDO
       
      IF (multi_channel) THEN
          DO IHEL=1,NGRAPHS
              amp2gg_twmbx_undec(ihel)=0d0
              jamp2gg_twmbx_undec(ihel)=0d0
          ENDDO
          DO IHEL=1,int(jamp2gg_twmbx_undec(0))
              jamp2gg_twmbx_undec(ihel)=0d0
          ENDDO
      ENDIF
      ANS(IPROC) = 0D0
      write(hel_buff,'(16i5)') (0,i=1,nexternal)
      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
          DO IHEL=1,NCOMB
             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
                 T=gg_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
               DO JJ=1,nincoming
                 IF(POL(JJ).NE.1d0.AND.
     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                   T=T*ABS(POL(JJ))
                 ELSE IF(POL(JJ).NE.1d0)THEN
                   T=T*(2d0-ABS(POL(JJ)))
                 ENDIF
               ENDDO
               ANS(IPROC)=ANS(IPROC)+T
               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
                   GOODHEL(IHEL,IPROC)=.TRUE.
                   NGOOD = NGOOD +1
                   IGOOD(NGOOD) = IHEL
               ENDIF
             ENDIF
          ENDDO
          JHEL = 1
          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
      ELSE              !RANDOM HELICITY
          DO J=1,ISUM_HEL
              JHEL=JHEL+1
              IF (JHEL .GT. NGOOD) JHEL=1
              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
              IHEL = IGOOD(JHEL)
              T=gg_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
              DO JJ=1,nincoming
                IF(POL(JJ).NE.1d0.AND.
     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
                  T=T*ABS(POL(JJ))
                ELSE IF(POL(JJ).NE.1d0)THEN
                  T=T*(2d0-ABS(POL(JJ)))
                ENDIF
              ENDDO
              ANS(IPROC)=ANS(IPROC)+T*HWGT
          ENDDO
          IF (ISUM_HEL .EQ. 1) THEN
              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
          ENDIF
      ENDIF
      IF (MULTI_CHANNEL) THEN
          XTOT=0D0
          DO IHEL=1,MAPCONFIG(0)
              XTOT=XTOT+AMP2gg_twmbx_undec(MAPCONFIG(IHEL))
          ENDDO
          IF (XTOT.NE.0D0) THEN
              ANS(IPROC)=ANS(IPROC)*AMP2gg_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
          ELSE
              ANS(IPROC)=0D0
          ENDIF
      ENDIF
      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
      ENDDO
      END
       
       
      REAL*8 FUNCTION gg_twmbx_undec(P,NHEL,IC)
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : g g -> t w- b~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
      include "genps_r.inc"
      INTEGER    NWAVEFUNCS     , NCOLOR
      PARAMETER (NWAVEFUNCS=  16, NCOLOR=   2) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,NEXTERNAL)
      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      COMPLEX*16 ZTEMP
      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
      COMPLEX*16 W(18,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      Double Precision amp2gg_twmbx_undec(maxamps), jamp2gg_twmbx_undec(0:maxamps)
      common/to_ampsgg_twmbx_undec/  amp2gg_twmbx_undec,       jamp2gg_twmbx_undec
      include "../coupl.inc"
C  
C COLOR DATA
C  
      DATA Denom(1  )/            3/                                       
      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
C               T[ 3, 5, 2, 1]                                             
      DATA Denom(2  )/            3/                                       
      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
C               T[ 3, 5, 1, 2]                                             
C ----------
C BEGIN CODE
C ----------
      CALL VXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
      CALL VXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
      CALL FVOXXX(W(1,3   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,6   ))     
      CALL FVOXXX(W(1,6   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     7   ))                                                          
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GG ,AMP(1   ))             
      CALL FVOXXX(W(1,6   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,8   ))     
      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,4   ),GWF ,AMP(2   ))          
      CALL FVOXXX(W(1,3   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,9   ))     
      CALL FVOXXX(W(1,9   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     10  ))                                                          
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,2   ),GG ,AMP(3   ))             
      CALL FVOXXX(W(1,9   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,11  ))     
      CALL IOVXXX(W(1,5   ),W(1,11  ),W(1,4   ),GWF ,AMP(4   ))          
      CALL FVOXXX(W(1,3   ),W(1,4   ),GWF ,BMASS   ,ZERO    ,W(1,        
     &     12  ))                                                          
      CALL FVIXXX(W(1,5   ),W(1,1   ),GG ,BMASS   ,ZERO    ,W(1,13  ))     
      CALL IOVXXX(W(1,13  ),W(1,12  ),W(1,2   ),GG ,AMP(5   ))             
      CALL FVIXXX(W(1,5   ),W(1,2   ),GG ,BMASS   ,ZERO    ,W(1,14  ))     
      CALL IOVXXX(W(1,14  ),W(1,12  ),W(1,1   ),GG ,AMP(6   ))             
      CALL JVVXXX(W(1,1   ),W(1,2   ),G ,ZERO    ,ZERO    ,W(1,15  ))      
      CALL FVOXXX(W(1,3   ),W(1,15  ),GG ,TMASS   ,TWIDTH  ,W(1,16  ))     
      CALL IOVXXX(W(1,5   ),W(1,16  ),W(1,4   ),GWF ,AMP(7   ))          
      CALL IOVXXX(W(1,5   ),W(1,12  ),W(1,15  ),GG ,AMP(8   ))             
      amp(2)=(0,0) !:
      amp(4)=(0,0) !:
      amp(7)=(0,0) !:
      JAMP(   1) = -AMP(   1)-AMP(   2)-AMP(   5)+AMP(   7)+AMP(   8)
      JAMP(   2) = -AMP(   3)-AMP(   4)-AMP(   6)-AMP(   7)-AMP(   8)
      gg_twmbx_undec = 0.D0 
      DO I = 1, NCOLOR
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NCOLOR
              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
          ENDDO
          gg_twmbx_undec =gg_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
      ENDDO
      Do I = 1, NGRAPHS
          amp2gg_twmbx_undec(i)=amp2gg_twmbx_undec(i)+amp(i)*dconjg(amp(i))
      Enddo
      Do I = 1, NCOLOR
          Jamp2gg_twmbx_undec(i)=Jamp2gg_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
      Enddo
C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
      END

cccccccccccccccccc!ER:
c$$$
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Sbbx_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b b~ -> t w- d~  
c$$$C  
c$$$C Crossing   1 is b b~ -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bbx_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bbx_twmdx(maxamps), jamp2bbx_twmdx(0:maxamps)
c$$$      common/to_ampsbbx_twmdx/  amp2bbx_twmdx,       jamp2bbx_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbbx_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bbx_twmdx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bbx_twmdx(ihel)=0d0
c$$$              jamp2bbx_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bbx_twmdx(0))
c$$$              jamp2bbx_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bbx_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bbx_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bbx_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bbx_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bbx_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b b~ -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bbx_twmdx(maxamps), jamp2bbx_twmdx(0:maxamps)
c$$$      common/to_ampsbbx_twmdx/  amp2bbx_twmdx,       jamp2bbx_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 1]T[ 2, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
c$$$      CALL OXXXXX(P(0,2   ),BMASS ,NHEL(2   ),-1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTD ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      bbx_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bbx_twmdx =bbx_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bbx_twmdx(i)=amp2bbx_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bbx_twmdx(i)=Jamp2bbx_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sbbx_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b b~ -> t w- s~  
c$$$C  
c$$$C Crossing   1 is b b~ -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bbx_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bbx_twmsx(maxamps), jamp2bbx_twmsx(0:maxamps)
c$$$      common/to_ampsbbx_twmsx/  amp2bbx_twmsx,       jamp2bbx_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbbx_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bbx_twmsx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bbx_twmsx(ihel)=0d0
c$$$              jamp2bbx_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bbx_twmsx(0))
c$$$              jamp2bbx_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bbx_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bbx_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bbx_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bbx_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bbx_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b b~ -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bbx_twmsx(maxamps), jamp2bbx_twmsx(0:maxamps)
c$$$      common/to_ampsbbx_twmsx/  amp2bbx_twmsx,       jamp2bbx_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 1]T[ 2, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
c$$$      CALL OXXXXX(P(0,2   ),BMASS ,NHEL(2   ),-1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTS ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      bbx_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bbx_twmsx =bbx_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bbx_twmsx(i)=amp2bbx_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bbx_twmsx(i)=Jamp2bbx_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sbd_twmb(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b d -> t w- b  
c$$$C  
c$$$C Crossing   1 is b d -> t w- b  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bd_twmb
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bd_twmb(maxamps), jamp2bd_twmb(0:maxamps)
c$$$      common/to_ampsbd_twmb/  amp2bd_twmb,       jamp2bd_twmb
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbd_twmb/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bd_twmb(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bd_twmb(ihel)=0d0
c$$$              jamp2bd_twmb(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bd_twmb(0))
c$$$              jamp2bd_twmb(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bd_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bd_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bd_twmb(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bd_twmb(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bd_twmb(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b d -> t w- b  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bd_twmb(maxamps), jamp2bd_twmb(0:maxamps)
c$$$      common/to_ampsbd_twmb/  amp2bd_twmb,       jamp2bd_twmb
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 2]T[ 3, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),BMASS ,NHEL(5   ),+1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      bd_twmb = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bd_twmb =bd_twmb+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bd_twmb(i)=amp2bd_twmb(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bd_twmb(i)=Jamp2bd_twmb(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Sbs_twmb(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b s -> t w- b  
c$$$C  
c$$$C Crossing   1 is b s -> t w- b  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bs_twmb
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bs_twmb(maxamps), jamp2bs_twmb(0:maxamps)
c$$$      common/to_ampsbs_twmb/  amp2bs_twmb,       jamp2bs_twmb
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbs_twmb/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bs_twmb(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bs_twmb(ihel)=0d0
c$$$              jamp2bs_twmb(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bs_twmb(0))
c$$$              jamp2bs_twmb(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bs_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bs_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bs_twmb(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bs_twmb(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bs_twmb(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b s -> t w- b  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bs_twmb(maxamps), jamp2bs_twmb(0:maxamps)
c$$$      common/to_ampsbs_twmb/  amp2bs_twmb,       jamp2bs_twmb
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 2]T[ 3, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),BMASS ,NHEL(1   ),+1*IC(1   ),W(1,1   ))       
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),BMASS ,NHEL(5   ),+1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      bs_twmb = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bs_twmb =bs_twmb+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bs_twmb(i)=amp2bs_twmb(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bs_twmb(i)=Jamp2bs_twmb(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Sbxb_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ b -> t w- d~  
c$$$C  
c$$$C Crossing   1 is b~ b -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bxb_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxb_twmdx(maxamps), jamp2bxb_twmdx(0:maxamps)
c$$$      common/to_ampsbxb_twmdx/  amp2bxb_twmdx,       jamp2bxb_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbxb_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bxb_twmdx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bxb_twmdx(ihel)=0d0
c$$$              jamp2bxb_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bxb_twmdx(0))
c$$$              jamp2bxb_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bxb_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bxb_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bxb_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bxb_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bxb_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ b -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxb_twmdx(maxamps), jamp2bxb_twmdx(0:maxamps)
c$$$      common/to_ampsbxb_twmdx/  amp2bxb_twmdx,       jamp2bxb_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 2]T[ 1, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),BMASS ,NHEL(1   ),-1*IC(1   ),W(1,1   ))       
c$$$      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTD ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      bxb_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bxb_twmdx =bxb_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bxb_twmdx(i)=amp2bxb_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bxb_twmdx(i)=Jamp2bxb_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sbxb_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ b -> t w- s~  
c$$$C  
c$$$C Crossing   1 is b~ b -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bxb_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxb_twmsx(maxamps), jamp2bxb_twmsx(0:maxamps)
c$$$      common/to_ampsbxb_twmsx/  amp2bxb_twmsx,       jamp2bxb_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbxb_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bxb_twmsx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bxb_twmsx(ihel)=0d0
c$$$              jamp2bxb_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bxb_twmsx(0))
c$$$              jamp2bxb_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bxb_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bxb_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bxb_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bxb_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bxb_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ b -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxb_twmsx(maxamps), jamp2bxb_twmsx(0:maxamps)
c$$$      common/to_ampsbxb_twmsx/  amp2bxb_twmsx,       jamp2bxb_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 2]T[ 1, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),BMASS ,NHEL(1   ),-1*IC(1   ),W(1,1   ))       
c$$$      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTS ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      bxb_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bxb_twmsx =bxb_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bxb_twmsx(i)=amp2bxb_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bxb_twmsx(i)=Jamp2bxb_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sbxd_twmbx_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ d -> t w- b~  
c$$$C  
c$$$C Crossing   1 is b~ d -> t w- b~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bxd_twmbx_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxd_twmbx_undec(maxamps), jamp2bxd_twmbx_undec(0:maxamps)
c$$$      common/to_ampsbxd_twmbx_undec/  amp2bxd_twmbx_undec,       jamp2bxd_twmbx_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbxd_twmbx_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bxd_twmbx_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bxd_twmbx_undec(ihel)=0d0
c$$$              jamp2bxd_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bxd_twmbx_undec(0))
c$$$              jamp2bxd_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bxd_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bxd_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bxd_twmbx_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bxd_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bxd_twmbx_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ d -> t w- b~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxd_twmbx_undec(maxamps), jamp2bxd_twmbx_undec(0:maxamps)
c$$$      common/to_ampsbxd_twmbx_undec/  amp2bxd_twmbx_undec,       jamp2bxd_twmbx_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 1, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),BMASS ,NHEL(1   ),-1*IC(1   ),W(1,1   ))       
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      bxd_twmbx_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bxd_twmbx_undec =bxd_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bxd_twmbx_undec(i)=amp2bxd_twmbx_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bxd_twmbx_undec(i)=Jamp2bxd_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sbxs_twmbx_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ s -> t w- b~  
c$$$C  
c$$$C Crossing   1 is b~ s -> t w- b~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 bxs_twmbx_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxs_twmbx_undec(maxamps), jamp2bxs_twmbx_undec(0:maxamps)
c$$$      common/to_ampsbxs_twmbx_undec/  amp2bxs_twmbx_undec,       jamp2bxs_twmbx_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixbxs_twmbx_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2bxs_twmbx_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2bxs_twmbx_undec(ihel)=0d0
c$$$              jamp2bxs_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2bxs_twmbx_undec(0))
c$$$              jamp2bxs_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=bxs_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=bxs_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2bxs_twmbx_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2bxs_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION bxs_twmbx_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : b~ s -> t w- b~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2bxs_twmbx_undec(maxamps), jamp2bxs_twmbx_undec(0:maxamps)
c$$$      common/to_ampsbxs_twmbx_undec/  amp2bxs_twmbx_undec,       jamp2bxs_twmbx_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 1, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),BMASS ,NHEL(1   ),-1*IC(1   ),W(1,1   ))       
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      bxs_twmbx_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          bxs_twmbx_undec =bxs_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2bxs_twmbx_undec(i)=amp2bxs_twmbx_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2bxs_twmbx_undec(i)=Jamp2bxs_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdb_twmb(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d b -> t w- b  
c$$$C  
c$$$C Crossing   1 is d b -> t w- b  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 db_twmb
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2db_twmb(maxamps), jamp2db_twmb(0:maxamps)
c$$$      common/to_ampsdb_twmb/  amp2db_twmb,       jamp2db_twmb
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdb_twmb/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2db_twmb(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2db_twmb(ihel)=0d0
c$$$              jamp2db_twmb(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2db_twmb(0))
c$$$              jamp2db_twmb(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=db_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=db_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2db_twmb(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2db_twmb(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION db_twmb(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d b -> t w- b  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2db_twmb(maxamps), jamp2db_twmb(0:maxamps)
c$$$      common/to_ampsdb_twmb/  amp2db_twmb,       jamp2db_twmb
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 1]T[ 3, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),BMASS ,NHEL(5   ),+1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      db_twmb = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          db_twmb =db_twmb+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2db_twmb(i)=amp2db_twmb(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2db_twmb(i)=Jamp2db_twmb(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdbx_twmbx_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d b~ -> t w- b~  
c$$$C  
c$$$C Crossing   1 is d b~ -> t w- b~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 dbx_twmbx_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dbx_twmbx_undec(maxamps), jamp2dbx_twmbx_undec(0:maxamps)
c$$$      common/to_ampsdbx_twmbx_undec/  amp2dbx_twmbx_undec,       jamp2dbx_twmbx_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdbx_twmbx_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2dbx_twmbx_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2dbx_twmbx_undec(ihel)=0d0
c$$$              jamp2dbx_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2dbx_twmbx_undec(0))
c$$$              jamp2dbx_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=dbx_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=dbx_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2dbx_twmbx_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2dbx_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION dbx_twmbx_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d b~ -> t w- b~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dbx_twmbx_undec(maxamps), jamp2dbx_twmbx_undec(0:maxamps)
c$$$      common/to_ampsdbx_twmbx_undec/  amp2dbx_twmbx_undec,       jamp2dbx_twmbx_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 2, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),BMASS ,NHEL(2   ),-1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      dbx_twmbx_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          dbx_twmbx_undec =dbx_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2dbx_twmbx_undec(i)=amp2dbx_twmbx_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2dbx_twmbx_undec(i)=Jamp2dbx_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdd_twmd(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d d -> t w- d  
c$$$C  
c$$$C Crossing   1 is d d -> t w- d  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 dd_twmd
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dd_twmd(maxamps), jamp2dd_twmd(0:maxamps)
c$$$      common/to_ampsdd_twmd/  amp2dd_twmd,       jamp2dd_twmd
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdd_twmd/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    4/          
c$$$      DATA jamp2dd_twmd(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2dd_twmd(ihel)=0d0
c$$$              jamp2dd_twmd(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2dd_twmd(0))
c$$$              jamp2dd_twmd(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=dd_twmd(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=dd_twmd(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2dd_twmd(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2dd_twmd(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION dd_twmd(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d d -> t w- d  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dd_twmd(maxamps), jamp2dd_twmd(0:maxamps)
c$$$      common/to_ampsdd_twmd/  amp2dd_twmd,       jamp2dd_twmd
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
c$$$C               T[ 5, 1]T[ 3, 2]                                           
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
c$$$C               T[ 5, 2]T[ 3, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     9   ))                                                          
c$$$      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,9   ),W(1,3   ),W(1,10  ),GG ,AMP(3   ))             
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,10  ),GG ,AMP(4   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      JAMP(   2) = +AMP(   3)+AMP(   4)
c$$$      dd_twmd = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          dd_twmd =dd_twmd+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2dd_twmd(i)=amp2dd_twmd(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2dd_twmd(i)=Jamp2dd_twmd(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sddx_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d d~ -> t w- d~  
c$$$C  
c$$$C Crossing   1 is d d~ -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 ddx_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ddx_twmdx(maxamps), jamp2ddx_twmdx(0:maxamps)
c$$$      common/to_ampsddx_twmdx/  amp2ddx_twmdx,       jamp2ddx_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixddx_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    4/          
c$$$      DATA jamp2ddx_twmdx(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2ddx_twmdx(ihel)=0d0
c$$$              jamp2ddx_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2ddx_twmdx(0))
c$$$              jamp2ddx_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=ddx_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=ddx_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2ddx_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2ddx_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION ddx_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d d~ -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ddx_twmdx(maxamps), jamp2ddx_twmdx(0:maxamps)
c$$$      common/to_ampsddx_twmdx/  amp2ddx_twmdx,       jamp2ddx_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
c$$$C               T[ 3, 5]T[ 2, 1]                                           
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
c$$$C               T[ 3, 1]T[ 2, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,9   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,9   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,4   ),GWFTD ,AMP(3   ))          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,9   ),GG ,AMP(4   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      JAMP(   2) = -AMP(   3)-AMP(   4)
c$$$      ddx_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          ddx_twmdx =ddx_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2ddx_twmdx(i)=amp2ddx_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2ddx_twmdx(i)=Jamp2ddx_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdg_twmg(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d g -> t w- g  
c$$$C  
c$$$C Crossing   1 is d g -> t w- g  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 dg_twmg
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dg_twmg(maxamps), jamp2dg_twmg(0:maxamps)
c$$$      common/to_ampsdg_twmg/  amp2dg_twmg,       jamp2dg_twmg
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdg_twmg/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    8/          
c$$$      DATA jamp2dg_twmg(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  96/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2dg_twmg(ihel)=0d0
c$$$              jamp2dg_twmg(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2dg_twmg(0))
c$$$              jamp2dg_twmg(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=dg_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=dg_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2dg_twmg(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2dg_twmg(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION dg_twmg(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d g -> t w- g  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  14, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dg_twmg(maxamps), jamp2dg_twmg(0:maxamps)
c$$$      common/to_ampsdg_twmg/  amp2dg_twmg,       jamp2dg_twmg
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
c$$$C               T[ 3, 1, 2, 5]                                             
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
c$$$C               T[ 3, 1, 5, 2]                                             
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL VXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL VXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVOXXX(W(1,3   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,6   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     7   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,7   ),W(1,5   ),GG ,AMP(1   ))             
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL JVVXXX(W(1,5   ),W(1,2   ),G ,ZERO    ,ZERO    ,W(1,9   ))      
c$$$      CALL IOVXXX(W(1,8   ),W(1,3   ),W(1,9   ),GG ,AMP(2   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,5   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,8   ),W(1,10  ),W(1,2   ),GG ,AMP(3   ))             
c$$$      CALL IOVXXX(W(1,8   ),W(1,6   ),W(1,5   ),GG ,AMP(4   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     11  ))                                                          
c$$$      CALL FVIXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,12  ))     
c$$$      CALL IOVXXX(W(1,12  ),W(1,11  ),W(1,2   ),GG ,AMP(5   ))             
c$$$      CALL IOVXXX(W(1,1   ),W(1,11  ),W(1,9   ),GG ,AMP(6   ))             
c$$$      CALL FVIXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,13  ))     
c$$$      CALL FVIXXX(W(1,13  ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     14  ))                                                          
c$$$      CALL IOVXXX(W(1,14  ),W(1,3   ),W(1,5   ),GG ,AMP(7   ))             
c$$$      CALL IOVXXX(W(1,13  ),W(1,11  ),W(1,5   ),GG ,AMP(8   ))             
c$$$      JAMP(   1) = +AMP(   1)-AMP(   2)+AMP(   4)+AMP(   5)-AMP(   6)
c$$$      JAMP(   2) = +AMP(   2)+AMP(   3)+AMP(   6)+AMP(   7)+AMP(   8)
c$$$      dg_twmg = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          dg_twmg =dg_twmg+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2dg_twmg(i)=amp2dg_twmg(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2dg_twmg(i)=Jamp2dg_twmg(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdu_twmu(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d u -> t w- u  
c$$$C  
c$$$C Crossing   1 is d u -> t w- u  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 du_twmu
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2du_twmu(maxamps), jamp2du_twmu(0:maxamps)
c$$$      common/to_ampsdu_twmu/  amp2du_twmu,       jamp2du_twmu
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdu_twmu/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2du_twmu(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2du_twmu(ihel)=0d0
c$$$              jamp2du_twmu(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2du_twmu(0))
c$$$              jamp2du_twmu(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=du_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=du_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2du_twmu(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2du_twmu(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION du_twmu(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d u -> t w- u  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2du_twmu(maxamps), jamp2du_twmu(0:maxamps)
c$$$      common/to_ampsdu_twmu/  amp2du_twmu,       jamp2du_twmu
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 1]T[ 3, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      du_twmu = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          du_twmu =du_twmu+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2du_twmu(i)=amp2du_twmu(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2du_twmu(i)=Jamp2du_twmu(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdux_twmux_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d u~ -> t w- u~  
c$$$C  
c$$$C Crossing   1 is d u~ -> t w- u~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 dux_twmux_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dux_twmux_undec(maxamps), jamp2dux_twmux_undec(0:maxamps)
c$$$      common/to_ampsdux_twmux_undec/  amp2dux_twmux_undec,       jamp2dux_twmux_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdux_twmux_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2dux_twmux_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2dux_twmux_undec(ihel)=0d0
c$$$              jamp2dux_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2dux_twmux_undec(0))
c$$$              jamp2dux_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=dux_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=dux_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2dux_twmux_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2dux_twmux_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION dux_twmux_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d u~ -> t w- u~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dux_twmux_undec(maxamps), jamp2dux_twmux_undec(0:maxamps)
c$$$      common/to_ampsdux_twmux_undec/  amp2dux_twmux_undec,       jamp2dux_twmux_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 2, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      dux_twmux_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          dux_twmux_undec =dux_twmux_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2dux_twmux_undec(i)=amp2dux_twmux_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2dux_twmux_undec(i)=Jamp2dux_twmux_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sdxd_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d~ d -> t w- d~  
c$$$C  
c$$$C Crossing   1 is d~ d -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 dxd_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dxd_twmdx(maxamps), jamp2dxd_twmdx(0:maxamps)
c$$$      common/to_ampsdxd_twmdx/  amp2dxd_twmdx,       jamp2dxd_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixdxd_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    4/          
c$$$      DATA jamp2dxd_twmdx(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2dxd_twmdx(ihel)=0d0
c$$$              jamp2dxd_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2dxd_twmdx(0))
c$$$              jamp2dxd_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=dxd_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=dxd_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2dxd_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2dxd_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION dxd_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : d~ d -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2dxd_twmdx(maxamps), jamp2dxd_twmdx(0:maxamps)
c$$$      common/to_ampsdxd_twmdx/  amp2dxd_twmdx,       jamp2dxd_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
c$$$C               T[ 3, 5]T[ 1, 2]                                           
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
c$$$C               T[ 3, 2]T[ 1, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,9   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,9   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,4   ),GWFTD ,AMP(3   ))          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,9   ),GG ,AMP(4   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      JAMP(   2) = +AMP(   3)+AMP(   4)
c$$$      dxd_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          dxd_twmdx =dxd_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2dxd_twmdx(i)=amp2dxd_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2dxd_twmdx(i)=Jamp2dxd_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Sgd_twmg(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g d -> t w- g  
c$$$C  
c$$$C Crossing   1 is g d -> t w- g  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 gd_twmg
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gd_twmg(maxamps), jamp2gd_twmg(0:maxamps)
c$$$      common/to_ampsgd_twmg/  amp2gd_twmg,       jamp2gd_twmg
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixgd_twmg/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    8/          
c$$$      DATA jamp2gd_twmg(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  96/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2gd_twmg(ihel)=0d0
c$$$              jamp2gd_twmg(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2gd_twmg(0))
c$$$              jamp2gd_twmg(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=gd_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=gd_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2gd_twmg(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2gd_twmg(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION gd_twmg(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g d -> t w- g  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  14, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gd_twmg(maxamps), jamp2gd_twmg(0:maxamps)
c$$$      common/to_ampsgd_twmg/  amp2gd_twmg,       jamp2gd_twmg
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
c$$$C               T[ 3, 2, 1, 5]                                             
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
c$$$C               T[ 3, 2, 5, 1]                                             
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL VXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL VXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JVVXXX(W(1,5   ),W(1,1   ),G ,ZERO    ,ZERO    ,W(1,7   ))      
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,8   ))     
c$$$      CALL FVOXXX(W(1,8   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     9   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,9   ),W(1,5   ),GG ,AMP(2   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,5   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,10  ),W(1,1   ),GG ,AMP(3   ))             
c$$$      CALL IOVXXX(W(1,6   ),W(1,8   ),W(1,5   ),GG ,AMP(4   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     11  ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,11  ),W(1,7   ),GG ,AMP(5   ))             
c$$$      CALL FVIXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,12  ))     
c$$$      CALL IOVXXX(W(1,12  ),W(1,11  ),W(1,1   ),GG ,AMP(6   ))             
c$$$      CALL FVIXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,13  ))     
c$$$      CALL FVIXXX(W(1,13  ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     14  ))                                                          
c$$$      CALL IOVXXX(W(1,14  ),W(1,3   ),W(1,5   ),GG ,AMP(7   ))             
c$$$      CALL IOVXXX(W(1,13  ),W(1,11  ),W(1,5   ),GG ,AMP(8   ))             
c$$$      JAMP(   1) = -AMP(   1)+AMP(   2)+AMP(   4)-AMP(   5)+AMP(   6)
c$$$      JAMP(   2) = +AMP(   1)+AMP(   3)+AMP(   5)+AMP(   7)+AMP(   8)
c$$$      gd_twmg = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          gd_twmg =gd_twmg+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2gd_twmg(i)=amp2gd_twmg(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2gd_twmg(i)=Jamp2gd_twmg(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Sgg_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g g -> t w- d~  
c$$$C  
c$$$C Crossing   1 is g g -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 gg_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gg_twmdx(maxamps), jamp2gg_twmdx(0:maxamps)
c$$$      common/to_ampsgg_twmdx/  amp2gg_twmdx,       jamp2gg_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixgg_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    8/          
c$$$      DATA jamp2gg_twmdx(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) / 256/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2gg_twmdx(ihel)=0d0
c$$$              jamp2gg_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2gg_twmdx(0))
c$$$              jamp2gg_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=gg_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=gg_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2gg_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2gg_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION gg_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g g -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  16, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gg_twmdx(maxamps), jamp2gg_twmdx(0:maxamps)
c$$$      common/to_ampsgg_twmdx/  amp2gg_twmdx,       jamp2gg_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
c$$$C               T[ 3, 5, 2, 1]                                             
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
c$$$C               T[ 3, 5, 1, 2]                                             
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL VXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL VXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVOXXX(W(1,3   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,6   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     7   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,6   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,8   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,4   ),GWFTD ,AMP(2   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,9   ))     
c$$$      CALL FVOXXX(W(1,9   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     10  ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,2   ),GG ,AMP(3   ))             
c$$$      CALL FVOXXX(W(1,9   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,11  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,11  ),W(1,4   ),GWFTD ,AMP(4   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     12  ))                                                          
c$$$      CALL FVIXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,13  ))     
c$$$      CALL IOVXXX(W(1,13  ),W(1,12  ),W(1,2   ),GG ,AMP(5   ))             
c$$$      CALL FVIXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,14  ))     
c$$$      CALL IOVXXX(W(1,14  ),W(1,12  ),W(1,1   ),GG ,AMP(6   ))             
c$$$      CALL JVVXXX(W(1,1   ),W(1,2   ),G ,ZERO    ,ZERO    ,W(1,15  ))      
c$$$      CALL FVOXXX(W(1,3   ),W(1,15  ),GG ,TMASS   ,TWIDTH  ,W(1,16  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,16  ),W(1,4   ),GWFTD ,AMP(7   ))          
c$$$      CALL IOVXXX(W(1,5   ),W(1,12  ),W(1,15  ),GG ,AMP(8   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)-AMP(   5)+AMP(   7)+AMP(   8)
c$$$      JAMP(   2) = -AMP(   3)-AMP(   4)-AMP(   6)-AMP(   7)-AMP(   8)
c$$$      gg_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          gg_twmdx =gg_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2gg_twmdx(i)=amp2gg_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2gg_twmdx(i)=Jamp2gg_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sgg_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g g -> t w- s~  
c$$$C  
c$$$C Crossing   1 is g g -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 gg_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gg_twmsx(maxamps), jamp2gg_twmsx(0:maxamps)
c$$$      common/to_ampsgg_twmsx/  amp2gg_twmsx,       jamp2gg_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixgg_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    8/          
c$$$      DATA jamp2gg_twmsx(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) / 256/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2gg_twmsx(ihel)=0d0
c$$$              jamp2gg_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2gg_twmsx(0))
c$$$              jamp2gg_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=gg_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=gg_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2gg_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2gg_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION gg_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g g -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  16, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gg_twmsx(maxamps), jamp2gg_twmsx(0:maxamps)
c$$$      common/to_ampsgg_twmsx/  amp2gg_twmsx,       jamp2gg_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
c$$$C               T[ 3, 5, 2, 1]                                             
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
c$$$C               T[ 3, 5, 1, 2]                                             
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL VXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL VXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVOXXX(W(1,3   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,6   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     7   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,6   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,8   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,4   ),GWFTS ,AMP(2   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,9   ))     
c$$$      CALL FVOXXX(W(1,9   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     10  ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,2   ),GG ,AMP(3   ))             
c$$$      CALL FVOXXX(W(1,9   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,11  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,11  ),W(1,4   ),GWFTS ,AMP(4   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     12  ))                                                          
c$$$      CALL FVIXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,13  ))     
c$$$      CALL IOVXXX(W(1,13  ),W(1,12  ),W(1,2   ),GG ,AMP(5   ))             
c$$$      CALL FVIXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,14  ))     
c$$$      CALL IOVXXX(W(1,14  ),W(1,12  ),W(1,1   ),GG ,AMP(6   ))             
c$$$      CALL JVVXXX(W(1,1   ),W(1,2   ),G ,ZERO    ,ZERO    ,W(1,15  ))      
c$$$      CALL FVOXXX(W(1,3   ),W(1,15  ),GG ,TMASS   ,TWIDTH  ,W(1,16  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,16  ),W(1,4   ),GWFTS ,AMP(7   ))          
c$$$      CALL IOVXXX(W(1,5   ),W(1,12  ),W(1,15  ),GG ,AMP(8   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)-AMP(   5)+AMP(   7)+AMP(   8)
c$$$      JAMP(   2) = -AMP(   3)-AMP(   4)-AMP(   6)-AMP(   7)-AMP(   8)
c$$$      gg_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          gg_twmsx =gg_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2gg_twmsx(i)=amp2gg_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2gg_twmsx(i)=Jamp2gg_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sgs_twmg(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g s -> t w- g  
c$$$C  
c$$$C Crossing   1 is g s -> t w- g  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 gs_twmg
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gs_twmg(maxamps), jamp2gs_twmg(0:maxamps)
c$$$      common/to_ampsgs_twmg/  amp2gs_twmg,       jamp2gs_twmg
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixgs_twmg/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    8/          
c$$$      DATA jamp2gs_twmg(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  96/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2gs_twmg(ihel)=0d0
c$$$              jamp2gs_twmg(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2gs_twmg(0))
c$$$              jamp2gs_twmg(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=gs_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=gs_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2gs_twmg(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2gs_twmg(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION gs_twmg(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : g s -> t w- g  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  14, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2gs_twmg(maxamps), jamp2gs_twmg(0:maxamps)
c$$$      common/to_ampsgs_twmg/  amp2gs_twmg,       jamp2gs_twmg
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
c$$$C               T[ 3, 2, 1, 5]                                             
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
c$$$C               T[ 3, 2, 5, 1]                                             
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL VXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL VXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JVVXXX(W(1,5   ),W(1,1   ),G ,ZERO    ,ZERO    ,W(1,7   ))      
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,1   ),GG ,TMASS   ,TWIDTH  ,W(1,8   ))     
c$$$      CALL FVOXXX(W(1,8   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     9   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,9   ),W(1,5   ),GG ,AMP(2   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,5   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,10  ),W(1,1   ),GG ,AMP(3   ))             
c$$$      CALL IOVXXX(W(1,6   ),W(1,8   ),W(1,5   ),GG ,AMP(4   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     11  ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,11  ),W(1,7   ),GG ,AMP(5   ))             
c$$$      CALL FVIXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,12  ))     
c$$$      CALL IOVXXX(W(1,12  ),W(1,11  ),W(1,1   ),GG ,AMP(6   ))             
c$$$      CALL FVIXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,13  ))     
c$$$      CALL FVIXXX(W(1,13  ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     14  ))                                                          
c$$$      CALL IOVXXX(W(1,14  ),W(1,3   ),W(1,5   ),GG ,AMP(7   ))             
c$$$      CALL IOVXXX(W(1,13  ),W(1,11  ),W(1,5   ),GG ,AMP(8   ))             
c$$$      JAMP(   1) = -AMP(   1)+AMP(   2)+AMP(   4)-AMP(   5)+AMP(   6)
c$$$      JAMP(   2) = +AMP(   1)+AMP(   3)+AMP(   5)+AMP(   7)+AMP(   8)
c$$$      gs_twmg = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          gs_twmg =gs_twmg+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2gs_twmg(i)=amp2gs_twmg(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2gs_twmg(i)=Jamp2gs_twmg(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Ssb_twmb(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s b -> t w- b  
c$$$C  
c$$$C Crossing   1 is s b -> t w- b  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 sb_twmb
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sb_twmb(maxamps), jamp2sb_twmb(0:maxamps)
c$$$      common/to_ampssb_twmb/  amp2sb_twmb,       jamp2sb_twmb
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixsb_twmb/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2sb_twmb(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2sb_twmb(ihel)=0d0
c$$$              jamp2sb_twmb(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2sb_twmb(0))
c$$$              jamp2sb_twmb(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=sb_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=sb_twmb(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2sb_twmb(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2sb_twmb(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION sb_twmb(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s b -> t w- b  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sb_twmb(maxamps), jamp2sb_twmb(0:maxamps)
c$$$      common/to_ampssb_twmb/  amp2sb_twmb,       jamp2sb_twmb
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 1]T[ 3, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),BMASS ,NHEL(2   ),+1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),BMASS ,NHEL(5   ),+1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      sb_twmb = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          sb_twmb =sb_twmb+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2sb_twmb(i)=amp2sb_twmb(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2sb_twmb(i)=Jamp2sb_twmb(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Ssbx_twmbx_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s b~ -> t w- b~  
c$$$C  
c$$$C Crossing   1 is s b~ -> t w- b~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 sbx_twmbx_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sbx_twmbx_undec(maxamps), jamp2sbx_twmbx_undec(0:maxamps)
c$$$      common/to_ampssbx_twmbx_undec/  amp2sbx_twmbx_undec,       jamp2sbx_twmbx_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixsbx_twmbx_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2sbx_twmbx_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2sbx_twmbx_undec(ihel)=0d0
c$$$              jamp2sbx_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2sbx_twmbx_undec(0))
c$$$              jamp2sbx_twmbx_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=sbx_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=sbx_twmbx_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2sbx_twmbx_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2sbx_twmbx_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION sbx_twmbx_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s b~ -> t w- b~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sbx_twmbx_undec(maxamps), jamp2sbx_twmbx_undec(0:maxamps)
c$$$      common/to_ampssbx_twmbx_undec/  amp2sbx_twmbx_undec,       jamp2sbx_twmbx_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 2, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),BMASS ,NHEL(2   ),-1*IC(2   ),W(1,2   ))       
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),BMASS ,NHEL(5   ),-1*IC(5   ),W(1,5   ))       
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      sbx_twmbx_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          sbx_twmbx_undec =sbx_twmbx_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2sbx_twmbx_undec(i)=amp2sbx_twmbx_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2sbx_twmbx_undec(i)=Jamp2sbx_twmbx_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Ssg_twmg(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s g -> t w- g  
c$$$C  
c$$$C Crossing   1 is s g -> t w- g  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 sg_twmg
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sg_twmg(maxamps), jamp2sg_twmg(0:maxamps)
c$$$      common/to_ampssg_twmg/  amp2sg_twmg,       jamp2sg_twmg
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixsg_twmg/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    8/          
c$$$      DATA jamp2sg_twmg(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  96/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2sg_twmg(ihel)=0d0
c$$$              jamp2sg_twmg(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2sg_twmg(0))
c$$$              jamp2sg_twmg(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=sg_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=sg_twmg(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2sg_twmg(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2sg_twmg(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION sg_twmg(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s g -> t w- g  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   8,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  14, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sg_twmg(maxamps), jamp2sg_twmg(0:maxamps)
c$$$      common/to_ampssg_twmg/  amp2sg_twmg,       jamp2sg_twmg
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /    16,   -2/                            
c$$$C               T[ 3, 1, 2, 5]                                             
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,   16/                            
c$$$C               T[ 3, 1, 5, 2]                                             
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL VXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL VXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVOXXX(W(1,3   ),W(1,2   ),GG ,TMASS   ,TWIDTH  ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,6   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     7   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,7   ),W(1,5   ),GG ,AMP(1   ))             
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL JVVXXX(W(1,5   ),W(1,2   ),G ,ZERO    ,ZERO    ,W(1,9   ))      
c$$$      CALL IOVXXX(W(1,8   ),W(1,3   ),W(1,9   ),GG ,AMP(2   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,5   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,8   ),W(1,10  ),W(1,2   ),GG ,AMP(3   ))             
c$$$      CALL IOVXXX(W(1,8   ),W(1,6   ),W(1,5   ),GG ,AMP(4   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     11  ))                                                          
c$$$      CALL FVIXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,12  ))     
c$$$      CALL IOVXXX(W(1,12  ),W(1,11  ),W(1,2   ),GG ,AMP(5   ))             
c$$$      CALL IOVXXX(W(1,1   ),W(1,11  ),W(1,9   ),GG ,AMP(6   ))             
c$$$      CALL FVIXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,13  ))     
c$$$      CALL FVIXXX(W(1,13  ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     14  ))                                                          
c$$$      CALL IOVXXX(W(1,14  ),W(1,3   ),W(1,5   ),GG ,AMP(7   ))             
c$$$      CALL IOVXXX(W(1,13  ),W(1,11  ),W(1,5   ),GG ,AMP(8   ))             
c$$$      JAMP(   1) = +AMP(   1)-AMP(   2)+AMP(   4)+AMP(   5)-AMP(   6)
c$$$      JAMP(   2) = +AMP(   2)+AMP(   3)+AMP(   6)+AMP(   7)+AMP(   8)
c$$$      sg_twmg = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          sg_twmg =sg_twmg+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2sg_twmg(i)=amp2sg_twmg(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2sg_twmg(i)=Jamp2sg_twmg(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sss_twms(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s s -> t w- s  
c$$$C  
c$$$C Crossing   1 is s s -> t w- s  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 ss_twms
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ss_twms(maxamps), jamp2ss_twms(0:maxamps)
c$$$      common/to_ampsss_twms/  amp2ss_twms,       jamp2ss_twms
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixss_twms/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    4/          
c$$$      DATA jamp2ss_twms(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2ss_twms(ihel)=0d0
c$$$              jamp2ss_twms(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2ss_twms(0))
c$$$              jamp2ss_twms(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=ss_twms(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=ss_twms(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2ss_twms(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2ss_twms(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION ss_twms(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s s -> t w- s  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ss_twms(maxamps), jamp2ss_twms(0:maxamps)
c$$$      common/to_ampsss_twms/  amp2ss_twms,       jamp2ss_twms
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
c$$$C               T[ 5, 1]T[ 3, 2]                                           
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
c$$$C               T[ 5, 2]T[ 3, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     9   ))                                                          
c$$$      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,9   ),W(1,3   ),W(1,10  ),GG ,AMP(3   ))             
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,10  ),GG ,AMP(4   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      JAMP(   2) = +AMP(   3)+AMP(   4)
c$$$      ss_twms = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          ss_twms =ss_twms+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2ss_twms(i)=amp2ss_twms(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2ss_twms(i)=Jamp2ss_twms(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sssx_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s s~ -> t w- s~  
c$$$C  
c$$$C Crossing   1 is s s~ -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 ssx_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ssx_twmsx(maxamps), jamp2ssx_twmsx(0:maxamps)
c$$$      common/to_ampsssx_twmsx/  amp2ssx_twmsx,       jamp2ssx_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixssx_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    4/          
c$$$      DATA jamp2ssx_twmsx(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2ssx_twmsx(ihel)=0d0
c$$$              jamp2ssx_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2ssx_twmsx(0))
c$$$              jamp2ssx_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=ssx_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=ssx_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2ssx_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2ssx_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION ssx_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s s~ -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ssx_twmsx(maxamps), jamp2ssx_twmsx(0:maxamps)
c$$$      common/to_ampsssx_twmsx/  amp2ssx_twmsx,       jamp2ssx_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
c$$$C               T[ 3, 5]T[ 2, 1]                                           
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
c$$$C               T[ 3, 1]T[ 2, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,9   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,9   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,4   ),GWFTS ,AMP(3   ))          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,9   ),GG ,AMP(4   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      JAMP(   2) = -AMP(   3)-AMP(   4)
c$$$      ssx_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          ssx_twmsx =ssx_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2ssx_twmsx(i)=amp2ssx_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2ssx_twmsx(i)=Jamp2ssx_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Ssu_twmu(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s u -> t w- u  
c$$$C  
c$$$C Crossing   1 is s u -> t w- u  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 su_twmu
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2su_twmu(maxamps), jamp2su_twmu(0:maxamps)
c$$$      common/to_ampssu_twmu/  amp2su_twmu,       jamp2su_twmu
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixsu_twmu/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2su_twmu(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2su_twmu(ihel)=0d0
c$$$              jamp2su_twmu(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2su_twmu(0))
c$$$              jamp2su_twmu(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=su_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=su_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2su_twmu(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2su_twmu(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION su_twmu(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s u -> t w- u  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2su_twmu(maxamps), jamp2su_twmu(0:maxamps)
c$$$      common/to_ampssu_twmu/  amp2su_twmu,       jamp2su_twmu
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 1]T[ 3, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,2   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      su_twmu = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          su_twmu =su_twmu+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2su_twmu(i)=amp2su_twmu(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2su_twmu(i)=Jamp2su_twmu(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Ssux_twmux_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s u~ -> t w- u~  
c$$$C  
c$$$C Crossing   1 is s u~ -> t w- u~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 sux_twmux_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sux_twmux_undec(maxamps), jamp2sux_twmux_undec(0:maxamps)
c$$$      common/to_ampssux_twmux_undec/  amp2sux_twmux_undec,       jamp2sux_twmux_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixsux_twmux_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2sux_twmux_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2sux_twmux_undec(ihel)=0d0
c$$$              jamp2sux_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2sux_twmux_undec(0))
c$$$              jamp2sux_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=sux_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=sux_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2sux_twmux_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2sux_twmux_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION sux_twmux_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s u~ -> t w- u~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sux_twmux_undec(maxamps), jamp2sux_twmux_undec(0:maxamps)
c$$$      common/to_ampssux_twmux_undec/  amp2sux_twmux_undec,       jamp2sux_twmux_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 2, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,1   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,1   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      sux_twmux_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          sux_twmux_undec =sux_twmux_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2sux_twmux_undec(i)=amp2sux_twmux_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2sux_twmux_undec(i)=Jamp2sux_twmux_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Ssxs_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s~ s -> t w- s~  
c$$$C  
c$$$C Crossing   1 is s~ s -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 sxs_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sxs_twmsx(maxamps), jamp2sxs_twmsx(0:maxamps)
c$$$      common/to_ampssxs_twmsx/  amp2sxs_twmsx,       jamp2sxs_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixsxs_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    4/          
c$$$      DATA jamp2sxs_twmsx(0) /   2/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2sxs_twmsx(ihel)=0d0
c$$$              jamp2sxs_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2sxs_twmsx(0))
c$$$              jamp2sxs_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=sxs_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=sxs_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2sxs_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2sxs_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION sxs_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : s~ s -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   4,NEIGEN=  2) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=  10, NCOLOR=   2) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2sxs_twmsx(maxamps), jamp2sxs_twmsx(0:maxamps)
c$$$      common/to_ampssxs_twmsx/  amp2sxs_twmsx,       jamp2sxs_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            3/                                       
c$$$      DATA (CF(i,1  ),i=1  ,2  ) /     6,   -2/                            
c$$$C               T[ 3, 5]T[ 1, 2]                                           
c$$$      DATA Denom(2  )/            3/                                       
c$$$      DATA (CF(i,2  ),i=1  ,2  ) /    -2,    6/                            
c$$$C               T[ 3, 2]T[ 1, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,9   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,9   ),GG ,TMASS   ,TWIDTH  ,W(1,10  ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,4   ),GWFTS ,AMP(3   ))          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,9   ),GG ,AMP(4   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      JAMP(   2) = +AMP(   3)+AMP(   4)
c$$$      sxs_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          sxs_twmsx =sxs_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2sxs_twmsx(i)=amp2sxs_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2sxs_twmsx(i)=Jamp2sxs_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Sud_twmu(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u d -> t w- u  
c$$$C  
c$$$C Crossing   1 is u d -> t w- u  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 ud_twmu
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ud_twmu(maxamps), jamp2ud_twmu(0:maxamps)
c$$$      common/to_ampsud_twmu/  amp2ud_twmu,       jamp2ud_twmu
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixud_twmu/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2ud_twmu(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2ud_twmu(ihel)=0d0
c$$$              jamp2ud_twmu(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2ud_twmu(0))
c$$$              jamp2ud_twmu(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=ud_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=ud_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2ud_twmu(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2ud_twmu(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION ud_twmu(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u d -> t w- u  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2ud_twmu(maxamps), jamp2ud_twmu(0:maxamps)
c$$$      common/to_ampsud_twmu/  amp2ud_twmu,       jamp2ud_twmu
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 2]T[ 3, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      ud_twmu = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          ud_twmu =ud_twmu+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2ud_twmu(i)=amp2ud_twmu(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2ud_twmu(i)=Jamp2ud_twmu(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Sus_twmu(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u s -> t w- u  
c$$$C  
c$$$C Crossing   1 is u s -> t w- u  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 us_twmu
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2us_twmu(maxamps), jamp2us_twmu(0:maxamps)
c$$$      common/to_ampsus_twmu/  amp2us_twmu,       jamp2us_twmu
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixus_twmu/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2us_twmu(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2us_twmu(ihel)=0d0
c$$$              jamp2us_twmu(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2us_twmu(0))
c$$$              jamp2us_twmu(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=us_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=us_twmu(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2us_twmu(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2us_twmu(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION us_twmu(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u s -> t w- u  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2us_twmu(maxamps), jamp2us_twmu(0:maxamps)
c$$$      common/to_ampsus_twmu/  amp2us_twmu,       jamp2us_twmu
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 5, 2]T[ 3, 1]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL OXXXXX(P(0,5   ),ZERO ,NHEL(5   ),+1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,1   ),W(1,5   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      us_twmu = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          us_twmu =us_twmu+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2us_twmu(i)=amp2us_twmu(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2us_twmu(i)=Jamp2us_twmu(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Suux_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u u~ -> t w- d~  
c$$$C  
c$$$C Crossing   1 is u u~ -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 uux_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uux_twmdx(maxamps), jamp2uux_twmdx(0:maxamps)
c$$$      common/to_ampsuux_twmdx/  amp2uux_twmdx,       jamp2uux_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixuux_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2uux_twmdx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2uux_twmdx(ihel)=0d0
c$$$              jamp2uux_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2uux_twmdx(0))
c$$$              jamp2uux_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=uux_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=uux_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2uux_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2uux_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION uux_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u u~ -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uux_twmdx(maxamps), jamp2uux_twmdx(0:maxamps)
c$$$      common/to_ampsuux_twmdx/  amp2uux_twmdx,       jamp2uux_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 1]T[ 2, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTD ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      uux_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          uux_twmdx =uux_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2uux_twmdx(i)=amp2uux_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2uux_twmdx(i)=Jamp2uux_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Suux_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u u~ -> t w- s~  
c$$$C  
c$$$C Crossing   1 is u u~ -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 uux_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uux_twmsx(maxamps), jamp2uux_twmsx(0:maxamps)
c$$$      common/to_ampsuux_twmsx/  amp2uux_twmsx,       jamp2uux_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixuux_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2uux_twmsx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2uux_twmsx(ihel)=0d0
c$$$              jamp2uux_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2uux_twmsx(0))
c$$$              jamp2uux_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=uux_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=uux_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2uux_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2uux_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION uux_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u u~ -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uux_twmsx(maxamps), jamp2uux_twmsx(0:maxamps)
c$$$      common/to_ampsuux_twmsx/  amp2uux_twmsx,       jamp2uux_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 1]T[ 2, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL IXXXXX(P(0,1   ),ZERO ,NHEL(1   ),+1*IC(1   ),W(1,1   ))        
c$$$      CALL OXXXXX(P(0,2   ),ZERO ,NHEL(2   ),-1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,1   ),W(1,2   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTS ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      uux_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          uux_twmsx =uux_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2uux_twmsx(i)=amp2uux_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2uux_twmsx(i)=Jamp2uux_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$
c$$$       
c$$$       
c$$$      SUBROUTINE Suxd_twmux_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ d -> t w- u~  
c$$$C  
c$$$C Crossing   1 is u~ d -> t w- u~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 uxd_twmux_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxd_twmux_undec(maxamps), jamp2uxd_twmux_undec(0:maxamps)
c$$$      common/to_ampsuxd_twmux_undec/  amp2uxd_twmux_undec,       jamp2uxd_twmux_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixuxd_twmux_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2uxd_twmux_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2uxd_twmux_undec(ihel)=0d0
c$$$              jamp2uxd_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2uxd_twmux_undec(0))
c$$$              jamp2uxd_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=uxd_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=uxd_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2uxd_twmux_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2uxd_twmux_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION uxd_twmux_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ d -> t w- u~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxd_twmux_undec(maxamps), jamp2uxd_twmux_undec(0:maxamps)
c$$$      common/to_ampsuxd_twmux_undec/  amp2uxd_twmux_undec,       jamp2uxd_twmux_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 1, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTD ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      uxd_twmux_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          uxd_twmux_undec =uxd_twmux_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2uxd_twmux_undec(i)=amp2uxd_twmux_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2uxd_twmux_undec(i)=Jamp2uxd_twmux_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Suxs_twmux_undec(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ s -> t w- u~  
c$$$C  
c$$$C Crossing   1 is u~ s -> t w- u~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 uxs_twmux_undec
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxs_twmux_undec(maxamps), jamp2uxs_twmux_undec(0:maxamps)
c$$$      common/to_ampsuxs_twmux_undec/  amp2uxs_twmux_undec,       jamp2uxs_twmux_undec
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixuxs_twmux_undec/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2uxs_twmux_undec(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2uxs_twmux_undec(ihel)=0d0
c$$$              jamp2uxs_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2uxs_twmux_undec(0))
c$$$              jamp2uxs_twmux_undec(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=uxs_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=uxs_twmux_undec(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2uxs_twmux_undec(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2uxs_twmux_undec(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION uxs_twmux_undec(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ s -> t w- u~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxs_twmux_undec(maxamps), jamp2uxs_twmux_undec(0:maxamps)
c$$$      common/to_ampsuxs_twmux_undec/  amp2uxs_twmux_undec,       jamp2uxs_twmux_undec
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 5]T[ 1, 2]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL FVIXXX(W(1,2   ),W(1,4   ),GWFTS ,TMASS   ,TWIDTH  ,W(1,        
c$$$     &     6   ))                                                          
c$$$      CALL JIOXXX(W(1,5   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,6   ),W(1,3   ),W(1,7   ),GG ,AMP(1   ))             
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,2   ),W(1,8   ),W(1,7   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = -AMP(   1)-AMP(   2)
c$$$      uxs_twmux_undec = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          uxs_twmux_undec =uxs_twmux_undec+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2uxs_twmux_undec(i)=amp2uxs_twmux_undec(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2uxs_twmux_undec(i)=Jamp2uxs_twmux_undec(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$       
c$$$       
c$$$      SUBROUTINE Suxu_twmdx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ u -> t w- d~  
c$$$C  
c$$$C Crossing   1 is u~ u -> t w- d~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 uxu_twmdx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxu_twmdx(maxamps), jamp2uxu_twmdx(0:maxamps)
c$$$      common/to_ampsuxu_twmdx/  amp2uxu_twmdx,       jamp2uxu_twmdx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixuxu_twmdx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2uxu_twmdx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2uxu_twmdx(ihel)=0d0
c$$$              jamp2uxu_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2uxu_twmdx(0))
c$$$              jamp2uxu_twmdx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=uxu_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=uxu_twmdx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2uxu_twmdx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2uxu_twmdx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION uxu_twmdx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ u -> t w- d~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxu_twmdx(maxamps), jamp2uxu_twmdx(0:maxamps)
c$$$      common/to_ampsuxu_twmdx/  amp2uxu_twmdx,       jamp2uxu_twmdx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 2]T[ 1, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTD ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTD ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      uxu_twmdx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          uxu_twmdx =uxu_twmdx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2uxu_twmdx(i)=amp2uxu_twmdx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2uxu_twmdx(i)=Jamp2uxu_twmdx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
c$$$      SUBROUTINE Suxu_twmsx(P1,ANS)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C AND HELICITIES
c$$$C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ u -> t w- s~  
c$$$C  
c$$$C Crossing   1 is u~ u -> t w- s~  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      Include "genps_r.inc"
c$$$      INTEGER                 NCOMB,     NCROSS         
c$$$      PARAMETER (             NCOMB=  48, NCROSS=  1)
c$$$      INTEGER    THEL
c$$$      PARAMETER (THEL=NCOMB*NCROSS)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P1(0:3,NEXTERNAL),ANS(NCROSS)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY
c$$$      REAL*8 T, P(0:3,NEXTERNAL)
c$$$      REAL*8 uxu_twmsx
c$$$      INTEGER IHEL,IDEN(NCROSS),IC(NEXTERNAL,NCROSS)
c$$$      INTEGER IPROC,JC(NEXTERNAL), I
c$$$      LOGICAL GOODHEL(NCOMB,NCROSS)
c$$$      INTEGER NGRAPHS
c$$$      REAL*8 hwgt, xtot, xtry, xrej, xr, yfrac(0:ncomb)
c$$$      INTEGER idum, ngood, igood(ncomb), jhel, j, jj
c$$$      LOGICAL warned
c$$$      REAL     xran1
c$$$      EXTERNAL xran1
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxu_twmsx(maxamps), jamp2uxu_twmsx(0:maxamps)
c$$$      common/to_ampsuxu_twmsx/  amp2uxu_twmsx,       jamp2uxu_twmsx
c$$$
c$$$      character*79         hel_buff
c$$$      common/to_helicity/  hel_buff
c$$$
c$$$      REAL*8 POL(2)
c$$$      common/to_polarization/ POL
c$$$
c$$$      integer          isum_hel
c$$$      logical                    multi_channel
c$$$      common/to_matrixuxu_twmsx/isum_hel, multi_channel
c$$$      INTEGER MAPCONFIG(0:LMAXCONFIGS), ICONFIG
c$$$      common/to_mconfigs/mapconfig, iconfig
c$$$      DATA NTRY,IDUM /0,-1/
c$$$      DATA xtry, xrej, ngood /0,0,0/
c$$$      DATA warned, isum_hel/.false.,0/
c$$$      DATA multi_channel/.false./
c$$$      SAVE yfrac, igood, jhel
c$$$      DATA NGRAPHS /    2/          
c$$$      DATA jamp2uxu_twmsx(0) /   1/          
c$$$      DATA GOODHEL/THEL*.FALSE./
c$$$      DATA (NHEL(IHEL,   1),IHEL=1, 5) /-1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,   2),IHEL=1, 5) /-1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,   3),IHEL=1, 5) /-1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,   4),IHEL=1, 5) /-1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,   5),IHEL=1, 5) /-1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,   6),IHEL=1, 5) /-1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,   7),IHEL=1, 5) /-1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,   8),IHEL=1, 5) /-1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,   9),IHEL=1, 5) /-1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  10),IHEL=1, 5) /-1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  11),IHEL=1, 5) /-1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  12),IHEL=1, 5) /-1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  13),IHEL=1, 5) /-1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  14),IHEL=1, 5) /-1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  15),IHEL=1, 5) /-1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  16),IHEL=1, 5) /-1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  17),IHEL=1, 5) /-1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  18),IHEL=1, 5) /-1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  19),IHEL=1, 5) /-1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  20),IHEL=1, 5) /-1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  21),IHEL=1, 5) /-1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  22),IHEL=1, 5) /-1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  23),IHEL=1, 5) /-1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  24),IHEL=1, 5) /-1, 1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  25),IHEL=1, 5) / 1,-1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  26),IHEL=1, 5) / 1,-1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  27),IHEL=1, 5) / 1,-1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  28),IHEL=1, 5) / 1,-1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  29),IHEL=1, 5) / 1,-1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  30),IHEL=1, 5) / 1,-1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  31),IHEL=1, 5) / 1,-1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  32),IHEL=1, 5) / 1,-1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  33),IHEL=1, 5) / 1,-1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  34),IHEL=1, 5) / 1,-1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  35),IHEL=1, 5) / 1,-1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  36),IHEL=1, 5) / 1,-1, 1, 1, 1/
c$$$      DATA (NHEL(IHEL,  37),IHEL=1, 5) / 1, 1,-1,-1,-1/
c$$$      DATA (NHEL(IHEL,  38),IHEL=1, 5) / 1, 1,-1,-1, 1/
c$$$      DATA (NHEL(IHEL,  39),IHEL=1, 5) / 1, 1,-1, 0,-1/
c$$$      DATA (NHEL(IHEL,  40),IHEL=1, 5) / 1, 1,-1, 0, 1/
c$$$      DATA (NHEL(IHEL,  41),IHEL=1, 5) / 1, 1,-1, 1,-1/
c$$$      DATA (NHEL(IHEL,  42),IHEL=1, 5) / 1, 1,-1, 1, 1/
c$$$      DATA (NHEL(IHEL,  43),IHEL=1, 5) / 1, 1, 1,-1,-1/
c$$$      DATA (NHEL(IHEL,  44),IHEL=1, 5) / 1, 1, 1,-1, 1/
c$$$      DATA (NHEL(IHEL,  45),IHEL=1, 5) / 1, 1, 1, 0,-1/
c$$$      DATA (NHEL(IHEL,  46),IHEL=1, 5) / 1, 1, 1, 0, 1/
c$$$      DATA (NHEL(IHEL,  47),IHEL=1, 5) / 1, 1, 1, 1,-1/
c$$$      DATA (NHEL(IHEL,  48),IHEL=1, 5) / 1, 1, 1, 1, 1/
c$$$      DATA (  IC(IHEL,  1),IHEL=1, 5) / 1, 2, 3, 4, 5/
c$$$      DATA (IDEN(IHEL),IHEL=  1,  1) /  36/
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      NTRY=NTRY+1
c$$$      DO IPROC=1,NCROSS
c$$$      CALL SWITCHMOM(P1,P,IC(1,IPROC),JC,NEXTERNAL)
c$$$      DO IHEL=1,NEXTERNAL
c$$$         JC(IHEL) = +1
c$$$      ENDDO
c$$$       
c$$$      IF (multi_channel) THEN
c$$$          DO IHEL=1,NGRAPHS
c$$$              amp2uxu_twmsx(ihel)=0d0
c$$$              jamp2uxu_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$          DO IHEL=1,int(jamp2uxu_twmsx(0))
c$$$              jamp2uxu_twmsx(ihel)=0d0
c$$$          ENDDO
c$$$      ENDIF
c$$$      ANS(IPROC) = 0D0
c$$$      write(hel_buff,'(16i5)') (0,i=1,nexternal)
c$$$      IF (ISUM_HEL .EQ. 0 .OR. NTRY .LT. 10) THEN
c$$$          DO IHEL=1,NCOMB
c$$$             IF (GOODHEL(IHEL,IPROC) .OR. NTRY .LT. 2) THEN
c$$$                 T=uxu_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$               DO JJ=1,nincoming
c$$$                 IF(POL(JJ).NE.1d0.AND.
c$$$     &              NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                   T=T*ABS(POL(JJ))
c$$$                 ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                   T=T*(2d0-ABS(POL(JJ)))
c$$$                 ENDIF
c$$$               ENDDO
c$$$               ANS(IPROC)=ANS(IPROC)+T
c$$$               IF (T .NE. 0D0 .AND. .NOT.    GOODHEL(IHEL,IPROC)) THEN
c$$$                   GOODHEL(IHEL,IPROC)=.TRUE.
c$$$                   NGOOD = NGOOD +1
c$$$                   IGOOD(NGOOD) = IHEL
c$$$               ENDIF
c$$$             ENDIF
c$$$          ENDDO
c$$$          JHEL = 1
c$$$          ISUM_HEL=MIN(ISUM_HEL,NGOOD)
c$$$      ELSE              !RANDOM HELICITY
c$$$          DO J=1,ISUM_HEL
c$$$              JHEL=JHEL+1
c$$$              IF (JHEL .GT. NGOOD) JHEL=1
c$$$              HWGT = REAL(NGOOD)/REAL(ISUM_HEL)
c$$$              IHEL = IGOOD(JHEL)
c$$$              T=uxu_twmsx(P ,NHEL(1,IHEL),JC(1))            
c$$$              DO JJ=1,nincoming
c$$$                IF(POL(JJ).NE.1d0.AND.
c$$$     &             NHEL(JJ,IHEL).EQ.INT(SIGN(1d0,POL(JJ)))) THEN
c$$$                  T=T*ABS(POL(JJ))
c$$$                ELSE IF(POL(JJ).NE.1d0)THEN
c$$$                  T=T*(2d0-ABS(POL(JJ)))
c$$$                ENDIF
c$$$              ENDDO
c$$$              ANS(IPROC)=ANS(IPROC)+T*HWGT
c$$$          ENDDO
c$$$          IF (ISUM_HEL .EQ. 1) THEN
c$$$              WRITE(HEL_BUFF,'(16i5)')(NHEL(i,IHEL),i=1,nexternal)
c$$$          ENDIF
c$$$      ENDIF
c$$$      IF (MULTI_CHANNEL) THEN
c$$$          XTOT=0D0
c$$$          DO IHEL=1,MAPCONFIG(0)
c$$$              XTOT=XTOT+AMP2uxu_twmsx(MAPCONFIG(IHEL))
c$$$          ENDDO
c$$$          IF (XTOT.NE.0D0) THEN
c$$$              ANS(IPROC)=ANS(IPROC)*AMP2uxu_twmsx(MAPCONFIG(ICONFIG))/XTOT
c$$$          ELSE
c$$$              ANS(IPROC)=0D0
c$$$          ENDIF
c$$$      ENDIF
c$$$      ANS(IPROC)=ANS(IPROC)/DBLE(IDEN(IPROC))
c$$$      ENDDO
c$$$      END
c$$$       
c$$$       
c$$$      REAL*8 FUNCTION uxu_twmsx(P,NHEL,IC)
c$$$C  
c$$$C Generated by MadGraph II                                              
c$$$C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
c$$$C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
c$$$C  
c$$$C FOR PROCESS : u~ u -> t w- s~  
c$$$C  
c$$$      IMPLICIT NONE
c$$$C  
c$$$C CONSTANTS
c$$$C  
c$$$      INTEGER    NGRAPHS,    NEIGEN 
c$$$      PARAMETER (NGRAPHS=   2,NEIGEN=  1) 
c$$$      include "genps_r.inc"
c$$$      INTEGER    NWAVEFUNCS     , NCOLOR
c$$$      PARAMETER (NWAVEFUNCS=   8, NCOLOR=   1) 
c$$$      REAL*8     ZERO
c$$$      PARAMETER (ZERO=0D0)
c$$$C  
c$$$C ARGUMENTS 
c$$$C  
c$$$      REAL*8 P(0:3,NEXTERNAL)
c$$$      INTEGER NHEL(NEXTERNAL), IC(NEXTERNAL)
c$$$C  
c$$$C LOCAL VARIABLES 
c$$$C  
c$$$      INTEGER I,J
c$$$      COMPLEX*16 ZTEMP
c$$$      REAL*8 DENOM(NCOLOR), CF(NCOLOR,NCOLOR)
c$$$      COMPLEX*16 AMP(NGRAPHS), JAMP(NCOLOR)
c$$$      COMPLEX*16 W(18,NWAVEFUNCS)
c$$$C  
c$$$C GLOBAL VARIABLES
c$$$C  
c$$$      Double Precision amp2uxu_twmsx(maxamps), jamp2uxu_twmsx(0:maxamps)
c$$$      common/to_ampsuxu_twmsx/  amp2uxu_twmsx,       jamp2uxu_twmsx
c$$$      include "../coupl.inc"
c$$$C  
c$$$C COLOR DATA
c$$$C  
c$$$      DATA Denom(1  )/            1/                                       
c$$$      DATA (CF(i,1  ),i=1  ,1  ) /     2/                                  
c$$$C               T[ 3, 2]T[ 1, 5]                                           
c$$$C ----------
c$$$C BEGIN CODE
c$$$C ----------
c$$$      CALL OXXXXX(P(0,1   ),ZERO ,NHEL(1   ),-1*IC(1   ),W(1,1   ))        
c$$$      CALL IXXXXX(P(0,2   ),ZERO ,NHEL(2   ),+1*IC(2   ),W(1,2   ))        
c$$$      CALL OXXXXX(P(0,3   ),TMASS ,NHEL(3   ),+1*IC(3   ),W(1,3   ))       
c$$$      CALL VXXXXX(P(0,4   ),WMASS ,NHEL(4   ),+1*IC(4   ),W(1,4   ))       
c$$$      CALL IXXXXX(P(0,5   ),ZERO ,NHEL(5   ),-1*IC(5   ),W(1,5   ))        
c$$$      CALL JIOXXX(W(1,2   ),W(1,1   ),GG ,ZERO    ,ZERO    ,W(1,6   ))     
c$$$      CALL FVOXXX(W(1,3   ),W(1,6   ),GG ,TMASS   ,TWIDTH  ,W(1,7   ))     
c$$$      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,4   ),GWFTS ,AMP(1   ))          
c$$$      CALL FVOXXX(W(1,3   ),W(1,4   ),GWFTS ,ZERO    ,ZERO    ,W(1,        
c$$$     &     8   ))                                                          
c$$$      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GG ,AMP(2   ))             
c$$$      JAMP(   1) = +AMP(   1)+AMP(   2)
c$$$      uxu_twmsx = 0.D0 
c$$$      DO I = 1, NCOLOR
c$$$          ZTEMP = (0.D0,0.D0)
c$$$          DO J = 1, NCOLOR
c$$$              ZTEMP = ZTEMP + CF(J,I)*JAMP(J)
c$$$          ENDDO
c$$$          uxu_twmsx =uxu_twmsx+ZTEMP*DCONJG(JAMP(I))/DENOM(I)   
c$$$      ENDDO
c$$$      Do I = 1, NGRAPHS
c$$$          amp2uxu_twmsx(i)=amp2uxu_twmsx(i)+amp(i)*dconjg(amp(i))
c$$$      Enddo
c$$$      Do I = 1, NCOLOR
c$$$          Jamp2uxu_twmsx(i)=Jamp2uxu_twmsx(i)+Jamp(i)*dconjg(Jamp(i))
c$$$      Enddo
c$$$C      CALL GAUGECHECK(JAMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NCOLOR,NEIGEN) 
c$$$      END
c$$$       
c$$$       
