module matrix_routines
  use types; use consts_dp; use warnings_and_errors
  implicit none
  
  private
  
 interface mydet 
    module procedure mydetc
 end interface

! interface mydets 
!    module procedure mydetcs
! end interface

 interface complement 
    module procedure complementc
 end interface


  public :: determinant_old, mydet
!  public :: determinant, determinant_old, mydet,mydets,mydetcomp 

contains

  
!  ! assumes symmetric matrix 
!  recursive function mydetcomp(A) result (det)
!    use types; use consts_dp
!    complex(dp), intent(in) :: A(:,:)
!    complex(dp) :: det
!    ! dummy variables
!    integer     :: m,n,i
!    
!    n = size(A,dim=1) 
!    m = size(A,dim=2) 
!    if (n/=m) call wae_error('mydetcomp','Not squared matrix')
!
!    det = zero 
!    if (n==1) then 
!       det = A(1,1)
!    elseif (n == 2) then 
!       det = A(1,1)*A(2,2)-A(1,2)**2
!    else
!       do i=1,n
!          if (A(1,i) /= zero) then 
!             det = det + (-1)**(i+1)*A(1,i)*mydetc(Complement(A,1,i))
!          end if
!       end do
!    end if
!
!  end function mydetcomp
!
!  ! assumes symmetric matrix 
!  recursive function mydetcs(A) result (det)
!    use types; use consts_dp
!    complex(dp), intent(in) :: A(:,:)
!    complex(dp) :: det
!    ! dummy variables
!    integer     :: m,n,i
!
!    n = size(A,dim=1) 
!    m = size(A,dim=2) 
!    if (n/=m) call wae_error('mydet','Not squared matrix')
!
!    det = zero 
!    if (n==1) then 
!       det = A(1,1)
!    elseif (n == 2) then 
!       det = A(1,1)*A(2,2)-A(1,2)**2
!    elseif (n == 3) then 
!       det  = -(A(1, 3)**2*A(2, 2)) + 2*A(1, 2)*A(1, 3)*A(2, 3) &
!     &  - A(1, 2)**2*A(3, 3) +  A(1, 1)*(-A(2, 3)**2 + A(2, 2)*A(3, 3))
!    elseif (n == 4) then 
!       !do i=1,4
!       !   write(*,*) 'mydetS',i,A(:,i)
!       !end do
!
!       det = -(A(1,1)*A(2,4)**2*A(3,3)) + A(1,4)**2*(A(2,3)**2 - A(2,2)*A(3,3)) +&
!            & 2*A(1,1)*A(2,3)*A(2,4)*A(3,4) + A(1,2)**2*A(3,4)**2 -                   &
!            & A(1,1)*A(2,2)*A(3,4)**2 -                                                 &
!            & 2*A(1,4)*(A(1,3)*(A(2,3)*A(2,4) - A(2,2)*A(3,4)) +                    &
!            &   A(1,2)*(-(A(2,4)*A(3,3)) + A(2,3)*A(3,4))) -                         &
!            & A(1,1)*A(2,3)**2*A(4,4) - A(1,2)**2*A(3,3)*A(4,4) +                     &
!            & A(1,1)*A(2,2)*A(3,3)*A(4,4) + A(1,3)**2*(A(2,4)**2 - A(2,2)*A(4,4)) + &
!            & 2*A(1,2)*A(1,3)*(-(A(2,4)*A(3,4)) + A(2,3)*A(4,4))
!    elseif (n == 5) then 
!       det = & 
!            &A(1,1)*A(2,5)**2*A(3,4)**2 - 2*A(1,1)*A(2,4)*A(2,5)*A(3,4)*A(3,5) +      &
!            & A(1,1)*A(2,4)**2*A(3,5)**2 + A(1,3)**2*A(2,5)**2*A(4,4) -                   &
!            & A(1,1)*A(2,5)**2*A(3,3)*A(4,4) - 2*A(1,2)*A(1,3)*A(2,5)*A(3,5)*        &
!            &  A(4,4) + 2*A(1,1)*A(2,3)*A(2,5)*A(3,5)*A(4,4) +                        &
!            & A(1,2)**2*A(3,5)**2*A(4,4) - A(1,1)*A(2,2)*A(3,5)**2*A(4,4) +             &
!            & A(1,5)**2*(A(2,4)**2*A(3,3) - 2*A(2,3)*A(2,4)*A(3,4) +                    &
!            &   A(2,3)**2*A(4,4) + A(2,2)*(A(3,4)**2 - A(3,3)*A(4,4))) -                &
!            & 2*A(1,3)**2*A(2,4)*A(2,5)*A(4,5) + 2*A(1,1)*A(2,4)*A(2,5)*A(3,3)*      &
!            &  A(4,5) + 2*A(1,2)*A(1,3)*A(2,5)*A(3,4)*A(4,5) -                        &
!            & 2*A(1,1)*A(2,3)*A(2,5)*A(3,4)*A(4,5) + 2*A(1,2)*A(1,3)*A(2,4)*        &
!            &  A(3,5)*A(4,5) - 2*A(1,1)*A(2,3)*A(2,4)*A(3,5)*A(4,5) -                &
!            & 2*A(1,2)**2*A(3,4)*A(3,5)*A(4,5) + 2*A(1,1)*A(2,2)*A(3,4)*A(3,5)*      &
!            &  A(4,5) + A(1,3)**2*A(2,2)*A(4,5)**2 - 2*A(1,2)*A(1,3)*A(2,3)*           &
!            &  A(4,5)**2 + A(1,1)*A(2,3)**2*A(4,5)**2 + A(1,2)**2*A(3,3)*A(4,5)**2 -      &
!            & A(1,1)*A(2,2)*A(3,3)*A(4,5)**2 -                                           &
!            & 2*A(1,5)*(A(1,4)*(-(A(2,3)*A(2,5)*A(3,4)) +                              &
!            &     A(2,4)*(A(2,5)*A(3,3) - A(2,3)*A(3,5)) + A(2,3)**2*A(4,5) +         &
!            &     A(2,2)*(A(3,4)*A(3,5) - A(3,3)*A(4,5))) +                            &
!            &   A(1,2)*(A(2,5)*(A(3,4)**2 - A(3,3)*A(4,4)) +                            &
!            &     A(2,4)*(-(A(3,4)*A(3,5)) + A(3,3)*A(4,5)) +                          &
!            &     A(2,3)*(A(3,5)*A(4,4) - A(3,4)*A(4,5))) +                            &
!            &   A(1,3)*(A(2,4)**2*A(3,5) + A(2,3)*A(2,5)*A(4,4) -                      &
!            &     A(2,4)*(A(2,5)*A(3,4) + A(2,3)*A(4,5)) +                             &
!            &     A(2,2)*(-(A(3,5)*A(4,4)) + A(3,4)*A(4,5)))) +                        &
!            & A(1,3)**2*A(2,4)**2*A(5,5) - A(1,1)*A(2,4)**2*A(3,3)*A(5,5) -             &
!            & 2*A(1,2)*A(1,3)*A(2,4)*A(3,4)*A(5,5) + 2*A(1,1)*A(2,3)*A(2,4)*        &
!            &  A(3,4)*A(5,5) + A(1,2)**2*A(3,4)**2*A(5,5) -                              &
!            & A(1,1)*A(2,2)*A(3,4)**2*A(5,5) - A(1,3)**2*A(2,2)*A(4,4)*A(5,5) +       &
!            & 2*A(1,2)*A(1,3)*A(2,3)*A(4,4)*A(5,5) - A(1,1)*A(2,3)**2*A(4,4)*        &
!            &  A(5,5) - A(1,2)**2*A(3,3)*A(4,4)*A(5,5) +                                &
!            & A(1,1)*A(2,2)*A(3,3)*A(4,4)*A(5,5) +                                     &
!            & A(1,4)**2*(A(2,5)**2*A(3,3) - 2*A(2,3)*A(2,5)*A(3,5) +                    &
!            &   A(2,3)**2*A(5,5) + A(2,2)*(A(3,5)**2 - A(3,3)*A(5,5))) -                &
!            & 2*A(1,4)*(A(1,3)*(A(2,5)**2*A(3,4) -                                       &
!            &     A(2,5)*(A(2,4)*A(3,5) + A(2,3)*A(4,5)) + A(2,3)*A(2,4)*A(5,5) +   &
!            &     A(2,2)*(A(3,5)*A(4,5) - A(3,4)*A(5,5))) +                            &
!            &   A(1,2)*(A(2,5)*(-(A(3,4)*A(3,5)) + A(3,3)*A(4,5)) +                   &
!            &     A(2,4)*(A(3,5)**2 - A(3,3)*A(5,5)) +                                   &
!&     A(2,3)*(-(A(3,5)*A(4,5)) + A(3,4)*A(5,5))))
!    else
!       do i=1,n
!          if (A(1,i) /= zero) then 
!             det = det + (-1)**(i+1)*A(1,i)*mydetc(Complement(A,1,i))
!          end if
!       end do
!    end if
!    !if (n ==6) write(*,*) 'in mydetcc:',n,det 
!
!  end function mydetcs
!


  recursive function mydetc(A) result (det)
    use types; use consts_dp
    complex(dp),intent(in) :: A(:,:)
    complex(dp) :: det
    ! dummy variables
    integer     :: m,n,i
    complex(dp) ::  r11,r12,r13,r14,r15,r21,r22,r23,r24,r25
    complex(dp) ::  r31,r32,r33,r34,r35,r41,r42,r43,r44,r45
    complex(dp) ::  r51,r52,r53,r54,r55
    complex(dp) ::  r16,r26,r36,r46,r56 
    complex(dp) ::  r61,r62,r63,r64,r65,r66


    n = size(A,dim=1) 
    m = size(A,dim=2) 
    !write(*,*) 'in mydecc', n 
    if (n/=m) call wae_error('mydet','Not squared matrix')
    det = zero 
    if (n==1) then 
       det = A(1,1)
    elseif (n == 2) then 
       det = A(1,1)*A(2,2)-A(1,2)*A(2,1)
    elseif (n == 3) then 
       det  =A(1,1)*A(2,2)*A(3,3)+A(1,2)*A(2,3)*A(3,1)+&
            &A(1,3)*A(2,1)*A(3,2)-A(1,3)*A(2,2)*A(3,1)-&
            &A(1,2)*A(2,1)*A(3,3)-A(1,1)*A(2,3)*A(3,2)
    elseif (n == 4) then 
       !do i=1,4
       !   write(*,*) 'mydet',i,A(:,i)
       !end do
       det = &
            &      A(1,4)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,4)*A(3,2)*A(4,1) - &
            &      A(1,4)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,4)*A(3,3)*A(4,1) + &
            &      A(1,3)*A(2,2)*A(3,4)*A(4,1) - A(1,2)*A(2,3)*A(3,4)*A(4,1) - & 
            &      A(1,4)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,4)*A(3,1)*A(4,2) + &
            &      A(1,4)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,4)*A(3,3)*A(4,2) - &
            &      A(1,3)*A(2,1)*A(3,4)*A(4,2) + A(1,1)*A(2,3)*A(3,4)*A(4,2) + &
            &      A(1,4)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,4)*A(3,1)*A(4,3) - &
            &      A(1,4)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,4)*A(3,2)*A(4,3) + &
            &      A(1,2)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,2)*A(3,4)*A(4,3) - &
            &      A(1,3)*A(2,2)*A(3,1)*A(4,4) + A(1,2)*A(2,3)*A(3,1)*A(4,4) + &
            &      A(1,3)*A(2,1)*A(3,2)*A(4,4) - A(1,1)*A(2,3)*A(3,2)*A(4,4) - &
            &      A(1,2)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,2)*A(3,3)*A(4,4)      

    elseif (n == 5) then 
       r11=A(1,1);r12=A(1,2);r13=A(1,3);r14=A(1,4);r15=A(1,5)
       r21=A(2,1);r22=A(2,2);r23=A(2,3);r24=A(2,4);r25=A(2,5)
       r31=A(3,1);r32=A(3,2);r33=A(3,3);r34=A(3,4);r35=A(3,5)
       r41=A(4,1);r42=A(4,2);r43=A(4,3);r44=A(4,4);r45=A(4,5)
       r51=A(5,1);r52=A(5,2);r53=A(5,3);r54=A(5,4);r55=A(5,5)

       det = &
            &      r15*r24*r33*r42*r51 - r14*r25*r33*r42*r51 - &
            &      r15*r23*r34*r42*r51 + r13*r25*r34*r42*r51 + &
            &      r14*r23*r35*r42*r51 - r13*r24*r35*r42*r51 - &
            &      r15*r24*r32*r43*r51 + r14*r25*r32*r43*r51 + &
            &      r15*r22*r34*r43*r51 - r12*r25*r34*r43*r51 - &
            &      r14*r22*r35*r43*r51 + r12*r24*r35*r43*r51 + &
            &      r15*r23*r32*r44*r51 - r13*r25*r32*r44*r51 - &
            &      r15*r22*r33*r44*r51 + r12*r25*r33*r44*r51 + &
            &      r13*r22*r35*r44*r51 - r12*r23*r35*r44*r51 - &
            &      r14*r23*r32*r45*r51 + r13*r24*r32*r45*r51 + &
            &      r14*r22*r33*r45*r51 - r12*r24*r33*r45*r51 - &
            &      r13*r22*r34*r45*r51 + r12*r23*r34*r45*r51 - &
            &      r15*r24*r33*r41*r52 + r14*r25*r33*r41*r52 + &
            &      r15*r23*r34*r41*r52 - r13*r25*r34*r41*r52 - &
            &      r14*r23*r35*r41*r52 + r13*r24*r35*r41*r52 + &
            &      r15*r24*r31*r43*r52 - r14*r25*r31*r43*r52 - &
            &      r15*r21*r34*r43*r52 + r11*r25*r34*r43*r52 + &
            &      r14*r21*r35*r43*r52 - r11*r24*r35*r43*r52 - &
            &      r15*r23*r31*r44*r52 + r13*r25*r31*r44*r52 + &
            &      r15*r21*r33*r44*r52 - r11*r25*r33*r44*r52 - &
            &      r13*r21*r35*r44*r52 + r11*r23*r35*r44*r52 + &
            &      r14*r23*r31*r45*r52 - r13*r24*r31*r45*r52 - &
            &      r14*r21*r33*r45*r52 + r11*r24*r33*r45*r52 + &
            &      r13*r21*r34*r45*r52 - r11*r23*r34*r45*r52 + &
            &      r15*r24*r32*r41*r53 - r14*r25*r32*r41*r53 - &
            &      r15*r22*r34*r41*r53 + r12*r25*r34*r41*r53 + &
            &      r14*r22*r35*r41*r53 - r12*r24*r35*r41*r53 - &
            &      r15*r24*r31*r42*r53 + r14*r25*r31*r42*r53 + &
            &      r15*r21*r34*r42*r53 - r11*r25*r34*r42*r53 - &
            &      r14*r21*r35*r42*r53 + r11*r24*r35*r42*r53 + &
            &      r15*r22*r31*r44*r53 - r12*r25*r31*r44*r53 - &
            &      r15*r21*r32*r44*r53 + r11*r25*r32*r44*r53 + &
            &      r12*r21*r35*r44*r53 - r11*r22*r35*r44*r53 - &
            &      r14*r22*r31*r45*r53 + r12*r24*r31*r45*r53 + &
            &      r14*r21*r32*r45*r53 - r11*r24*r32*r45*r53 - &
            &      r12*r21*r34*r45*r53 + r11*r22*r34*r45*r53 - &
            &      r15*r23*r32*r41*r54 + r13*r25*r32*r41*r54 + &
            &      r15*r22*r33*r41*r54 - r12*r25*r33*r41*r54 - &
            &      r13*r22*r35*r41*r54 + r12*r23*r35*r41*r54 + &
            &      r15*r23*r31*r42*r54 - r13*r25*r31*r42*r54 - &
            &      r15*r21*r33*r42*r54 + r11*r25*r33*r42*r54 + &
            &      r13*r21*r35*r42*r54 - r11*r23*r35*r42*r54 - &
            &      r15*r22*r31*r43*r54 + r12*r25*r31*r43*r54 + &
            &      r15*r21*r32*r43*r54 - r11*r25*r32*r43*r54 - &
            &      r12*r21*r35*r43*r54 + r11*r22*r35*r43*r54 + &
            &      r13*r22*r31*r45*r54 - r12*r23*r31*r45*r54 - &
            &      r13*r21*r32*r45*r54 + r11*r23*r32*r45*r54 + &
            &      r12*r21*r33*r45*r54 - r11*r22*r33*r45*r54 + &
            &      r14*r23*r32*r41*r55 - r13*r24*r32*r41*r55 - &
            &      r14*r22*r33*r41*r55 + r12*r24*r33*r41*r55 + &
            &      r13*r22*r34*r41*r55 - r12*r23*r34*r41*r55 - &
            &      r14*r23*r31*r42*r55 + r13*r24*r31*r42*r55 + &
            &      r14*r21*r33*r42*r55 - r11*r24*r33*r42*r55 - &
            &      r13*r21*r34*r42*r55 + r11*r23*r34*r42*r55 + &
            &      r14*r22*r31*r43*r55 - r12*r24*r31*r43*r55 - &
            &      r14*r21*r32*r43*r55 + r11*r24*r32*r43*r55 + &
            &      r12*r21*r34*r43*r55 - r11*r22*r34*r43*r55 - &
            &      r13*r22*r31*r44*r55 + r12*r23*r31*r44*r55 + &
            &      r13*r21*r32*r44*r55 - r11*r23*r32*r44*r55 - &
            &      r12*r21*r33*r44*r55 + r11*r22*r33*r44*r55
!    elseif (n == 6) then 
!       det = & 
!            &        -(((A(1,6)*A(2,5)*A(3,4)*A(4,3) - A(1,5)*A(2,6)*A(3,4)*A(4,3) -   &   
!            &      A(1,6)*A(2,4)*A(3,5)*A(4,3) + A(1,4)*A(2,6)*A(3,5)*A(4,3) +         &
!            &      A(1,5)*A(2,4)*A(3,6)*A(4,3) - A(1,4)*A(2,5)*A(3,6)*A(4,3) -         &
!            &      A(1,6)*A(2,5)*A(3,3)*A(4,4) + A(1,5)*A(2,6)*A(3,3)*A(4,4) +         &
!            &      A(1,6)*A(2,3)*A(3,5)*A(4,4) - A(1,3)*A(2,6)*A(3,5)*A(4,4) -         &
!            &      A(1,5)*A(2,3)*A(3,6)*A(4,4) + A(1,3)*A(2,5)*A(3,6)*A(4,4) +         &
!            &      A(1,6)*A(2,4)*A(3,3)*A(4,5) - A(1,4)*A(2,6)*A(3,3)*A(4,5) -         &
!            &      A(1,6)*A(2,3)*A(3,4)*A(4,5) + A(1,3)*A(2,6)*A(3,4)*A(4,5) +         &
!            &      A(1,4)*A(2,3)*A(3,6)*A(4,5) - A(1,3)*A(2,4)*A(3,6)*A(4,5) -         &
!            &      A(1,5)*A(2,4)*A(3,3)*A(4,6) + A(1,4)*A(2,5)*A(3,3)*A(4,6) +         &
!            &      A(1,5)*A(2,3)*A(3,4)*A(4,6) - A(1,3)*A(2,5)*A(3,4)*A(4,6) -         &
!            &      A(1,4)*A(2,3)*A(3,5)*A(4,6) + A(1,3)*A(2,4)*A(3,5)*A(4,6))*         &
!            &     A(5,2) - (A(1,6)*A(2,5)*A(3,4)*A(4,2) - A(1,5)*A(2,6)*A(3,4)*        &
!            &       A(4,2) - A(1,6)*A(2,4)*A(3,5)*A(4,2) + A(1,4)*A(2,6)*A(3,5)*       &
!            &       A(4,2) + A(1,5)*A(2,4)*A(3,6)*A(4,2) - A(1,4)*A(2,5)*A(3,6)*       &
!            &       A(4,2) - A(1,6)*A(2,5)*A(3,2)*A(4,4) + A(1,5)*A(2,6)*A(3,2)*       &
!            &       A(4,4) + A(1,6)*A(2,2)*A(3,5)*A(4,4) - A(1,2)*A(2,6)*A(3,5)*       &
!            &       A(4,4) - A(1,5)*A(2,2)*A(3,6)*A(4,4) + A(1,2)*A(2,5)*A(3,6)*       &
!            &       A(4,4) + A(1,6)*A(2,4)*A(3,2)*A(4,5) - A(1,4)*A(2,6)*A(3,2)*       &
!            &       A(4,5) - A(1,6)*A(2,2)*A(3,4)*A(4,5) + A(1,2)*A(2,6)*A(3,4)*       &
!            &       A(4,5) + A(1,4)*A(2,2)*A(3,6)*A(4,5) - A(1,2)*A(2,4)*A(3,6)*       &
!            &       A(4,5) - A(1,5)*A(2,4)*A(3,2)*A(4,6) + A(1,4)*A(2,5)*A(3,2)*       &
!            &       A(4,6) + A(1,5)*A(2,2)*A(3,4)*A(4,6) - A(1,2)*A(2,5)*A(3,4)*       &
!            &       A(4,6) - A(1,4)*A(2,2)*A(3,5)*A(4,6) + A(1,2)*A(2,4)*A(3,5)*       &
!            &       A(4,6))*A(5,3) + (A(1,6)*A(2,5)*A(3,3)*A(4,2) -                      &
!            &      A(1,5)*A(2,6)*A(3,3)*A(4,2) - A(1,6)*A(2,3)*A(3,5)*A(4,2) +         &
!            &      A(1,3)*A(2,6)*A(3,5)*A(4,2) + A(1,5)*A(2,3)*A(3,6)*A(4,2) -         &
!            &      A(1,3)*A(2,5)*A(3,6)*A(4,2) - A(1,6)*A(2,5)*A(3,2)*A(4,3) +         &
!            &      A(1,5)*A(2,6)*A(3,2)*A(4,3) + A(1,6)*A(2,2)*A(3,5)*A(4,3) -         &
!            &      A(1,2)*A(2,6)*A(3,5)*A(4,3) - A(1,5)*A(2,2)*A(3,6)*A(4,3) +         &
!            &      A(1,2)*A(2,5)*A(3,6)*A(4,3) + A(1,6)*A(2,3)*A(3,2)*A(4,5) -         &
!            &      A(1,3)*A(2,6)*A(3,2)*A(4,5) - A(1,6)*A(2,2)*A(3,3)*A(4,5) +         &
!            &      A(1,2)*A(2,6)*A(3,3)*A(4,5) + A(1,3)*A(2,2)*A(3,6)*A(4,5) -         &
!            &      A(1,2)*A(2,3)*A(3,6)*A(4,5) - A(1,5)*A(2,3)*A(3,2)*A(4,6) +         &
!            &      A(1,3)*A(2,5)*A(3,2)*A(4,6) + A(1,5)*A(2,2)*A(3,3)*A(4,6) -         &
!            &      A(1,2)*A(2,5)*A(3,3)*A(4,6) - A(1,3)*A(2,2)*A(3,5)*A(4,6) +         &
!            &      A(1,2)*A(2,3)*A(3,5)*A(4,6))*A(5,4) -                                  &
!            &    (A(1,6)*A(2,4)*A(3,3)*A(4,2) - A(1,4)*A(2,6)*A(3,3)*A(4,2) -          &
!            &      A(1,6)*A(2,3)*A(3,4)*A(4,2) + A(1,3)*A(2,6)*A(3,4)*A(4,2) +         &
!            &      A(1,4)*A(2,3)*A(3,6)*A(4,2) - A(1,3)*A(2,4)*A(3,6)*A(4,2) -         &
!            &      A(1,6)*A(2,4)*A(3,2)*A(4,3) + A(1,4)*A(2,6)*A(3,2)*A(4,3) +         &
!            &      A(1,6)*A(2,2)*A(3,4)*A(4,3) - A(1,2)*A(2,6)*A(3,4)*A(4,3) -         &
!            &      A(1,4)*A(2,2)*A(3,6)*A(4,3) + A(1,2)*A(2,4)*A(3,6)*A(4,3) +         &
!            &      A(1,6)*A(2,3)*A(3,2)*A(4,4) - A(1,3)*A(2,6)*A(3,2)*A(4,4) -         &
!            &      A(1,6)*A(2,2)*A(3,3)*A(4,4) + A(1,2)*A(2,6)*A(3,3)*A(4,4) +         &
!            &      A(1,3)*A(2,2)*A(3,6)*A(4,4) - A(1,2)*A(2,3)*A(3,6)*A(4,4) -         &
!            &      A(1,4)*A(2,3)*A(3,2)*A(4,6) + A(1,3)*A(2,4)*A(3,2)*A(4,6) +         &
!            &      A(1,4)*A(2,2)*A(3,3)*A(4,6) - A(1,2)*A(2,4)*A(3,3)*A(4,6) -         &
!            &      A(1,3)*A(2,2)*A(3,4)*A(4,6) + A(1,2)*A(2,3)*A(3,4)*A(4,6))*         &
!            &     A(5,5) + (A(1,5)*A(2,4)*A(3,3)*A(4,2) - A(1,4)*A(2,5)*A(3,3)*        &
!            &       A(4,2) - A(1,5)*A(2,3)*A(3,4)*A(4,2) + A(1,3)*A(2,5)*A(3,4)*       &
!            &       A(4,2) + A(1,4)*A(2,3)*A(3,5)*A(4,2) - A(1,3)*A(2,4)*A(3,5)*       &
!            &       A(4,2) - A(1,5)*A(2,4)*A(3,2)*A(4,3) + A(1,4)*A(2,5)*A(3,2)*       &
!            &       A(4,3) + A(1,5)*A(2,2)*A(3,4)*A(4,3) - A(1,2)*A(2,5)*A(3,4)*       &
!            &       A(4,3) - A(1,4)*A(2,2)*A(3,5)*A(4,3) + A(1,2)*A(2,4)*A(3,5)*       &
!            &       A(4,3) + A(1,5)*A(2,3)*A(3,2)*A(4,4) - A(1,3)*A(2,5)*A(3,2)*       &
!            &       A(4,4) - A(1,5)*A(2,2)*A(3,3)*A(4,4) + A(1,2)*A(2,5)*A(3,3)*       &
!            &       A(4,4) + A(1,3)*A(2,2)*A(3,5)*A(4,4) - A(1,2)*A(2,3)*A(3,5)*       &
!            &       A(4,4) - A(1,4)*A(2,3)*A(3,2)*A(4,5) + A(1,3)*A(2,4)*A(3,2)*       &
!            &       A(4,5) + A(1,4)*A(2,2)*A(3,3)*A(4,5) - A(1,2)*A(2,4)*A(3,3)*       &
!            &       A(4,5) - A(1,3)*A(2,2)*A(3,4)*A(4,5) + A(1,2)*A(2,3)*A(3,4)*       &
!            &       A(4,5))*A(5,6))*A(6,1)) +                                               &
!            & ((A(1,6)*A(2,5)*A(3,4)*A(4,3) - A(1,5)*A(2,6)*A(3,4)*A(4,3) -            &
!            &     A(1,6)*A(2,4)*A(3,5)*A(4,3) + A(1,4)*A(2,6)*A(3,5)*A(4,3) +          &
!            &     A(1,5)*A(2,4)*A(3,6)*A(4,3) - A(1,4)*A(2,5)*A(3,6)*A(4,3) -          &
!            &     A(1,6)*A(2,5)*A(3,3)*A(4,4) + A(1,5)*A(2,6)*A(3,3)*A(4,4) +          &
!            &     A(1,6)*A(2,3)*A(3,5)*A(4,4) - A(1,3)*A(2,6)*A(3,5)*A(4,4) -          &
!            &     A(1,5)*A(2,3)*A(3,6)*A(4,4) + A(1,3)*A(2,5)*A(3,6)*A(4,4) +          &
!            &     A(1,6)*A(2,4)*A(3,3)*A(4,5) - A(1,4)*A(2,6)*A(3,3)*A(4,5) -          &
!            &     A(1,6)*A(2,3)*A(3,4)*A(4,5) + A(1,3)*A(2,6)*A(3,4)*A(4,5) +          &
!            &     A(1,4)*A(2,3)*A(3,6)*A(4,5) - A(1,3)*A(2,4)*A(3,6)*A(4,5) -          &
!            &     A(1,5)*A(2,4)*A(3,3)*A(4,6) + A(1,4)*A(2,5)*A(3,3)*A(4,6) +          &
!            &     A(1,5)*A(2,3)*A(3,4)*A(4,6) - A(1,3)*A(2,5)*A(3,4)*A(4,6) -          &
!            &     A(1,4)*A(2,3)*A(3,5)*A(4,6) + A(1,3)*A(2,4)*A(3,5)*A(4,6))*          &
!            &    A(5,1) - (A(1,6)*A(2,5)*A(3,4)*A(4,1) - A(1,5)*A(2,6)*A(3,4)*         &
!            &      A(4,1) - A(1,6)*A(2,4)*A(3,5)*A(4,1) + A(1,4)*A(2,6)*A(3,5)*        &
!            &      A(4,1) + A(1,5)*A(2,4)*A(3,6)*A(4,1) - A(1,4)*A(2,5)*A(3,6)*        &
!            &      A(4,1) - A(1,6)*A(2,5)*A(3,1)*A(4,4) + A(1,5)*A(2,6)*A(3,1)*        &
!            &      A(4,4) + A(1,6)*A(2,1)*A(3,5)*A(4,4) - A(1,1)*A(2,6)*A(3,5)*        &
!            &      A(4,4) - A(1,5)*A(2,1)*A(3,6)*A(4,4) + A(1,1)*A(2,5)*A(3,6)*        &
!            &      A(4,4) + A(1,6)*A(2,4)*A(3,1)*A(4,5) - A(1,4)*A(2,6)*A(3,1)*        &
!            &      A(4,5) - A(1,6)*A(2,1)*A(3,4)*A(4,5) + A(1,1)*A(2,6)*A(3,4)*        &
!            &      A(4,5) + A(1,4)*A(2,1)*A(3,6)*A(4,5) - A(1,1)*A(2,4)*A(3,6)*        &
!            &      A(4,5) - A(1,5)*A(2,4)*A(3,1)*A(4,6) + A(1,4)*A(2,5)*A(3,1)*        &
!            &      A(4,6) + A(1,5)*A(2,1)*A(3,4)*A(4,6) - A(1,1)*A(2,5)*A(3,4)*        &
!            &      A(4,6) - A(1,4)*A(2,1)*A(3,5)*A(4,6) + A(1,1)*A(2,4)*A(3,5)*        &
!            &      A(4,6))*A(5,3) + (A(1,6)*A(2,5)*A(3,3)*A(4,1) -                       &
!            &     A(1,5)*A(2,6)*A(3,3)*A(4,1) - A(1,6)*A(2,3)*A(3,5)*A(4,1) +          &
!            &     A(1,3)*A(2,6)*A(3,5)*A(4,1) + A(1,5)*A(2,3)*A(3,6)*A(4,1) -          &
!            &     A(1,3)*A(2,5)*A(3,6)*A(4,1) - A(1,6)*A(2,5)*A(3,1)*A(4,3) +          &
!            &     A(1,5)*A(2,6)*A(3,1)*A(4,3) + A(1,6)*A(2,1)*A(3,5)*A(4,3) -          &
!            &     A(1,1)*A(2,6)*A(3,5)*A(4,3) - A(1,5)*A(2,1)*A(3,6)*A(4,3) +          &
!            &     A(1,1)*A(2,5)*A(3,6)*A(4,3) + A(1,6)*A(2,3)*A(3,1)*A(4,5) -          &
!            &     A(1,3)*A(2,6)*A(3,1)*A(4,5) - A(1,6)*A(2,1)*A(3,3)*A(4,5) +          &
!            &     A(1,1)*A(2,6)*A(3,3)*A(4,5) + A(1,3)*A(2,1)*A(3,6)*A(4,5) -          &
!            &     A(1,1)*A(2,3)*A(3,6)*A(4,5) - A(1,5)*A(2,3)*A(3,1)*A(4,6) +          &
!            &     A(1,3)*A(2,5)*A(3,1)*A(4,6) + A(1,5)*A(2,1)*A(3,3)*A(4,6) -          &
!            &     A(1,1)*A(2,5)*A(3,3)*A(4,6) - A(1,3)*A(2,1)*A(3,5)*A(4,6) +          &
!            &     A(1,1)*A(2,3)*A(3,5)*A(4,6))*A(5,4) -                                   &
!            &   (A(1,6)*A(2,4)*A(3,3)*A(4,1) - A(1,4)*A(2,6)*A(3,3)*A(4,1) -           &
!            &     A(1,6)*A(2,3)*A(3,4)*A(4,1) + A(1,3)*A(2,6)*A(3,4)*A(4,1) +          &
!            &     A(1,4)*A(2,3)*A(3,6)*A(4,1) - A(1,3)*A(2,4)*A(3,6)*A(4,1) -          &
!            &     A(1,6)*A(2,4)*A(3,1)*A(4,3) + A(1,4)*A(2,6)*A(3,1)*A(4,3) +          &
!            &     A(1,6)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,6)*A(3,4)*A(4,3) -          &
!            &     A(1,4)*A(2,1)*A(3,6)*A(4,3) + A(1,1)*A(2,4)*A(3,6)*A(4,3) +          &
!            &     A(1,6)*A(2,3)*A(3,1)*A(4,4) - A(1,3)*A(2,6)*A(3,1)*A(4,4) -          &
!            &     A(1,6)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,6)*A(3,3)*A(4,4) +          &
!            &     A(1,3)*A(2,1)*A(3,6)*A(4,4) - A(1,1)*A(2,3)*A(3,6)*A(4,4) -          &
!            &     A(1,4)*A(2,3)*A(3,1)*A(4,6) + A(1,3)*A(2,4)*A(3,1)*A(4,6) +          &
!            &     A(1,4)*A(2,1)*A(3,3)*A(4,6) - A(1,1)*A(2,4)*A(3,3)*A(4,6) -          &
!            &     A(1,3)*A(2,1)*A(3,4)*A(4,6) + A(1,1)*A(2,3)*A(3,4)*A(4,6))*          &
!            &    A(5,5) + (A(1,5)*A(2,4)*A(3,3)*A(4,1) - A(1,4)*A(2,5)*A(3,3)*         &
!            &      A(4,1) - A(1,5)*A(2,3)*A(3,4)*A(4,1) + A(1,3)*A(2,5)*A(3,4)*        &
!            &      A(4,1) + A(1,4)*A(2,3)*A(3,5)*A(4,1) - A(1,3)*A(2,4)*A(3,5)*        &
!            &      A(4,1) - A(1,5)*A(2,4)*A(3,1)*A(4,3) + A(1,4)*A(2,5)*A(3,1)*        &
!            &      A(4,3) + A(1,5)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,5)*A(3,4)*        &
!            &      A(4,3) - A(1,4)*A(2,1)*A(3,5)*A(4,3) + A(1,1)*A(2,4)*A(3,5)*        &
!            &      A(4,3) + A(1,5)*A(2,3)*A(3,1)*A(4,4) - A(1,3)*A(2,5)*A(3,1)*        &
!            &      A(4,4) - A(1,5)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,5)*A(3,3)*        &
!            &      A(4,4) + A(1,3)*A(2,1)*A(3,5)*A(4,4) - A(1,1)*A(2,3)*A(3,5)*        &
!            &      A(4,4) - A(1,4)*A(2,3)*A(3,1)*A(4,5) + A(1,3)*A(2,4)*A(3,1)*        &
!            &      A(4,5) + A(1,4)*A(2,1)*A(3,3)*A(4,5) - A(1,1)*A(2,4)*A(3,3)*        &
!            &      A(4,5) - A(1,3)*A(2,1)*A(3,4)*A(4,5) + A(1,1)*A(2,3)*A(3,4)*        &
!            &      A(4,5))*A(5,6))*A(6,2) -                                                 &
!            & ((A(1,6)*A(2,5)*A(3,4)*A(4,2) - A(1,5)*A(2,6)*A(3,4)*A(4,2) -            &
!            &     A(1,6)*A(2,4)*A(3,5)*A(4,2) + A(1,4)*A(2,6)*A(3,5)*A(4,2) +          &
!            &     A(1,5)*A(2,4)*A(3,6)*A(4,2) - A(1,4)*A(2,5)*A(3,6)*A(4,2) -          &
!            &     A(1,6)*A(2,5)*A(3,2)*A(4,4) + A(1,5)*A(2,6)*A(3,2)*A(4,4) +          &
!            &     A(1,6)*A(2,2)*A(3,5)*A(4,4) - A(1,2)*A(2,6)*A(3,5)*A(4,4) -          &
!            &     A(1,5)*A(2,2)*A(3,6)*A(4,4) + A(1,2)*A(2,5)*A(3,6)*A(4,4) +          &
!            &     A(1,6)*A(2,4)*A(3,2)*A(4,5) - A(1,4)*A(2,6)*A(3,2)*A(4,5) -          &
!            &     A(1,6)*A(2,2)*A(3,4)*A(4,5) + A(1,2)*A(2,6)*A(3,4)*A(4,5) +          &
!            &     A(1,4)*A(2,2)*A(3,6)*A(4,5) - A(1,2)*A(2,4)*A(3,6)*A(4,5) -          &
!            &     A(1,5)*A(2,4)*A(3,2)*A(4,6) + A(1,4)*A(2,5)*A(3,2)*A(4,6) +          &
!            &     A(1,5)*A(2,2)*A(3,4)*A(4,6) - A(1,2)*A(2,5)*A(3,4)*A(4,6) -          &
!            &     A(1,4)*A(2,2)*A(3,5)*A(4,6) + A(1,2)*A(2,4)*A(3,5)*A(4,6))*          &
!            &    A(5,1) - (A(1,6)*A(2,5)*A(3,4)*A(4,1) - A(1,5)*A(2,6)*A(3,4)*         &
!            &      A(4,1) - A(1,6)*A(2,4)*A(3,5)*A(4,1) + A(1,4)*A(2,6)*A(3,5)*        &
!            &      A(4,1) + A(1,5)*A(2,4)*A(3,6)*A(4,1) - A(1,4)*A(2,5)*A(3,6)*        &
!            &      A(4,1) - A(1,6)*A(2,5)*A(3,1)*A(4,4) + A(1,5)*A(2,6)*A(3,1)*        &
!            &      A(4,4) + A(1,6)*A(2,1)*A(3,5)*A(4,4) - A(1,1)*A(2,6)*A(3,5)*        &
!            &      A(4,4) - A(1,5)*A(2,1)*A(3,6)*A(4,4) + A(1,1)*A(2,5)*A(3,6)*        &
!            &      A(4,4) + A(1,6)*A(2,4)*A(3,1)*A(4,5) - A(1,4)*A(2,6)*A(3,1)*        &
!            &      A(4,5) - A(1,6)*A(2,1)*A(3,4)*A(4,5) + A(1,1)*A(2,6)*A(3,4)*        &
!            &      A(4,5) + A(1,4)*A(2,1)*A(3,6)*A(4,5) - A(1,1)*A(2,4)*A(3,6)*        &
!            &      A(4,5) - A(1,5)*A(2,4)*A(3,1)*A(4,6) + A(1,4)*A(2,5)*A(3,1)*        &
!            &      A(4,6) + A(1,5)*A(2,1)*A(3,4)*A(4,6) - A(1,1)*A(2,5)*A(3,4)*        &
!            &      A(4,6) - A(1,4)*A(2,1)*A(3,5)*A(4,6) + A(1,1)*A(2,4)*A(3,5)*        &
!            &      A(4,6))*A(5,2) + (A(1,6)*A(2,5)*A(3,2)*A(4,1) -                       &
!            &     A(1,5)*A(2,6)*A(3,2)*A(4,1) - A(1,6)*A(2,2)*A(3,5)*A(4,1) +          &
!            &     A(1,2)*A(2,6)*A(3,5)*A(4,1) + A(1,5)*A(2,2)*A(3,6)*A(4,1) -          &
!            &     A(1,2)*A(2,5)*A(3,6)*A(4,1) - A(1,6)*A(2,5)*A(3,1)*A(4,2) +          &
!            &     A(1,5)*A(2,6)*A(3,1)*A(4,2) + A(1,6)*A(2,1)*A(3,5)*A(4,2) -          &
!            &     A(1,1)*A(2,6)*A(3,5)*A(4,2) - A(1,5)*A(2,1)*A(3,6)*A(4,2) +          &
!            &     A(1,1)*A(2,5)*A(3,6)*A(4,2) + A(1,6)*A(2,2)*A(3,1)*A(4,5) -          &
!            &     A(1,2)*A(2,6)*A(3,1)*A(4,5) - A(1,6)*A(2,1)*A(3,2)*A(4,5) +          &
!            &     A(1,1)*A(2,6)*A(3,2)*A(4,5) + A(1,2)*A(2,1)*A(3,6)*A(4,5) -          &
!            &     A(1,1)*A(2,2)*A(3,6)*A(4,5) - A(1,5)*A(2,2)*A(3,1)*A(4,6) +          &
!            &     A(1,2)*A(2,5)*A(3,1)*A(4,6) + A(1,5)*A(2,1)*A(3,2)*A(4,6) -          &
!            &     A(1,1)*A(2,5)*A(3,2)*A(4,6) - A(1,2)*A(2,1)*A(3,5)*A(4,6) +          &
!            &     A(1,1)*A(2,2)*A(3,5)*A(4,6))*A(5,4) -                                   &
!            &   (A(1,6)*A(2,4)*A(3,2)*A(4,1) - A(1,4)*A(2,6)*A(3,2)*A(4,1) -           &
!            &     A(1,6)*A(2,2)*A(3,4)*A(4,1) + A(1,2)*A(2,6)*A(3,4)*A(4,1) +          &
!            &     A(1,4)*A(2,2)*A(3,6)*A(4,1) - A(1,2)*A(2,4)*A(3,6)*A(4,1) -          &
!            &     A(1,6)*A(2,4)*A(3,1)*A(4,2) + A(1,4)*A(2,6)*A(3,1)*A(4,2) +          &
!            &     A(1,6)*A(2,1)*A(3,4)*A(4,2) - A(1,1)*A(2,6)*A(3,4)*A(4,2) -          &
!            &     A(1,4)*A(2,1)*A(3,6)*A(4,2) + A(1,1)*A(2,4)*A(3,6)*A(4,2) +          &
!            &     A(1,6)*A(2,2)*A(3,1)*A(4,4) - A(1,2)*A(2,6)*A(3,1)*A(4,4) -          &
!            &     A(1,6)*A(2,1)*A(3,2)*A(4,4) + A(1,1)*A(2,6)*A(3,2)*A(4,4) +          &
!            &     A(1,2)*A(2,1)*A(3,6)*A(4,4) - A(1,1)*A(2,2)*A(3,6)*A(4,4) -          &
!            &     A(1,4)*A(2,2)*A(3,1)*A(4,6) + A(1,2)*A(2,4)*A(3,1)*A(4,6) +          &
!            &     A(1,4)*A(2,1)*A(3,2)*A(4,6) - A(1,1)*A(2,4)*A(3,2)*A(4,6) -          &
!            &     A(1,2)*A(2,1)*A(3,4)*A(4,6) + A(1,1)*A(2,2)*A(3,4)*A(4,6))*          &
!            &    A(5,5) + (A(1,5)*A(2,4)*A(3,2)*A(4,1) - A(1,4)*A(2,5)*A(3,2)*         &
!            &      A(4,1) - A(1,5)*A(2,2)*A(3,4)*A(4,1) + A(1,2)*A(2,5)*A(3,4)*        &
!            &      A(4,1) + A(1,4)*A(2,2)*A(3,5)*A(4,1) - A(1,2)*A(2,4)*A(3,5)*        &
!            &      A(4,1) - A(1,5)*A(2,4)*A(3,1)*A(4,2) + A(1,4)*A(2,5)*A(3,1)*        &
!            &      A(4,2) + A(1,5)*A(2,1)*A(3,4)*A(4,2) - A(1,1)*A(2,5)*A(3,4)*        &
!            &      A(4,2) - A(1,4)*A(2,1)*A(3,5)*A(4,2) + A(1,1)*A(2,4)*A(3,5)*        &
!            &      A(4,2) + A(1,5)*A(2,2)*A(3,1)*A(4,4) - A(1,2)*A(2,5)*A(3,1)*        &
!            &      A(4,4) - A(1,5)*A(2,1)*A(3,2)*A(4,4) + A(1,1)*A(2,5)*A(3,2)*        &
!            &      A(4,4) + A(1,2)*A(2,1)*A(3,5)*A(4,4) - A(1,1)*A(2,2)*A(3,5)*        &
!            &      A(4,4) - A(1,4)*A(2,2)*A(3,1)*A(4,5) + A(1,2)*A(2,4)*A(3,1)*        &
!            &      A(4,5) + A(1,4)*A(2,1)*A(3,2)*A(4,5) - A(1,1)*A(2,4)*A(3,2)*        &
!            &      A(4,5) - A(1,2)*A(2,1)*A(3,4)*A(4,5) + A(1,1)*A(2,2)*A(3,4)*        &
!            &      A(4,5))*A(5,6))*A(6,3) +                                                 &
!            & ((A(1,6)*A(2,5)*A(3,3)*A(4,2) - A(1,5)*A(2,6)*A(3,3)*A(4,2) -            &
!            &     A(1,6)*A(2,3)*A(3,5)*A(4,2) + A(1,3)*A(2,6)*A(3,5)*A(4,2) +          &
!            &     A(1,5)*A(2,3)*A(3,6)*A(4,2) - A(1,3)*A(2,5)*A(3,6)*A(4,2) -          &
!            &     A(1,6)*A(2,5)*A(3,2)*A(4,3) + A(1,5)*A(2,6)*A(3,2)*A(4,3) +          &
!            &     A(1,6)*A(2,2)*A(3,5)*A(4,3) - A(1,2)*A(2,6)*A(3,5)*A(4,3) -          &
!            &     A(1,5)*A(2,2)*A(3,6)*A(4,3) + A(1,2)*A(2,5)*A(3,6)*A(4,3) +          &
!            &     A(1,6)*A(2,3)*A(3,2)*A(4,5) - A(1,3)*A(2,6)*A(3,2)*A(4,5) -          &
!            &     A(1,6)*A(2,2)*A(3,3)*A(4,5) + A(1,2)*A(2,6)*A(3,3)*A(4,5) +          &
!            &     A(1,3)*A(2,2)*A(3,6)*A(4,5) - A(1,2)*A(2,3)*A(3,6)*A(4,5) -          &
!            &     A(1,5)*A(2,3)*A(3,2)*A(4,6) + A(1,3)*A(2,5)*A(3,2)*A(4,6) +          &
!            &     A(1,5)*A(2,2)*A(3,3)*A(4,6) - A(1,2)*A(2,5)*A(3,3)*A(4,6) -          &
!            &     A(1,3)*A(2,2)*A(3,5)*A(4,6) + A(1,2)*A(2,3)*A(3,5)*A(4,6))*          &
!            &    A(5,1) - (A(1,6)*A(2,5)*A(3,3)*A(4,1) - A(1,5)*A(2,6)*A(3,3)*         &
!            &      A(4,1) - A(1,6)*A(2,3)*A(3,5)*A(4,1) + A(1,3)*A(2,6)*A(3,5)*        &
!            &      A(4,1) + A(1,5)*A(2,3)*A(3,6)*A(4,1) - A(1,3)*A(2,5)*A(3,6)*        &
!            &      A(4,1) - A(1,6)*A(2,5)*A(3,1)*A(4,3) + A(1,5)*A(2,6)*A(3,1)*        &
!            &      A(4,3) + A(1,6)*A(2,1)*A(3,5)*A(4,3) - A(1,1)*A(2,6)*A(3,5)*        &
!            &      A(4,3) - A(1,5)*A(2,1)*A(3,6)*A(4,3) + A(1,1)*A(2,5)*A(3,6)*        &
!            &      A(4,3) + A(1,6)*A(2,3)*A(3,1)*A(4,5) - A(1,3)*A(2,6)*A(3,1)*        &
!            &      A(4,5) - A(1,6)*A(2,1)*A(3,3)*A(4,5) + A(1,1)*A(2,6)*A(3,3)*        &
!            &      A(4,5) + A(1,3)*A(2,1)*A(3,6)*A(4,5) - A(1,1)*A(2,3)*A(3,6)*        &
!            &      A(4,5) - A(1,5)*A(2,3)*A(3,1)*A(4,6) + A(1,3)*A(2,5)*A(3,1)*        &
!            &      A(4,6) + A(1,5)*A(2,1)*A(3,3)*A(4,6) - A(1,1)*A(2,5)*A(3,3)*        &
!            &      A(4,6) - A(1,3)*A(2,1)*A(3,5)*A(4,6) + A(1,1)*A(2,3)*A(3,5)*        &
!            &      A(4,6))*A(5,2) + (A(1,6)*A(2,5)*A(3,2)*A(4,1) -                       &
!            &     A(1,5)*A(2,6)*A(3,2)*A(4,1) - A(1,6)*A(2,2)*A(3,5)*A(4,1) +          &
!            &     A(1,2)*A(2,6)*A(3,5)*A(4,1) + A(1,5)*A(2,2)*A(3,6)*A(4,1) -          &
!            &     A(1,2)*A(2,5)*A(3,6)*A(4,1) - A(1,6)*A(2,5)*A(3,1)*A(4,2) +          &
!            &     A(1,5)*A(2,6)*A(3,1)*A(4,2) + A(1,6)*A(2,1)*A(3,5)*A(4,2) -          &
!            &     A(1,1)*A(2,6)*A(3,5)*A(4,2) - A(1,5)*A(2,1)*A(3,6)*A(4,2) +          &
!            &     A(1,1)*A(2,5)*A(3,6)*A(4,2) + A(1,6)*A(2,2)*A(3,1)*A(4,5) -          &
!            &     A(1,2)*A(2,6)*A(3,1)*A(4,5) - A(1,6)*A(2,1)*A(3,2)*A(4,5) +          &
!            &     A(1,1)*A(2,6)*A(3,2)*A(4,5) + A(1,2)*A(2,1)*A(3,6)*A(4,5) -          &
!            &     A(1,1)*A(2,2)*A(3,6)*A(4,5) - A(1,5)*A(2,2)*A(3,1)*A(4,6) +          &
!            &     A(1,2)*A(2,5)*A(3,1)*A(4,6) + A(1,5)*A(2,1)*A(3,2)*A(4,6) -          &
!            &     A(1,1)*A(2,5)*A(3,2)*A(4,6) - A(1,2)*A(2,1)*A(3,5)*A(4,6) +          &
!            &     A(1,1)*A(2,2)*A(3,5)*A(4,6))*A(5,3) -                                   &
!            &   (A(1,6)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,6)*A(3,2)*A(4,1) -           &
!            &     A(1,6)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,6)*A(3,3)*A(4,1) +          &
!            &     A(1,3)*A(2,2)*A(3,6)*A(4,1) - A(1,2)*A(2,3)*A(3,6)*A(4,1) -          &
!            &     A(1,6)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,6)*A(3,1)*A(4,2) +          &
!            &     A(1,6)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,6)*A(3,3)*A(4,2) -          &
!            &     A(1,3)*A(2,1)*A(3,6)*A(4,2) + A(1,1)*A(2,3)*A(3,6)*A(4,2) +          &
!            &     A(1,6)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,6)*A(3,1)*A(4,3) -          &
!            &     A(1,6)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,6)*A(3,2)*A(4,3) +          &
!            &     A(1,2)*A(2,1)*A(3,6)*A(4,3) - A(1,1)*A(2,2)*A(3,6)*A(4,3) -          &
!            &     A(1,3)*A(2,2)*A(3,1)*A(4,6) + A(1,2)*A(2,3)*A(3,1)*A(4,6) +          &
!            &     A(1,3)*A(2,1)*A(3,2)*A(4,6) - A(1,1)*A(2,3)*A(3,2)*A(4,6) -          &
!            &     A(1,2)*A(2,1)*A(3,3)*A(4,6) + A(1,1)*A(2,2)*A(3,3)*A(4,6))*          &
!            &    A(5,5) + (A(1,5)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,5)*A(3,2)*         &
!            &      A(4,1) - A(1,5)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,5)*A(3,3)*        &
!            &      A(4,1) + A(1,3)*A(2,2)*A(3,5)*A(4,1) - A(1,2)*A(2,3)*A(3,5)*        &
!            &      A(4,1) - A(1,5)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,5)*A(3,1)*        &
!            &      A(4,2) + A(1,5)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,5)*A(3,3)*        &
!            &      A(4,2) - A(1,3)*A(2,1)*A(3,5)*A(4,2) + A(1,1)*A(2,3)*A(3,5)*        &
!            &      A(4,2) + A(1,5)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,5)*A(3,1)*        &
!            &      A(4,3) - A(1,5)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,5)*A(3,2)*        &
!            &      A(4,3) + A(1,2)*A(2,1)*A(3,5)*A(4,3) - A(1,1)*A(2,2)*A(3,5)*        &
!            &      A(4,3) - A(1,3)*A(2,2)*A(3,1)*A(4,5) + A(1,2)*A(2,3)*A(3,1)*        &
!            &      A(4,5) + A(1,3)*A(2,1)*A(3,2)*A(4,5) - A(1,1)*A(2,3)*A(3,2)*        &
!            &      A(4,5) - A(1,2)*A(2,1)*A(3,3)*A(4,5) + A(1,1)*A(2,2)*A(3,3)*        &
!            &      A(4,5))*A(5,6))*A(6,4) -                                                 &
!            & ((A(1,6)*A(2,4)*A(3,3)*A(4,2) - A(1,4)*A(2,6)*A(3,3)*A(4,2) -            &
!            &     A(1,6)*A(2,3)*A(3,4)*A(4,2) + A(1,3)*A(2,6)*A(3,4)*A(4,2) +          &
!            &     A(1,4)*A(2,3)*A(3,6)*A(4,2) - A(1,3)*A(2,4)*A(3,6)*A(4,2) -          &
!            &     A(1,6)*A(2,4)*A(3,2)*A(4,3) + A(1,4)*A(2,6)*A(3,2)*A(4,3) +          &
!            &     A(1,6)*A(2,2)*A(3,4)*A(4,3) - A(1,2)*A(2,6)*A(3,4)*A(4,3) -          &
!            &     A(1,4)*A(2,2)*A(3,6)*A(4,3) + A(1,2)*A(2,4)*A(3,6)*A(4,3) +          &
!            &     A(1,6)*A(2,3)*A(3,2)*A(4,4) - A(1,3)*A(2,6)*A(3,2)*A(4,4) -          &
!            &     A(1,6)*A(2,2)*A(3,3)*A(4,4) + A(1,2)*A(2,6)*A(3,3)*A(4,4) +          &
!            &     A(1,3)*A(2,2)*A(3,6)*A(4,4) - A(1,2)*A(2,3)*A(3,6)*A(4,4) -          &
!            &     A(1,4)*A(2,3)*A(3,2)*A(4,6) + A(1,3)*A(2,4)*A(3,2)*A(4,6) +          &
!            &     A(1,4)*A(2,2)*A(3,3)*A(4,6) - A(1,2)*A(2,4)*A(3,3)*A(4,6) -          &
!            &     A(1,3)*A(2,2)*A(3,4)*A(4,6) + A(1,2)*A(2,3)*A(3,4)*A(4,6))*          &
!            &    A(5,1) - (A(1,6)*A(2,4)*A(3,3)*A(4,1) - A(1,4)*A(2,6)*A(3,3)*         &
!            &      A(4,1) - A(1,6)*A(2,3)*A(3,4)*A(4,1) + A(1,3)*A(2,6)*A(3,4)*        &
!            &      A(4,1) + A(1,4)*A(2,3)*A(3,6)*A(4,1) - A(1,3)*A(2,4)*A(3,6)*        &
!            &      A(4,1) - A(1,6)*A(2,4)*A(3,1)*A(4,3) + A(1,4)*A(2,6)*A(3,1)*        &
!            &      A(4,3) + A(1,6)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,6)*A(3,4)*        &
!            &      A(4,3) - A(1,4)*A(2,1)*A(3,6)*A(4,3) + A(1,1)*A(2,4)*A(3,6)*        &
!            &      A(4,3) + A(1,6)*A(2,3)*A(3,1)*A(4,4) - A(1,3)*A(2,6)*A(3,1)*        &
!            &      A(4,4) - A(1,6)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,6)*A(3,3)*        &
!            &      A(4,4) + A(1,3)*A(2,1)*A(3,6)*A(4,4) - A(1,1)*A(2,3)*A(3,6)*        &
!            &      A(4,4) - A(1,4)*A(2,3)*A(3,1)*A(4,6) + A(1,3)*A(2,4)*A(3,1)*        &
!            &      A(4,6) + A(1,4)*A(2,1)*A(3,3)*A(4,6) - A(1,1)*A(2,4)*A(3,3)*        &
!            &      A(4,6) - A(1,3)*A(2,1)*A(3,4)*A(4,6) + A(1,1)*A(2,3)*A(3,4)*        &
!            &      A(4,6))*A(5,2) + (A(1,6)*A(2,4)*A(3,2)*A(4,1) -                       &
!            &     A(1,4)*A(2,6)*A(3,2)*A(4,1) - A(1,6)*A(2,2)*A(3,4)*A(4,1) +          &
!            &     A(1,2)*A(2,6)*A(3,4)*A(4,1) + A(1,4)*A(2,2)*A(3,6)*A(4,1) -          &
!            &     A(1,2)*A(2,4)*A(3,6)*A(4,1) - A(1,6)*A(2,4)*A(3,1)*A(4,2) +          &
!            &     A(1,4)*A(2,6)*A(3,1)*A(4,2) + A(1,6)*A(2,1)*A(3,4)*A(4,2) -          &
!            &     A(1,1)*A(2,6)*A(3,4)*A(4,2) - A(1,4)*A(2,1)*A(3,6)*A(4,2) +          &
!            &     A(1,1)*A(2,4)*A(3,6)*A(4,2) + A(1,6)*A(2,2)*A(3,1)*A(4,4) -          &
!            &     A(1,2)*A(2,6)*A(3,1)*A(4,4) - A(1,6)*A(2,1)*A(3,2)*A(4,4) +          &
!            &     A(1,1)*A(2,6)*A(3,2)*A(4,4) + A(1,2)*A(2,1)*A(3,6)*A(4,4) -          &
!            &     A(1,1)*A(2,2)*A(3,6)*A(4,4) - A(1,4)*A(2,2)*A(3,1)*A(4,6) +          &
!            &     A(1,2)*A(2,4)*A(3,1)*A(4,6) + A(1,4)*A(2,1)*A(3,2)*A(4,6) -          &
!            &     A(1,1)*A(2,4)*A(3,2)*A(4,6) - A(1,2)*A(2,1)*A(3,4)*A(4,6) +          &
!            &     A(1,1)*A(2,2)*A(3,4)*A(4,6))*A(5,3) -                                   &
!            &   (A(1,6)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,6)*A(3,2)*A(4,1) -           &
!            &     A(1,6)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,6)*A(3,3)*A(4,1) +          &
!            &     A(1,3)*A(2,2)*A(3,6)*A(4,1) - A(1,2)*A(2,3)*A(3,6)*A(4,1) -          &
!            &     A(1,6)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,6)*A(3,1)*A(4,2) +          &
!            &     A(1,6)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,6)*A(3,3)*A(4,2) -          &
!            &     A(1,3)*A(2,1)*A(3,6)*A(4,2) + A(1,1)*A(2,3)*A(3,6)*A(4,2) +          &
!            &     A(1,6)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,6)*A(3,1)*A(4,3) -          &
!            &     A(1,6)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,6)*A(3,2)*A(4,3) +          &
!            &     A(1,2)*A(2,1)*A(3,6)*A(4,3) - A(1,1)*A(2,2)*A(3,6)*A(4,3) -          &
!            &     A(1,3)*A(2,2)*A(3,1)*A(4,6) + A(1,2)*A(2,3)*A(3,1)*A(4,6) +          &
!            &     A(1,3)*A(2,1)*A(3,2)*A(4,6) - A(1,1)*A(2,3)*A(3,2)*A(4,6) -          &
!            &     A(1,2)*A(2,1)*A(3,3)*A(4,6) + A(1,1)*A(2,2)*A(3,3)*A(4,6))*          &
!            &    A(5,4) + (A(1,4)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,4)*A(3,2)*         &
!            &      A(4,1) - A(1,4)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,4)*A(3,3)*        &
!            &      A(4,1) + A(1,3)*A(2,2)*A(3,4)*A(4,1) - A(1,2)*A(2,3)*A(3,4)*        &
!            &      A(4,1) - A(1,4)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,4)*A(3,1)*        &
!            &      A(4,2) + A(1,4)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,4)*A(3,3)*        &
!            &      A(4,2) - A(1,3)*A(2,1)*A(3,4)*A(4,2) + A(1,1)*A(2,3)*A(3,4)*        &
!            &      A(4,2) + A(1,4)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,4)*A(3,1)*        &
!            &      A(4,3) - A(1,4)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,4)*A(3,2)*        &
!            &      A(4,3) + A(1,2)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,2)*A(3,4)*        &
!            &      A(4,3) - A(1,3)*A(2,2)*A(3,1)*A(4,4) + A(1,2)*A(2,3)*A(3,1)*        &
!            &      A(4,4) + A(1,3)*A(2,1)*A(3,2)*A(4,4) - A(1,1)*A(2,3)*A(3,2)*        &
!            &      A(4,4) - A(1,2)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,2)*A(3,3)*        &
!            &      A(4,4))*A(5,6))*A(6,5) +                                                 &
!            & ((A(1,5)*A(2,4)*A(3,3)*A(4,2) - A(1,4)*A(2,5)*A(3,3)*A(4,2) -            &
!            &     A(1,5)*A(2,3)*A(3,4)*A(4,2) + A(1,3)*A(2,5)*A(3,4)*A(4,2) +          &
!            &     A(1,4)*A(2,3)*A(3,5)*A(4,2) - A(1,3)*A(2,4)*A(3,5)*A(4,2) -          &
!            &     A(1,5)*A(2,4)*A(3,2)*A(4,3) + A(1,4)*A(2,5)*A(3,2)*A(4,3) +          &
!            &     A(1,5)*A(2,2)*A(3,4)*A(4,3) - A(1,2)*A(2,5)*A(3,4)*A(4,3) -          &
!            &     A(1,4)*A(2,2)*A(3,5)*A(4,3) + A(1,2)*A(2,4)*A(3,5)*A(4,3) +          &
!            &     A(1,5)*A(2,3)*A(3,2)*A(4,4) - A(1,3)*A(2,5)*A(3,2)*A(4,4) -          &
!            &     A(1,5)*A(2,2)*A(3,3)*A(4,4) + A(1,2)*A(2,5)*A(3,3)*A(4,4) +          &
!            &     A(1,3)*A(2,2)*A(3,5)*A(4,4) - A(1,2)*A(2,3)*A(3,5)*A(4,4) -          &
!            &     A(1,4)*A(2,3)*A(3,2)*A(4,5) + A(1,3)*A(2,4)*A(3,2)*A(4,5) +          &
!            &     A(1,4)*A(2,2)*A(3,3)*A(4,5) - A(1,2)*A(2,4)*A(3,3)*A(4,5) -          &
!            &     A(1,3)*A(2,2)*A(3,4)*A(4,5) + A(1,2)*A(2,3)*A(3,4)*A(4,5))*          &
!            &    A(5,1) - (A(1,5)*A(2,4)*A(3,3)*A(4,1) - A(1,4)*A(2,5)*A(3,3)*         &
!            &      A(4,1) - A(1,5)*A(2,3)*A(3,4)*A(4,1) + A(1,3)*A(2,5)*A(3,4)*        &
!            &      A(4,1) + A(1,4)*A(2,3)*A(3,5)*A(4,1) - A(1,3)*A(2,4)*A(3,5)*        &
!            &      A(4,1) - A(1,5)*A(2,4)*A(3,1)*A(4,3) + A(1,4)*A(2,5)*A(3,1)*        &
!            &      A(4,3) + A(1,5)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,5)*A(3,4)*        &
!            &      A(4,3) - A(1,4)*A(2,1)*A(3,5)*A(4,3) + A(1,1)*A(2,4)*A(3,5)*        &
!            &      A(4,3) + A(1,5)*A(2,3)*A(3,1)*A(4,4) - A(1,3)*A(2,5)*A(3,1)*        &
!            &      A(4,4) - A(1,5)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,5)*A(3,3)*        &
!            &      A(4,4) + A(1,3)*A(2,1)*A(3,5)*A(4,4) - A(1,1)*A(2,3)*A(3,5)*        &
!            &      A(4,4) - A(1,4)*A(2,3)*A(3,1)*A(4,5) + A(1,3)*A(2,4)*A(3,1)*        &
!            &      A(4,5) + A(1,4)*A(2,1)*A(3,3)*A(4,5) - A(1,1)*A(2,4)*A(3,3)*        &
!            &      A(4,5) - A(1,3)*A(2,1)*A(3,4)*A(4,5) + A(1,1)*A(2,3)*A(3,4)*        &
!            &      A(4,5))*A(5,2) + (A(1,5)*A(2,4)*A(3,2)*A(4,1) -                       &
!            &     A(1,4)*A(2,5)*A(3,2)*A(4,1) - A(1,5)*A(2,2)*A(3,4)*A(4,1) +          &
!            &     A(1,2)*A(2,5)*A(3,4)*A(4,1) + A(1,4)*A(2,2)*A(3,5)*A(4,1) -          &
!            &     A(1,2)*A(2,4)*A(3,5)*A(4,1) - A(1,5)*A(2,4)*A(3,1)*A(4,2) +          &
!            &     A(1,4)*A(2,5)*A(3,1)*A(4,2) + A(1,5)*A(2,1)*A(3,4)*A(4,2) -          &
!            &     A(1,1)*A(2,5)*A(3,4)*A(4,2) - A(1,4)*A(2,1)*A(3,5)*A(4,2) +          &
!            &     A(1,1)*A(2,4)*A(3,5)*A(4,2) + A(1,5)*A(2,2)*A(3,1)*A(4,4) -          &
!            &     A(1,2)*A(2,5)*A(3,1)*A(4,4) - A(1,5)*A(2,1)*A(3,2)*A(4,4) +          &
!            &     A(1,1)*A(2,5)*A(3,2)*A(4,4) + A(1,2)*A(2,1)*A(3,5)*A(4,4) -          &
!            &     A(1,1)*A(2,2)*A(3,5)*A(4,4) - A(1,4)*A(2,2)*A(3,1)*A(4,5) +          &
!            &     A(1,2)*A(2,4)*A(3,1)*A(4,5) + A(1,4)*A(2,1)*A(3,2)*A(4,5) -          &
!            &     A(1,1)*A(2,4)*A(3,2)*A(4,5) - A(1,2)*A(2,1)*A(3,4)*A(4,5) +          &
!            &     A(1,1)*A(2,2)*A(3,4)*A(4,5))*A(5,3) -                                   &
!            &   (A(1,5)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,5)*A(3,2)*A(4,1) -           &
!            &     A(1,5)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,5)*A(3,3)*A(4,1) +          &
!            &     A(1,3)*A(2,2)*A(3,5)*A(4,1) - A(1,2)*A(2,3)*A(3,5)*A(4,1) -          &
!            &     A(1,5)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,5)*A(3,1)*A(4,2) +          &
!            &     A(1,5)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,5)*A(3,3)*A(4,2) -          &
!            &     A(1,3)*A(2,1)*A(3,5)*A(4,2) + A(1,1)*A(2,3)*A(3,5)*A(4,2) +          &
!            &     A(1,5)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,5)*A(3,1)*A(4,3) -          &
!            &     A(1,5)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,5)*A(3,2)*A(4,3) +          &
!            &     A(1,2)*A(2,1)*A(3,5)*A(4,3) - A(1,1)*A(2,2)*A(3,5)*A(4,3) -          &
!            &     A(1,3)*A(2,2)*A(3,1)*A(4,5) + A(1,2)*A(2,3)*A(3,1)*A(4,5) +          &
!            &     A(1,3)*A(2,1)*A(3,2)*A(4,5) - A(1,1)*A(2,3)*A(3,2)*A(4,5) -          &
!            &     A(1,2)*A(2,1)*A(3,3)*A(4,5) + A(1,1)*A(2,2)*A(3,3)*A(4,5))*          &
!            &    A(5,4) + (A(1,4)*A(2,3)*A(3,2)*A(4,1) - A(1,3)*A(2,4)*A(3,2)*         &
!            &      A(4,1) - A(1,4)*A(2,2)*A(3,3)*A(4,1) + A(1,2)*A(2,4)*A(3,3)*        &
!            &      A(4,1) + A(1,3)*A(2,2)*A(3,4)*A(4,1) - A(1,2)*A(2,3)*A(3,4)*        &
!            &      A(4,1) - A(1,4)*A(2,3)*A(3,1)*A(4,2) + A(1,3)*A(2,4)*A(3,1)*        &
!            &      A(4,2) + A(1,4)*A(2,1)*A(3,3)*A(4,2) - A(1,1)*A(2,4)*A(3,3)*        &
!            &      A(4,2) - A(1,3)*A(2,1)*A(3,4)*A(4,2) + A(1,1)*A(2,3)*A(3,4)*        &
!            &      A(4,2) + A(1,4)*A(2,2)*A(3,1)*A(4,3) - A(1,2)*A(2,4)*A(3,1)*        &
!            &      A(4,3) - A(1,4)*A(2,1)*A(3,2)*A(4,3) + A(1,1)*A(2,4)*A(3,2)*        &
!            &      A(4,3) + A(1,2)*A(2,1)*A(3,4)*A(4,3) - A(1,1)*A(2,2)*A(3,4)*        &
!            &      A(4,3) - A(1,3)*A(2,2)*A(3,1)*A(4,4) + A(1,2)*A(2,3)*A(3,1)*        &
!            &      A(4,4) + A(1,3)*A(2,1)*A(3,2)*A(4,4) - A(1,1)*A(2,3)*A(3,2)*        &
!            &      A(4,4) - A(1,2)*A(2,1)*A(3,3)*A(4,4) + A(1,1)*A(2,2)*A(3,3)*        &
!            &      A(4,4))*A(5,5))*A(6,6)    
    else
       do i=1,n
          if (A(1,i) /= zero) then 
             det = det + (-1)**(i+1)*A(1,i)*mydetc(Complement(A,1,i))
          end if
       end do
    end if
    !if (n ==6) write(*,*) 'in mydetcc:',n,det 

  end function mydetc


!  function determinant(matin) result(det)
!  use types; use consts_dp
!    complex(dp), intent(in) :: matin(:,:)
!    integer     :: m,n
!    complex(dp) :: det
!!    complex(dp) :: temp(size(matin,dim=2))
!    complex(dp) :: mat(size(matin,dim=1),size(matin,dim=2))
!    complex(dp) :: Rot(size(matin,dim=1),size(matin,dim=2))
!    complex(dp) ::  r11,r12,r13,r14,r15,r21,r22,r23,r24,r25
!    complex(dp) ::  r31,r32,r33,r34,r35,r41,r42,r43,r44,r45
!    complex(dp) ::  r51,r52,r53,r54,r55
!    complex(dp) ::  r16,r26, r36,r46,r56 
!    complex(dp) ::  r61,r62,r63,r64,r65,r66
!
!    mat=matin
!    det=zero
!    m=size(matin,dim=1)
!    n=size(matin,dim=2)
!    if (m /= n) stop 'determinant: matrix is not square' 
!
!    Rot = matin 
!    
!    if (n==2) then 
!       det=Rot(1,1)*Rot(2,2)-Rot(1,2)*Rot(2,1)
!    elseif (n == 3) then 
!          det  =Rot(1,1)*Rot(2,2)*Rot(3,3)+Rot(1,2)*Rot(2,3)*Rot(3,1)+&
!               &Rot(1,3)*Rot(2,1)*Rot(3,2)-Rot(1,3)*Rot(2,2)*Rot(3,1)-&
!               &Rot(1,2)*Rot(2,1)*Rot(3,3)-Rot(1,1)*Rot(2,3)*Rot(3,2)
!    elseif (n == 4) then 
!          r11=Rot(1,1); r12=Rot(1,2); r13=Rot(1,3) ;r14=Rot(1,4)
!          r21=Rot(2,1); r22=Rot(2,2); r23=Rot(2,3); r24=Rot(2,4)
!          r31=Rot(3,1); r32=Rot(3,2); r33=Rot(3,3); r34=Rot(3,4)
!          r41=Rot(4,1); r42=Rot(4,2); r43=Rot(4,3); r44=Rot(4,4)
!
!          det = &
!               &        r14*r23*r32*r41 - r13*r24*r32*r41 - &
!               &      r14*r22*r33*r41 + r12*r24*r33*r41 + &
!               &      r13*r22*r34*r41 - r12*r23*r34*r41 - & 
!               &      r14*r23*r31*r42 + r13*r24*r31*r42 + &
!               &      r14*r21*r33*r42 - r11*r24*r33*r42 - &
!               &      r13*r21*r34*r42 + r11*r23*r34*r42 + &
!               &      r14*r22*r31*r43 - r12*r24*r31*r43 - &
!               &      r14*r21*r32*r43 + r11*r24*r32*r43 + &
!               &      r12*r21*r34*r43 - r11*r22*r34*r43 - &
!               &      r13*r22*r31*r44 + r12*r23*r31*r44 + &
!               &      r13*r21*r32*r44 - r11*r23*r32*r44 - &
!               &      r12*r21*r33*r44 + r11*r22*r33*r44             
!    elseif (n == 5) then 
!          r11=Rot(1,1);r12=Rot(1,2);r13=Rot(1,3);r14=Rot(1,4);r15=Rot(1,5)
!          r21=Rot(2,1);r22=Rot(2,2);r23=Rot(2,3);r24=Rot(2,4);r25=Rot(2,5)
!          r31=Rot(3,1);r32=Rot(3,2);r33=Rot(3,3);r34=Rot(3,4);r35=Rot(3,5)
!          r41=Rot(4,1);r42=Rot(4,2);r43=Rot(4,3);r44=Rot(4,4);r45=Rot(4,5)
!          r51=Rot(5,1);r52=Rot(5,2);r53=Rot(5,3);r54=Rot(5,4);r55=Rot(5,5)
!
!          det = &
!               &      r15*r24*r33*r42*r51 - r14*r25*r33*r42*r51 - &
!               &      r15*r23*r34*r42*r51 + r13*r25*r34*r42*r51 + &
!               &      r14*r23*r35*r42*r51 - r13*r24*r35*r42*r51 - &
!               &      r15*r24*r32*r43*r51 + r14*r25*r32*r43*r51 + &
!               &      r15*r22*r34*r43*r51 - r12*r25*r34*r43*r51 - &
!               &      r14*r22*r35*r43*r51 + r12*r24*r35*r43*r51 + &
!               &      r15*r23*r32*r44*r51 - r13*r25*r32*r44*r51 - &
!               &      r15*r22*r33*r44*r51 + r12*r25*r33*r44*r51 + &
!               &      r13*r22*r35*r44*r51 - r12*r23*r35*r44*r51 - &
!               &      r14*r23*r32*r45*r51 + r13*r24*r32*r45*r51 + &
!               &      r14*r22*r33*r45*r51 - r12*r24*r33*r45*r51 - &
!               &      r13*r22*r34*r45*r51 + r12*r23*r34*r45*r51 - &
!               &      r15*r24*r33*r41*r52 + r14*r25*r33*r41*r52 + &
!               &      r15*r23*r34*r41*r52 - r13*r25*r34*r41*r52 - &
!               &      r14*r23*r35*r41*r52 + r13*r24*r35*r41*r52 + &
!               &      r15*r24*r31*r43*r52 - r14*r25*r31*r43*r52 - &
!               &      r15*r21*r34*r43*r52 + r11*r25*r34*r43*r52 + &
!               &      r14*r21*r35*r43*r52 - r11*r24*r35*r43*r52 - &
!               &      r15*r23*r31*r44*r52 + r13*r25*r31*r44*r52 + &
!               &      r15*r21*r33*r44*r52 - r11*r25*r33*r44*r52 - &
!               &      r13*r21*r35*r44*r52 + r11*r23*r35*r44*r52 + &
!               &      r14*r23*r31*r45*r52 - r13*r24*r31*r45*r52 - &
!               &      r14*r21*r33*r45*r52 + r11*r24*r33*r45*r52 + &
!               &      r13*r21*r34*r45*r52 - r11*r23*r34*r45*r52 + &
!               &      r15*r24*r32*r41*r53 - r14*r25*r32*r41*r53 - &
!               &      r15*r22*r34*r41*r53 + r12*r25*r34*r41*r53 + &
!               &      r14*r22*r35*r41*r53 - r12*r24*r35*r41*r53 - &
!               &      r15*r24*r31*r42*r53 + r14*r25*r31*r42*r53 + &
!               &      r15*r21*r34*r42*r53 - r11*r25*r34*r42*r53 - &
!               &      r14*r21*r35*r42*r53 + r11*r24*r35*r42*r53 + &
!               &      r15*r22*r31*r44*r53 - r12*r25*r31*r44*r53 - &
!               &      r15*r21*r32*r44*r53 + r11*r25*r32*r44*r53 + &
!               &      r12*r21*r35*r44*r53 - r11*r22*r35*r44*r53 - &
!               &      r14*r22*r31*r45*r53 + r12*r24*r31*r45*r53 + &
!               &      r14*r21*r32*r45*r53 - r11*r24*r32*r45*r53 - &
!               &      r12*r21*r34*r45*r53 + r11*r22*r34*r45*r53 - &
!               &      r15*r23*r32*r41*r54 + r13*r25*r32*r41*r54 + &
!               &      r15*r22*r33*r41*r54 - r12*r25*r33*r41*r54 - &
!               &      r13*r22*r35*r41*r54 + r12*r23*r35*r41*r54 + &
!               &      r15*r23*r31*r42*r54 - r13*r25*r31*r42*r54 - &
!               &      r15*r21*r33*r42*r54 + r11*r25*r33*r42*r54 + &
!               &      r13*r21*r35*r42*r54 - r11*r23*r35*r42*r54 - &
!               &      r15*r22*r31*r43*r54 + r12*r25*r31*r43*r54 + &
!               &      r15*r21*r32*r43*r54 - r11*r25*r32*r43*r54 - &
!               &      r12*r21*r35*r43*r54 + r11*r22*r35*r43*r54 + &
!               &      r13*r22*r31*r45*r54 - r12*r23*r31*r45*r54 - &
!               &      r13*r21*r32*r45*r54 + r11*r23*r32*r45*r54 + &
!               &      r12*r21*r33*r45*r54 - r11*r22*r33*r45*r54 + &
!               &      r14*r23*r32*r41*r55 - r13*r24*r32*r41*r55 - &
!               &      r14*r22*r33*r41*r55 + r12*r24*r33*r41*r55 + &
!               &      r13*r22*r34*r41*r55 - r12*r23*r34*r41*r55 - &
!               &      r14*r23*r31*r42*r55 + r13*r24*r31*r42*r55 + &
!               &      r14*r21*r33*r42*r55 - r11*r24*r33*r42*r55 - &
!               &      r13*r21*r34*r42*r55 + r11*r23*r34*r42*r55 + &
!               &      r14*r22*r31*r43*r55 - r12*r24*r31*r43*r55 - &
!               &      r14*r21*r32*r43*r55 + r11*r24*r32*r43*r55 + &
!               &      r12*r21*r34*r43*r55 - r11*r22*r34*r43*r55 - &
!               &      r13*r22*r31*r44*r55 + r12*r23*r31*r44*r55 + &
!               &      r13*r21*r32*r44*r55 - r11*r23*r32*r44*r55 - &
!               &      r12*r21*r33*r44*r55 + r11*r22*r33*r44*r55
!
!    elseif (n == 6) then 
!          r11=Rot(1,1); r12=Rot(1,2); r13=Rot(1,3) ;r14=Rot(1,4);r15=Rot(1,5) ;r16=Rot(1,6)
!          r21=Rot(2,1); r22=Rot(2,2); r23=Rot(2,3); r24=Rot(2,4);r25=Rot(2,5); r26=Rot(2,6)
!          r31=Rot(3,1); r32=Rot(3,2); r33=Rot(3,3); r34=Rot(3,4);r35=Rot(3,5); r36=Rot(3,6)
!          r41=Rot(4,1); r42=Rot(4,2); r43=Rot(4,3); r44=Rot(4,4);r45=Rot(4,5); r46=Rot(4,6)
!          r51=Rot(5,1); r52=Rot(5,2); r53=Rot(5,3); r54=Rot(5,4);r55=Rot(5,5); r56=Rot(5,6)
!          r61=Rot(6,1); r62=Rot(6,2); r63=Rot(6,3); r64=Rot(6,4);r65=Rot(6,5); r66=Rot(6,6)
!
!          det = -r16*r25*r34*r43*r52*r61 + &
!               &    r15*r26*r34*r43*r52*r61 + r16*r24*r35*r43*r52*r61 - &
!               &   r14*r26*r35*r43*r52*r61 - r15*r24*r36*r43*r52*r61 +& 
!               &  r14*r25*r36*r43*r52*r61 + r16*r25*r33*r44*r52*r61 - &
!               &  r15*r26*r33*r44*r52*r61 - r16*r23*r35*r44*r52*r61 + &
!               &  r13*r26*r35*r44*r52*r61 + r15*r23*r36*r44*r52*r61 - &
!               &  r13*r25*r36*r44*r52*r61 - r16*r24*r33*r45*r52*r61 + &
!               &  r14*r26*r33*r45*r52*r61 + r16*r23*r34*r45*r52*r61 - &
!               &  r13*r26*r34*r45*r52*r61 - r14*r23*r36*r45*r52*r61 + &
!               &  r13*r24*r36*r45*r52*r61 + r15*r24*r33*r46*r52*r61 - &
!               &  r14*r25*r33*r46*r52*r61 - r15*r23*r34*r46*r52*r61 + &
!               &  r13*r25*r34*r46*r52*r61 + r14*r23*r35*r46*r52*r61 - &
!               &  r13*r24*r35*r46*r52*r61 + r16*r25*r34*r42*r53*r61 - &
!               &  r15*r26*r34*r42*r53*r61 - r16*r24*r35*r42*r53*r61 + &
!               &  r14*r26*r35*r42*r53*r61 + r15*r24*r36*r42*r53*r61 - &
!               &  r14*r25*r36*r42*r53*r61 - r16*r25*r32*r44*r53*r61 + &
!               &  r15*r26*r32*r44*r53*r61 + r16*r22*r35*r44*r53*r61 - &
!               &  r12*r26*r35*r44*r53*r61 - r15*r22*r36*r44*r53*r61 + &
!               &  r12*r25*r36*r44*r53*r61 + r16*r24*r32*r45*r53*r61 - &
!               &  r14*r26*r32*r45*r53*r61 - r16*r22*r34*r45*r53*r61 + &
!               &  r12*r26*r34*r45*r53*r61 + r14*r22*r36*r45*r53*r61 - &
!               &  r12*r24*r36*r45*r53*r61 - r15*r24*r32*r46*r53*r61 + &
!               &  r14*r25*r32*r46*r53*r61 + r15*r22*r34*r46*r53*r61 - &
!               &  r12*r25*r34*r46*r53*r61 - r14*r22*r35*r46*r53*r61 + &
!               &  r12*r24*r35*r46*r53*r61 - r16*r25*r33*r42*r54*r61 + &
!               &  r15*r26*r33*r42*r54*r61 + r16*r23*r35*r42*r54*r61 - &
!               &  r13*r26*r35*r42*r54*r61 - r15*r23*r36*r42*r54*r61 + &
!               &  r13*r25*r36*r42*r54*r61 + r16*r25*r32*r43*r54*r61 - &
!               &  r15*r26*r32*r43*r54*r61 - r16*r22*r35*r43*r54*r61 + &
!               &  r12*r26*r35*r43*r54*r61 + r15*r22*r36*r43*r54*r61 - &
!               &  r12*r25*r36*r43*r54*r61 - r16*r23*r32*r45*r54*r61 + &
!               &  r13*r26*r32*r45*r54*r61 + r16*r22*r33*r45*r54*r61 - &
!               &  r12*r26*r33*r45*r54*r61 - r13*r22*r36*r45*r54*r61 + &
!               &  r12*r23*r36*r45*r54*r61 + r15*r23*r32*r46*r54*r61 - &
!               &  r13*r25*r32*r46*r54*r61 - r15*r22*r33*r46*r54*r61 + &
!               &  r12*r25*r33*r46*r54*r61 + r13*r22*r35*r46*r54*r61 - &
!               &  r12*r23*r35*r46*r54*r61 + r16*r24*r33*r42*r55*r61 - &
!               &  r14*r26*r33*r42*r55*r61 - r16*r23*r34*r42*r55*r61 + &
!               &  r13*r26*r34*r42*r55*r61 + r14*r23*r36*r42*r55*r61 - &
!               &  r13*r24*r36*r42*r55*r61 - r16*r24*r32*r43*r55*r61 + &
!               &  r14*r26*r32*r43*r55*r61 + r16*r22*r34*r43*r55*r61 - &
!               &  r12*r26*r34*r43*r55*r61 - r14*r22*r36*r43*r55*r61 + &
!               &  r12*r24*r36*r43*r55*r61 + r16*r23*r32*r44*r55*r61 - &
!               &  r13*r26*r32*r44*r55*r61 - r16*r22*r33*r44*r55*r61 + &
!               &  r12*r26*r33*r44*r55*r61 + r13*r22*r36*r44*r55*r61 - &
!               &  r12*r23*r36*r44*r55*r61 - r14*r23*r32*r46*r55*r61 + &
!               &  r13*r24*r32*r46*r55*r61 + r14*r22*r33*r46*r55*r61 - &
!               &  r12*r24*r33*r46*r55*r61 - r13*r22*r34*r46*r55*r61 + &
!               &  r12*r23*r34*r46*r55*r61 - r15*r24*r33*r42*r56*r61 + &
!               &  r14*r25*r33*r42*r56*r61 + r15*r23*r34*r42*r56*r61 - &
!               &  r13*r25*r34*r42*r56*r61 - r14*r23*r35*r42*r56*r61 + &
!               &  r13*r24*r35*r42*r56*r61 + r15*r24*r32*r43*r56*r61 - &
!               &  r14*r25*r32*r43*r56*r61 - r15*r22*r34*r43*r56*r61 + &
!               &  r12*r25*r34*r43*r56*r61 + r14*r22*r35*r43*r56*r61 - &
!               &  r12*r24*r35*r43*r56*r61 - r15*r23*r32*r44*r56*r61 + &
!               &  r13*r25*r32*r44*r56*r61 + r15*r22*r33*r44*r56*r61 - &
!               &  r12*r25*r33*r44*r56*r61 - r13*r22*r35*r44*r56*r61 + &
!               &  r12*r23*r35*r44*r56*r61 + r14*r23*r32*r45*r56*r61 - &
!               &  r13*r24*r32*r45*r56*r61 - r14*r22*r33*r45*r56*r61 + &
!               &  r12*r24*r33*r45*r56*r61 + r13*r22*r34*r45*r56*r61 - &
!               &  r12*r23*r34*r45*r56*r61 + r16*r25*r34*r43*r51*r62 - &
!               &  r15*r26*r34*r43*r51*r62 - r16*r24*r35*r43*r51*r62 + &
!               &  r14*r26*r35*r43*r51*r62 + r15*r24*r36*r43*r51*r62 - &
!               &  r14*r25*r36*r43*r51*r62 - r16*r25*r33*r44*r51*r62 + &
!               &  r15*r26*r33*r44*r51*r62 + r16*r23*r35*r44*r51*r62 - &
!               &  r13*r26*r35*r44*r51*r62 - r15*r23*r36*r44*r51*r62 + &
!               &  r13*r25*r36*r44*r51*r62 + r16*r24*r33*r45*r51*r62 - &
!               &  r14*r26*r33*r45*r51*r62 - r16*r23*r34*r45*r51*r62 + &
!               &  r13*r26*r34*r45*r51*r62 + r14*r23*r36*r45*r51*r62 - &
!               &  r13*r24*r36*r45*r51*r62 - r15*r24*r33*r46*r51*r62 + &
!               &  r14*r25*r33*r46*r51*r62 + r15*r23*r34*r46*r51*r62 - &
!               &  r13*r25*r34*r46*r51*r62 - r14*r23*r35*r46*r51*r62 + &
!               &  r13*r24*r35*r46*r51*r62 - r16*r25*r34*r41*r53*r62 + &
!               &  r15*r26*r34*r41*r53*r62 + r16*r24*r35*r41*r53*r62 - &
!               &  r14*r26*r35*r41*r53*r62 - r15*r24*r36*r41*r53*r62 + &
!               &  r14*r25*r36*r41*r53*r62 + r16*r25*r31*r44*r53*r62 - &
!               &  r15*r26*r31*r44*r53*r62 - r16*r21*r35*r44*r53*r62 + &
!               &  r11*r26*r35*r44*r53*r62 + r15*r21*r36*r44*r53*r62 - &
!               &  r11*r25*r36*r44*r53*r62 - r16*r24*r31*r45*r53*r62 + &
!               &  r14*r26*r31*r45*r53*r62 + r16*r21*r34*r45*r53*r62 - &
!               &  r11*r26*r34*r45*r53*r62 - r14*r21*r36*r45*r53*r62 + &
!               &  r11*r24*r36*r45*r53*r62 + r15*r24*r31*r46*r53*r62 - &
!               &  r14*r25*r31*r46*r53*r62 - r15*r21*r34*r46*r53*r62 + &
!               &  r11*r25*r34*r46*r53*r62 + r14*r21*r35*r46*r53*r62 - &
!               &  r11*r24*r35*r46*r53*r62 + r16*r25*r33*r41*r54*r62 - &
!               &  r15*r26*r33*r41*r54*r62 - r16*r23*r35*r41*r54*r62 + &
!               &  r13*r26*r35*r41*r54*r62 + r15*r23*r36*r41*r54*r62 - &
!               &  r13*r25*r36*r41*r54*r62 - r16*r25*r31*r43*r54*r62 + &
!               &  r15*r26*r31*r43*r54*r62 + r16*r21*r35*r43*r54*r62 - &
!               &  r11*r26*r35*r43*r54*r62 - r15*r21*r36*r43*r54*r62 + &
!               &  r11*r25*r36*r43*r54*r62 + r16*r23*r31*r45*r54*r62 - &
!               &  r13*r26*r31*r45*r54*r62 - r16*r21*r33*r45*r54*r62 + &
!               &  r11*r26*r33*r45*r54*r62 + r13*r21*r36*r45*r54*r62 - &
!               &  r11*r23*r36*r45*r54*r62 - r15*r23*r31*r46*r54*r62 + &
!               &  r13*r25*r31*r46*r54*r62 + r15*r21*r33*r46*r54*r62 - &
!               &  r11*r25*r33*r46*r54*r62 - r13*r21*r35*r46*r54*r62 + &
!               &  r11*r23*r35*r46*r54*r62 - r16*r24*r33*r41*r55*r62 + &
!               &  r14*r26*r33*r41*r55*r62 + r16*r23*r34*r41*r55*r62 - &
!               &  r13*r26*r34*r41*r55*r62 - r14*r23*r36*r41*r55*r62 + &
!               &  r13*r24*r36*r41*r55*r62 + r16*r24*r31*r43*r55*r62 - &
!               &  r14*r26*r31*r43*r55*r62 - r16*r21*r34*r43*r55*r62 + &
!               &  r11*r26*r34*r43*r55*r62 + r14*r21*r36*r43*r55*r62 - &
!               &  r11*r24*r36*r43*r55*r62 - r16*r23*r31*r44*r55*r62 + &
!               &  r13*r26*r31*r44*r55*r62 + r16*r21*r33*r44*r55*r62 - &
!               &  r11*r26*r33*r44*r55*r62 - r13*r21*r36*r44*r55*r62 + &
!               &  r11*r23*r36*r44*r55*r62 + r14*r23*r31*r46*r55*r62 - &
!               &  r13*r24*r31*r46*r55*r62 - r14*r21*r33*r46*r55*r62 + &
!               &  r11*r24*r33*r46*r55*r62 + r13*r21*r34*r46*r55*r62 - &
!               &  r11*r23*r34*r46*r55*r62 + r15*r24*r33*r41*r56*r62 - &
!               &  r14*r25*r33*r41*r56*r62 - r15*r23*r34*r41*r56*r62 + &
!               &  r13*r25*r34*r41*r56*r62 + r14*r23*r35*r41*r56*r62 - &
!               &  r13*r24*r35*r41*r56*r62 - r15*r24*r31*r43*r56*r62 + &
!               &  r14*r25*r31*r43*r56*r62 + r15*r21*r34*r43*r56*r62 - &
!               &  r11*r25*r34*r43*r56*r62 - r14*r21*r35*r43*r56*r62 + &
!               &  r11*r24*r35*r43*r56*r62 + r15*r23*r31*r44*r56*r62 - &
!               &  r13*r25*r31*r44*r56*r62 - r15*r21*r33*r44*r56*r62 + &
!               &  r11*r25*r33*r44*r56*r62 + r13*r21*r35*r44*r56*r62 - &
!               &  r11*r23*r35*r44*r56*r62 - r14*r23*r31*r45*r56*r62 + &
!               &  r13*r24*r31*r45*r56*r62 + r14*r21*r33*r45*r56*r62 - &
!               &  r11*r24*r33*r45*r56*r62 - r13*r21*r34*r45*r56*r62 + &
!               &  r11*r23*r34*r45*r56*r62 - r16*r25*r34*r42*r51*r63 + &
!               &  r15*r26*r34*r42*r51*r63 + r16*r24*r35*r42*r51*r63 - &
!               &  r14*r26*r35*r42*r51*r63 - r15*r24*r36*r42*r51*r63 + &
!               &  r14*r25*r36*r42*r51*r63 + r16*r25*r32*r44*r51*r63 - &
!               &  r15*r26*r32*r44*r51*r63 - r16*r22*r35*r44*r51*r63 + &
!               &  r12*r26*r35*r44*r51*r63 + r15*r22*r36*r44*r51*r63 - &
!               &  r12*r25*r36*r44*r51*r63 - r16*r24*r32*r45*r51*r63 + &
!               &  r14*r26*r32*r45*r51*r63 + r16*r22*r34*r45*r51*r63 - &
!               &  r12*r26*r34*r45*r51*r63 - r14*r22*r36*r45*r51*r63 + &
!               &  r12*r24*r36*r45*r51*r63 + r15*r24*r32*r46*r51*r63 - &
!               &  r14*r25*r32*r46*r51*r63 - r15*r22*r34*r46*r51*r63 + &
!               &  r12*r25*r34*r46*r51*r63 + r14*r22*r35*r46*r51*r63 - &
!               &  r12*r24*r35*r46*r51*r63 + r16*r25*r34*r41*r52*r63 - &
!               &  r15*r26*r34*r41*r52*r63 - r16*r24*r35*r41*r52*r63 + &
!               &  r14*r26*r35*r41*r52*r63 + r15*r24*r36*r41*r52*r63 - &
!               &  r14*r25*r36*r41*r52*r63 - r16*r25*r31*r44*r52*r63 + &
!               &  r15*r26*r31*r44*r52*r63 + r16*r21*r35*r44*r52*r63 - &
!               &  r11*r26*r35*r44*r52*r63 - r15*r21*r36*r44*r52*r63 + &
!               &  r11*r25*r36*r44*r52*r63 + r16*r24*r31*r45*r52*r63 - &
!               &  r14*r26*r31*r45*r52*r63 - r16*r21*r34*r45*r52*r63 + &
!               &  r11*r26*r34*r45*r52*r63 + r14*r21*r36*r45*r52*r63 - &
!               &  r11*r24*r36*r45*r52*r63 - r15*r24*r31*r46*r52*r63 + &
!               &  r14*r25*r31*r46*r52*r63 + r15*r21*r34*r46*r52*r63 - &
!               &  r11*r25*r34*r46*r52*r63 - r14*r21*r35*r46*r52*r63 + &
!               &  r11*r24*r35*r46*r52*r63 - r16*r25*r32*r41*r54*r63 + &
!               &  r15*r26*r32*r41*r54*r63 + r16*r22*r35*r41*r54*r63 - &
!               &  r12*r26*r35*r41*r54*r63 - r15*r22*r36*r41*r54*r63 + &
!               &  r12*r25*r36*r41*r54*r63 + r16*r25*r31*r42*r54*r63 - &
!               &  r15*r26*r31*r42*r54*r63 - r16*r21*r35*r42*r54*r63 + &
!               &  r11*r26*r35*r42*r54*r63 + r15*r21*r36*r42*r54*r63 - &
!               &  r11*r25*r36*r42*r54*r63 - r16*r22*r31*r45*r54*r63 + &
!               &  r12*r26*r31*r45*r54*r63 + r16*r21*r32*r45*r54*r63 - &
!               &  r11*r26*r32*r45*r54*r63 - r12*r21*r36*r45*r54*r63 + &
!               &  r11*r22*r36*r45*r54*r63 + r15*r22*r31*r46*r54*r63 - &
!               &  r12*r25*r31*r46*r54*r63 - r15*r21*r32*r46*r54*r63 + &
!               &  r11*r25*r32*r46*r54*r63 + r12*r21*r35*r46*r54*r63 - &
!               &  r11*r22*r35*r46*r54*r63 + r16*r24*r32*r41*r55*r63 - &
!               &  r14*r26*r32*r41*r55*r63 - r16*r22*r34*r41*r55*r63 + &
!               &  r12*r26*r34*r41*r55*r63 + r14*r22*r36*r41*r55*r63 - &
!               &  r12*r24*r36*r41*r55*r63 - r16*r24*r31*r42*r55*r63 + &
!               &  r14*r26*r31*r42*r55*r63 + r16*r21*r34*r42*r55*r63 - &
!               &  r11*r26*r34*r42*r55*r63 - r14*r21*r36*r42*r55*r63 + &
!               &  r11*r24*r36*r42*r55*r63 + r16*r22*r31*r44*r55*r63 - &
!               &  r12*r26*r31*r44*r55*r63 - r16*r21*r32*r44*r55*r63 + &
!               &  r11*r26*r32*r44*r55*r63 + r12*r21*r36*r44*r55*r63 - &
!               &  r11*r22*r36*r44*r55*r63 - r14*r22*r31*r46*r55*r63 + &
!               &  r12*r24*r31*r46*r55*r63 + r14*r21*r32*r46*r55*r63 - &
!               &  r11*r24*r32*r46*r55*r63 - r12*r21*r34*r46*r55*r63 + &
!               &  r11*r22*r34*r46*r55*r63 - r15*r24*r32*r41*r56*r63 + &
!               &  r14*r25*r32*r41*r56*r63 + r15*r22*r34*r41*r56*r63 - &
!               &  r12*r25*r34*r41*r56*r63 - r14*r22*r35*r41*r56*r63 + &
!               &  r12*r24*r35*r41*r56*r63 + r15*r24*r31*r42*r56*r63 - &
!               &  r14*r25*r31*r42*r56*r63 - r15*r21*r34*r42*r56*r63 + &
!               &  r11*r25*r34*r42*r56*r63 + r14*r21*r35*r42*r56*r63 - &
!               &  r11*r24*r35*r42*r56*r63 - r15*r22*r31*r44*r56*r63 + &
!               &  r12*r25*r31*r44*r56*r63 + r15*r21*r32*r44*r56*r63 - &
!               &  r11*r25*r32*r44*r56*r63 - r12*r21*r35*r44*r56*r63 + &
!               &  r11*r22*r35*r44*r56*r63 + r14*r22*r31*r45*r56*r63 - &
!               &  r12*r24*r31*r45*r56*r63 - r14*r21*r32*r45*r56*r63 + &
!               &  r11*r24*r32*r45*r56*r63 + r12*r21*r34*r45*r56*r63 - &
!               &  r11*r22*r34*r45*r56*r63 + r16*r25*r33*r42*r51*r64 - &
!               &  r15*r26*r33*r42*r51*r64 - r16*r23*r35*r42*r51*r64 + &
!               &  r13*r26*r35*r42*r51*r64 + r15*r23*r36*r42*r51*r64 - &
!               &  r13*r25*r36*r42*r51*r64 - r16*r25*r32*r43*r51*r64 + &
!               &  r15*r26*r32*r43*r51*r64 + r16*r22*r35*r43*r51*r64 - &
!               &  r12*r26*r35*r43*r51*r64 - r15*r22*r36*r43*r51*r64 + &
!               &  r12*r25*r36*r43*r51*r64 + r16*r23*r32*r45*r51*r64 - &
!               &  r13*r26*r32*r45*r51*r64 - r16*r22*r33*r45*r51*r64 + &
!               &  r12*r26*r33*r45*r51*r64 + r13*r22*r36*r45*r51*r64 - &
!               &  r12*r23*r36*r45*r51*r64 - r15*r23*r32*r46*r51*r64 + &
!               &  r13*r25*r32*r46*r51*r64 + r15*r22*r33*r46*r51*r64 - &
!               &  r12*r25*r33*r46*r51*r64 - r13*r22*r35*r46*r51*r64 + &
!               &  r12*r23*r35*r46*r51*r64 - r16*r25*r33*r41*r52*r64 + &
!               &  r15*r26*r33*r41*r52*r64 + r16*r23*r35*r41*r52*r64 - &
!               &  r13*r26*r35*r41*r52*r64 - r15*r23*r36*r41*r52*r64 + &
!               &  r13*r25*r36*r41*r52*r64 + r16*r25*r31*r43*r52*r64 - &
!               &  r15*r26*r31*r43*r52*r64 - r16*r21*r35*r43*r52*r64 + &
!               &  r11*r26*r35*r43*r52*r64 + r15*r21*r36*r43*r52*r64 - &
!               &  r11*r25*r36*r43*r52*r64 - r16*r23*r31*r45*r52*r64 + &
!               &  r13*r26*r31*r45*r52*r64 + r16*r21*r33*r45*r52*r64 - &
!               &  r11*r26*r33*r45*r52*r64 - r13*r21*r36*r45*r52*r64 + &
!               &  r11*r23*r36*r45*r52*r64 + r15*r23*r31*r46*r52*r64 - &
!               &  r13*r25*r31*r46*r52*r64 - r15*r21*r33*r46*r52*r64 + &
!               &  r11*r25*r33*r46*r52*r64 + r13*r21*r35*r46*r52*r64 - &
!               &  r11*r23*r35*r46*r52*r64 + r16*r25*r32*r41*r53*r64 - &
!               &  r15*r26*r32*r41*r53*r64 - r16*r22*r35*r41*r53*r64 + &
!               &  r12*r26*r35*r41*r53*r64 + r15*r22*r36*r41*r53*r64 - &
!               &  r12*r25*r36*r41*r53*r64 - r16*r25*r31*r42*r53*r64 + &
!               &  r15*r26*r31*r42*r53*r64 + r16*r21*r35*r42*r53*r64 - &
!               &  r11*r26*r35*r42*r53*r64 - r15*r21*r36*r42*r53*r64 + &
!               &  r11*r25*r36*r42*r53*r64 + r16*r22*r31*r45*r53*r64 - &
!               &  r12*r26*r31*r45*r53*r64 - r16*r21*r32*r45*r53*r64 + &
!               &  r11*r26*r32*r45*r53*r64 + r12*r21*r36*r45*r53*r64 - &
!               &  r11*r22*r36*r45*r53*r64 - r15*r22*r31*r46*r53*r64 + &
!               &  r12*r25*r31*r46*r53*r64 + r15*r21*r32*r46*r53*r64 - &
!               &  r11*r25*r32*r46*r53*r64 - r12*r21*r35*r46*r53*r64 + &
!               &  r11*r22*r35*r46*r53*r64 - r16*r23*r32*r41*r55*r64 + &
!               &  r13*r26*r32*r41*r55*r64 + r16*r22*r33*r41*r55*r64 - &
!               &  r12*r26*r33*r41*r55*r64 - r13*r22*r36*r41*r55*r64 + &
!               &  r12*r23*r36*r41*r55*r64 + r16*r23*r31*r42*r55*r64 - &
!               &  r13*r26*r31*r42*r55*r64 - r16*r21*r33*r42*r55*r64 + &
!               &  r11*r26*r33*r42*r55*r64 + r13*r21*r36*r42*r55*r64 - &
!               &  r11*r23*r36*r42*r55*r64 - r16*r22*r31*r43*r55*r64 + &
!               &  r12*r26*r31*r43*r55*r64 + r16*r21*r32*r43*r55*r64 - &
!               &  r11*r26*r32*r43*r55*r64 - r12*r21*r36*r43*r55*r64 + &
!               &  r11*r22*r36*r43*r55*r64 + r13*r22*r31*r46*r55*r64 - &
!               &  r12*r23*r31*r46*r55*r64 - r13*r21*r32*r46*r55*r64 + &
!               &  r11*r23*r32*r46*r55*r64 + r12*r21*r33*r46*r55*r64 - &
!               &  r11*r22*r33*r46*r55*r64 + r15*r23*r32*r41*r56*r64 - &
!               &  r13*r25*r32*r41*r56*r64 - r15*r22*r33*r41*r56*r64 + &
!               &  r12*r25*r33*r41*r56*r64 + r13*r22*r35*r41*r56*r64 - &
!               &  r12*r23*r35*r41*r56*r64 - r15*r23*r31*r42*r56*r64 + &
!               &  r13*r25*r31*r42*r56*r64 + r15*r21*r33*r42*r56*r64 - &
!               &  r11*r25*r33*r42*r56*r64 - r13*r21*r35*r42*r56*r64 + &
!               &  r11*r23*r35*r42*r56*r64 + r15*r22*r31*r43*r56*r64 - &
!               &  r12*r25*r31*r43*r56*r64 - r15*r21*r32*r43*r56*r64 + &
!               &  r11*r25*r32*r43*r56*r64 + r12*r21*r35*r43*r56*r64 - &
!               &  r11*r22*r35*r43*r56*r64 - r13*r22*r31*r45*r56*r64 + &
!               &  r12*r23*r31*r45*r56*r64 + r13*r21*r32*r45*r56*r64 - &
!               &  r11*r23*r32*r45*r56*r64 - r12*r21*r33*r45*r56*r64 + &
!               &  r11*r22*r33*r45*r56*r64 - r16*r24*r33*r42*r51*r65 + &
!               &  r14*r26*r33*r42*r51*r65 + r16*r23*r34*r42*r51*r65 - &
!               &  r13*r26*r34*r42*r51*r65 - r14*r23*r36*r42*r51*r65 + &
!               &  r13*r24*r36*r42*r51*r65 + r16*r24*r32*r43*r51*r65 - &
!               &  r14*r26*r32*r43*r51*r65 - r16*r22*r34*r43*r51*r65 + &
!               &  r12*r26*r34*r43*r51*r65 + r14*r22*r36*r43*r51*r65 - &
!               &  r12*r24*r36*r43*r51*r65 - r16*r23*r32*r44*r51*r65 + &
!               &  r13*r26*r32*r44*r51*r65 + r16*r22*r33*r44*r51*r65 - &
!               &  r12*r26*r33*r44*r51*r65 - r13*r22*r36*r44*r51*r65 + &
!               &  r12*r23*r36*r44*r51*r65 + r14*r23*r32*r46*r51*r65 - &
!               &  r13*r24*r32*r46*r51*r65 - r14*r22*r33*r46*r51*r65 + &
!               &  r12*r24*r33*r46*r51*r65 + r13*r22*r34*r46*r51*r65 - &
!               &  r12*r23*r34*r46*r51*r65 + r16*r24*r33*r41*r52*r65 - &
!               &  r14*r26*r33*r41*r52*r65 - r16*r23*r34*r41*r52*r65 + &
!               &  r13*r26*r34*r41*r52*r65 + r14*r23*r36*r41*r52*r65 - &
!               &  r13*r24*r36*r41*r52*r65 - r16*r24*r31*r43*r52*r65 + &
!               &  r14*r26*r31*r43*r52*r65 + r16*r21*r34*r43*r52*r65 - &
!               &  r11*r26*r34*r43*r52*r65 - r14*r21*r36*r43*r52*r65 + &
!               &  r11*r24*r36*r43*r52*r65 + r16*r23*r31*r44*r52*r65 - &
!               &  r13*r26*r31*r44*r52*r65 - r16*r21*r33*r44*r52*r65 + &
!               &  r11*r26*r33*r44*r52*r65 + r13*r21*r36*r44*r52*r65 - &
!               &  r11*r23*r36*r44*r52*r65 - r14*r23*r31*r46*r52*r65 + &
!               &  r13*r24*r31*r46*r52*r65 + r14*r21*r33*r46*r52*r65 - &
!               &  r11*r24*r33*r46*r52*r65 - r13*r21*r34*r46*r52*r65 + &
!               &  r11*r23*r34*r46*r52*r65 - r16*r24*r32*r41*r53*r65 + &
!               &  r14*r26*r32*r41*r53*r65 + r16*r22*r34*r41*r53*r65 - &
!               &  r12*r26*r34*r41*r53*r65 - r14*r22*r36*r41*r53*r65 + &
!               &  r12*r24*r36*r41*r53*r65 + r16*r24*r31*r42*r53*r65 - &
!               &  r14*r26*r31*r42*r53*r65 - r16*r21*r34*r42*r53*r65 + &
!               &  r11*r26*r34*r42*r53*r65 + r14*r21*r36*r42*r53*r65 - &
!               &  r11*r24*r36*r42*r53*r65 - r16*r22*r31*r44*r53*r65 + &
!               &  r12*r26*r31*r44*r53*r65 + r16*r21*r32*r44*r53*r65 - &
!               &  r11*r26*r32*r44*r53*r65 - r12*r21*r36*r44*r53*r65 + &
!               &  r11*r22*r36*r44*r53*r65 + r14*r22*r31*r46*r53*r65 - &
!               &  r12*r24*r31*r46*r53*r65 - r14*r21*r32*r46*r53*r65 + &
!               &  r11*r24*r32*r46*r53*r65 + r12*r21*r34*r46*r53*r65 - &
!               &  r11*r22*r34*r46*r53*r65 + r16*r23*r32*r41*r54*r65 - &
!               &  r13*r26*r32*r41*r54*r65 - r16*r22*r33*r41*r54*r65 + &
!               &  r12*r26*r33*r41*r54*r65 + r13*r22*r36*r41*r54*r65 - &
!               &  r12*r23*r36*r41*r54*r65 - r16*r23*r31*r42*r54*r65 + &
!               &  r13*r26*r31*r42*r54*r65 + r16*r21*r33*r42*r54*r65 - &
!               &  r11*r26*r33*r42*r54*r65 - r13*r21*r36*r42*r54*r65 + &
!               &  r11*r23*r36*r42*r54*r65 + r16*r22*r31*r43*r54*r65 - &
!               &  r12*r26*r31*r43*r54*r65 - r16*r21*r32*r43*r54*r65 + &
!               &  r11*r26*r32*r43*r54*r65 + r12*r21*r36*r43*r54*r65 - &
!               &  r11*r22*r36*r43*r54*r65 - r13*r22*r31*r46*r54*r65 + &
!               &  r12*r23*r31*r46*r54*r65 + r13*r21*r32*r46*r54*r65 - &
!               &  r11*r23*r32*r46*r54*r65 - r12*r21*r33*r46*r54*r65 + &
!               &  r11*r22*r33*r46*r54*r65 - r14*r23*r32*r41*r56*r65 + &
!               &  r13*r24*r32*r41*r56*r65 + r14*r22*r33*r41*r56*r65 - &
!               &  r12*r24*r33*r41*r56*r65 - r13*r22*r34*r41*r56*r65 + &
!               &  r12*r23*r34*r41*r56*r65 + r14*r23*r31*r42*r56*r65 - &
!               &  r13*r24*r31*r42*r56*r65 - r14*r21*r33*r42*r56*r65 + &
!               &  r11*r24*r33*r42*r56*r65 + r13*r21*r34*r42*r56*r65 - &
!               &  r11*r23*r34*r42*r56*r65 - r14*r22*r31*r43*r56*r65 + &
!               &  r12*r24*r31*r43*r56*r65 + r14*r21*r32*r43*r56*r65 - &
!               &  r11*r24*r32*r43*r56*r65 - r12*r21*r34*r43*r56*r65 + &
!               &  r11*r22*r34*r43*r56*r65 + r13*r22*r31*r44*r56*r65 - &
!               &  r12*r23*r31*r44*r56*r65 - r13*r21*r32*r44*r56*r65 + &
!               &  r11*r23*r32*r44*r56*r65 + r12*r21*r33*r44*r56*r65 - &
!               &  r11*r22*r33*r44*r56*r65 + r15*r24*r33*r42*r51*r66 - &
!               &  r14*r25*r33*r42*r51*r66 - r15*r23*r34*r42*r51*r66 + &
!               &  r13*r25*r34*r42*r51*r66 + r14*r23*r35*r42*r51*r66 - &
!               &  r13*r24*r35*r42*r51*r66 - r15*r24*r32*r43*r51*r66 + &
!               &  r14*r25*r32*r43*r51*r66 + r15*r22*r34*r43*r51*r66 - &
!               &  r12*r25*r34*r43*r51*r66 - r14*r22*r35*r43*r51*r66 + &
!               &  r12*r24*r35*r43*r51*r66 + r15*r23*r32*r44*r51*r66 - &
!               &  r13*r25*r32*r44*r51*r66 - r15*r22*r33*r44*r51*r66 + &
!               &  r12*r25*r33*r44*r51*r66 + r13*r22*r35*r44*r51*r66 - &
!               &  r12*r23*r35*r44*r51*r66 - r14*r23*r32*r45*r51*r66 + &
!               &  r13*r24*r32*r45*r51*r66 + r14*r22*r33*r45*r51*r66 - &
!               &  r12*r24*r33*r45*r51*r66 - r13*r22*r34*r45*r51*r66 + &
!               &  r12*r23*r34*r45*r51*r66 - r15*r24*r33*r41*r52*r66 + &
!               &  r14*r25*r33*r41*r52*r66 + r15*r23*r34*r41*r52*r66 - &
!               &  r13*r25*r34*r41*r52*r66 - r14*r23*r35*r41*r52*r66 + &
!               &  r13*r24*r35*r41*r52*r66 + r15*r24*r31*r43*r52*r66 - &
!               &  r14*r25*r31*r43*r52*r66 - r15*r21*r34*r43*r52*r66 + &
!               &  r11*r25*r34*r43*r52*r66 + r14*r21*r35*r43*r52*r66 - &
!               &  r11*r24*r35*r43*r52*r66 - r15*r23*r31*r44*r52*r66 + &
!               &  r13*r25*r31*r44*r52*r66 + r15*r21*r33*r44*r52*r66 - &
!               &  r11*r25*r33*r44*r52*r66 - r13*r21*r35*r44*r52*r66 + &
!               &  r11*r23*r35*r44*r52*r66 + r14*r23*r31*r45*r52*r66 - &
!               &  r13*r24*r31*r45*r52*r66 - r14*r21*r33*r45*r52*r66 + &
!               &  r11*r24*r33*r45*r52*r66 + r13*r21*r34*r45*r52*r66 - &
!               &  r11*r23*r34*r45*r52*r66 + r15*r24*r32*r41*r53*r66 - &
!               &  r14*r25*r32*r41*r53*r66 - r15*r22*r34*r41*r53*r66 + &
!               &  r12*r25*r34*r41*r53*r66 + r14*r22*r35*r41*r53*r66 - &
!               &  r12*r24*r35*r41*r53*r66 - r15*r24*r31*r42*r53*r66 + &
!               &  r14*r25*r31*r42*r53*r66 + r15*r21*r34*r42*r53*r66 - &
!               &  r11*r25*r34*r42*r53*r66 - r14*r21*r35*r42*r53*r66 + &
!               &  r11*r24*r35*r42*r53*r66 + r15*r22*r31*r44*r53*r66 - &
!               &  r12*r25*r31*r44*r53*r66 - r15*r21*r32*r44*r53*r66 + &
!               &  r11*r25*r32*r44*r53*r66 + r12*r21*r35*r44*r53*r66 - &
!               &  r11*r22*r35*r44*r53*r66 - r14*r22*r31*r45*r53*r66 + &
!               &  r12*r24*r31*r45*r53*r66 + r14*r21*r32*r45*r53*r66 - &
!               &  r11*r24*r32*r45*r53*r66 - r12*r21*r34*r45*r53*r66 + &
!               &  r11*r22*r34*r45*r53*r66 - r15*r23*r32*r41*r54*r66 + &
!               &  r13*r25*r32*r41*r54*r66 + r15*r22*r33*r41*r54*r66 - &
!               &  r12*r25*r33*r41*r54*r66 - r13*r22*r35*r41*r54*r66 + &
!               &  r12*r23*r35*r41*r54*r66 + r15*r23*r31*r42*r54*r66 - &
!               &  r13*r25*r31*r42*r54*r66 - r15*r21*r33*r42*r54*r66 + &
!               &  r11*r25*r33*r42*r54*r66 + r13*r21*r35*r42*r54*r66 - &
!               &  r11*r23*r35*r42*r54*r66 - r15*r22*r31*r43*r54*r66 + &
!               &  r12*r25*r31*r43*r54*r66 + r15*r21*r32*r43*r54*r66 - &
!               &  r11*r25*r32*r43*r54*r66 - r12*r21*r35*r43*r54*r66 + &
!               &  r11*r22*r35*r43*r54*r66 + r13*r22*r31*r45*r54*r66 - &
!               &  r12*r23*r31*r45*r54*r66 - r13*r21*r32*r45*r54*r66 + &
!               &  r11*r23*r32*r45*r54*r66 + r12*r21*r33*r45*r54*r66 - &
!               &  r11*r22*r33*r45*r54*r66 + r14*r23*r32*r41*r55*r66 - &
!               &  r13*r24*r32*r41*r55*r66 - r14*r22*r33*r41*r55*r66 + &
!               &  r12*r24*r33*r41*r55*r66 + r13*r22*r34*r41*r55*r66 - &
!               &  r12*r23*r34*r41*r55*r66 - r14*r23*r31*r42*r55*r66 + &
!               &  r13*r24*r31*r42*r55*r66 + r14*r21*r33*r42*r55*r66 - &
!               &  r11*r24*r33*r42*r55*r66 - r13*r21*r34*r42*r55*r66 + &
!               &  r11*r23*r34*r42*r55*r66 + r14*r22*r31*r43*r55*r66 - &
!               &  r12*r24*r31*r43*r55*r66 - r14*r21*r32*r43*r55*r66 + &
!               &  r11*r24*r32*r43*r55*r66 + r12*r21*r34*r43*r55*r66 - &
!               &  r11*r22*r34*r43*r55*r66 - r13*r22*r31*r44*r55*r66 + &
!               &  r12*r23*r31*r44*r55*r66 + r13*r21*r32*r44*r55*r66 - &
!               &  r11*r23*r32*r44*r55*r66 - r12*r21*r33*r44*r55*r66 + &
!               &  r11*r22*r33*r44*r55*r66
!    end if
!
!  end function determinant
!

  function determinant_old(matin) result(det)
  use types; use consts_dp
    complex(dp), intent(in) :: matin(:,:)
    integer     :: n,i,j
    complex(dp) :: det
    complex(dp) :: temp(size(matin,dim=2))
    complex(dp) :: mat(size(matin,dim=1),size(matin,dim=2))
    integer :: k,kmax
    real(dp) :: maxel 

    mat=matin
    n=size(matin,dim=2)

    outer: do j=1,n-1
       inner: do i=n,j+1,-1
          if (mat(j,i-1) == zero) then
             temp(:)   = mat(:,i-1)
             mat(:,i-1)= mat(:,i)
             mat(:,i)  = -temp(:) ! need - sign when interchanging adjacent rows 
          else
             !ORIG
             ! mat(i,:)=mat(i,:)-mat(i,j)*mat(i-1,:)/mat(i-1,j)
             
             if (abs(mat(j,i-1)) < sq2tol) then
                ! find largest value to the right...
                maxel = abs(mat(j,i-1)) 
                kmax = i-1
                do k=i-2,j,-1
                   if (abs(mat(j,k)) > maxel) then 
                      kmax = k
                   end if
                end do
                if (kmax == i-1 .or. abs(mat(j,kmax)) < sq2tol) then 
                   det = mydet(matin)
                   return 
                end if
                temp(:) = mat(:,i-1)
                mat(:,i-1) = mat(:,kmax)
                mat(:,kmax) = -temp(:)
             end if
             mat(:,i)=mat(:,i)-mat(j,i)*mat(:,i-1)/mat(j,i-1)
          end if
       enddo inner
    enddo outer

!    outer: do j=1,n-1
!       inner: do i=n,j+1,-1
!          if (mat(i-1,j) == zero) then
!             temp(:)   = mat(i-1,:)
!             mat(i-1,:)= mat(i,:)
!             mat(i,:)  = -temp(:) ! need - sign when interchanging adjacent rows 
!          else
!             !ORIG
!             ! mat(i,:)=mat(i,:)-mat(i,j)*mat(i-1,:)/mat(i-1,j)
!             
!             if (abs(mat(i-1,j)) < sq2tol) then
!                ! find largest value to the right...
!                maxel = abs(mat(i-1,j)) 
!                kmax = i-1
!                do k=i-2,j,-1
!                   if (abs(mat(k,j)) > maxel) then 
!                      kmax = k
!                   end if
!                end do
!                if (kmax == i-1 .or. abs(mat(kmax,j)) < sq2tol) then 
!                   det = mydet(matin)
!                   return 
!                end if
!                temp(:) = mat(i-1,:)
!                mat(i-1,:) = mat(kmax,:)
!                mat(kmax,:) = -temp(:)
!             end if
!             mat(i,:)=mat(i,:)-mat(i,j)*mat(i-1,:)/mat(i-1,j)
!          end if
!       enddo inner
!    enddo outer
!    
    det=one
    do i=1,n
       det=mat(i,i)*det 
    end do

  end function determinant_old

  function complementc(mat,i,j) result(Aij)
    use types; use consts_dp
    complex(dp), intent(in) :: mat(:,:)
    integer, intent(in)     :: i,j 
    complex(dp) :: Aij(size(mat,dim=1)-1,size(mat,dim=2)-1)

    Aij=zero
    Aij(:i-1,:j-1)= mat(:i-1,:j-1)
    Aij(:i-1,j:)  = mat(:i-1,j+1:)
    Aij(i:,:j-1)  = mat(i+1:,:j-1)
    Aij(i:,j:)    = mat(i+1:,j+1:)

  end function complementc



end module matrix_routines

